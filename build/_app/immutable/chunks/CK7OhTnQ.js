import"./DsnmJJEf.js";import{p as Ee,u as Ae,s as T,b as ne,c as ie,f as R,e as i,h as Le,i as l,k as r,g as t,a as Y,j as s,r as e,t as b,l as z,d as Ge,aP as je,L as ht}from"./Bq750rDx.js";import{i as v}from"./BcjopvHb.js";import{c as A,a as Ke}from"./uSFILAY7.js";import{p as bt}from"./BL6J_geM.js";import{n as Me,N as pt,b as xt,p as wt}from"./CdRP5_sk.js";import{T as Ce}from"./3NtbZaKM.js";import{g as kt}from"./BgxlgyeA.js";import{e as We}from"./Cjcfrngr.js";import{a as yt}from"./BKrWP4DR.js";import{p as jt}from"./CK1WpjU7.js";import{A as De}from"./Bt6DpIqu.js";import{E as Mt}from"./DIzqhxA9.js";import{n as Ct}from"./DAOE6Nme.js";import{C as Qe}from"./VMCyZ1kA.js";import{E as Tt}from"./BumDDlbV.js";var zt=l('<div class="flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden bg-muted"><img class="w-full h-full object-cover" loading="lazy"/></div>'),Bt=l('<div class="flex-shrink-0 w-10 h-10 bg-primary/10 dark:bg-primary/20 rounded-lg flex items-center justify-center"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div>'),Vt=l("<span>·</span> <!>",1),At=l('<a class="block p-3 hover:bg-accent/50 transition-colors rounded-lg"><div class="flex items-start gap-3"><!> <div class="flex-1 min-w-0"><h3 class="font-semibold text-sm text-foreground line-clamp-2 mb-1"> </h3> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span> <!></div></div></div></a>'),Et=l('<span>·</span> <span class="flex items-center gap-1"><svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <!></span>',1),Lt=l('<div><img class="w-full h-full object-cover" loading="lazy"/></div>'),Nt=l('<div><svg class="w-8 h-8 sm:w-10 sm:h-10 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div>'),Pt=l('<a class="block p-4 sm:p-6 hover:bg-card/30 transition-colors border-b border-border last:border-b-0"><div class="flex gap-4 sm:gap-6"><div class="flex-1 min-w-0"><h3 class="font-bold text-xl sm:text-2xl text-foreground mb-2 line-clamp-2 font-serif"> </h3> <p class="text-muted-foreground text-sm sm:text-base mb-4 line-clamp-3 leading-relaxed"> </p> <div class="flex items-center gap-3 text-xs sm:text-sm text-muted-foreground"><span class="font-medium"> </span> <!></div></div> <!></div></a>');function Er(_e,a){Ee(a,!0);const j=150,N="w-32 h-24 sm:w-40 sm:h-28";let ve=bt(a,"variant",3,"default"),Z=ne(void 0),F=ne(null);Ae(()=>{T(Z,a.article.author,!0),a.article.author.fetchProfile().then(p=>{T(F,p,!0)})});const P=Y(()=>a.article.title||"Untitled"),E=Y(()=>a.article.summary),te=Y(()=>{const p=t(E)||a.article.content;return p.slice(0,j)+(p.length>j?"...":"")}),K=Y(()=>a.article.published_at||a.article.created_at),D=Y(()=>a.article.image),de=Y(()=>kt(a.article,t(Z))),se=Y(()=>t(F)?.name||t(F)?.displayName||"Anonymous");var c=ie(),g=R(c);{var I=p=>{var d=At(),w=r(d),G=r(w);{var X=B=>{var L=zt(),k=r(L);e(L),b(()=>{A(k,"src",t(D)),A(k,"alt",t(P))}),i(B,L)},h=B=>{var L=Bt();i(B,L)};v(G,B=>{t(D)?B(X):B(h,!1)})}var M=s(G,2),J=r(M),O=r(J,!0);e(J);var W=s(J,2),Q=r(W),ce=r(Q,!0);e(Q);var ue=s(Q,2);{var ge=B=>{var L=Vt(),k=s(R(L),2);Ce(k,{get timestamp(){return t(K)}}),i(B,L)};v(ue,B=>{t(K)&&B(ge)})}e(W),e(M),e(w),e(d),b(()=>{A(d,"href",t(de)),z(O,t(P)),z(ce,t(se))}),i(p,d)},x=p=>{var d=Pt(),w=r(d),G=r(w),X=r(G),h=r(X,!0);e(X);var M=s(X,2),J=r(M,!0);e(M);var O=s(M,2),W=r(O),Q=r(W,!0);e(W);var ce=s(W,2);{var ue=k=>{var V=Et(),u=s(R(V),2),f=s(r(u),2);Ce(f,{get timestamp(){return t(K)}}),e(u),i(k,V)};v(ce,k=>{t(K)&&k(ue)})}e(O),e(G);var ge=s(G,2);{var B=k=>{var V=Lt();Ke(V,1,`${N} flex-shrink-0 rounded-lg overflow-hidden bg-muted`);var u=r(V);e(V),b(()=>{A(u,"src",t(D)),A(u,"alt",t(P))}),i(k,V)},L=k=>{var V=Nt();Ke(V,1,`${N} flex-shrink-0 rounded-lg bg-primary/10 flex items-center justify-center`),i(k,V)};v(ge,k=>{t(D)?k(B):k(L,!1)})}e(w),e(d),b(()=>{A(d,"href",t(de)),z(h,t(P)),z(J,t(te)),z(Q,t(se))}),i(p,d)};v(g,p=>{ve()==="compact"?p(I):p(x,!1)})}i(_e,c),Le()}var It=l('<div class="group"><div class="flex gap-3 items-start"><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2 mb-1"><span class="font-semibold text-foreground"> </span> <!></div> <div class="text-neutral-800 dark:text-foreground leading-relaxed whitespace-pre-wrap break-words"><!></div></div></div></div>');function $e(_e,a){Ee(a,!0);let j=ne(null);Ae(()=>{a.event.author.fetchProfile().then(x=>{T(j,x,!0)})});const N=Y(()=>t(j)?.name||t(j)?.displayName||"Anonymous");function ve(){Ct(a.event.pubkey)}var Z=It(),F=r(Z),P=r(F);P.__click=ve;var E=r(P);De(E,{get ndk(){return Me},get pubkey(){return a.event.pubkey},class:"w-10 h-10 cursor-pointer hover:opacity-80 transition-opacity"}),e(P);var te=s(P,2),K=r(te),D=r(K),de=r(D,!0);e(D);var se=s(D,2);{var c=x=>{Ce(x,{get timestamp(){return a.event.created_at},class:"text-sm text-muted-foreground"})};v(se,x=>{a.event.created_at&&x(c)})}e(K);var g=s(K,2),I=r(g);Mt(I,{get ndk(){return Me},get content(){return a.event.content},get emojiTags(){return a.event.tags}}),e(g),e(te),e(F),e(Z),b(()=>z(de,t(N))),i(_e,Z),Le()}Ge(["click"]);var Ut=l('<img class="max-w-full max-h-full object-contain"/>'),Ht=l('<video controls class="max-w-full max-h-full object-contain"><track kind="captions"/></video>',2),St=l('<div class="w-full max-w-md p-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg"><audio controls class="w-full"></audio></div>'),Yt=l('<p class="mt-3 text-gray-200 text-sm whitespace-pre-wrap break-words"> </p>'),Ft=l('<div class="flex items-center justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-white"></div></div>'),Kt=l('<div class="flex flex-col items-center justify-center p-8 text-center"><svg class="w-12 h-12 text-gray-600 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <p class="text-gray-400 text-sm">No comments yet</p> <p class="text-gray-500 text-xs mt-1">Be the first to comment!</p></div>'),Wt=l('<div class="p-4"><!></div>'),Dt=l('<div class="divide-y divide-neutral-800"></div>'),Gt=l('<div class="mb-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-red-400 text-sm"> </div>'),Rt=l('<img class="w-full h-full object-contain"/>'),Xt=l('<video controls class="w-full h-full object-contain"><track kind="captions"/></video>',2),qt=l('<div class="w-full max-w-md p-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg mx-4"><audio controls class="w-full"></audio></div>'),Zt=l('<p class="mt-3 text-white text-sm whitespace-pre-wrap break-words"> </p>'),Jt=l('<div class="absolute bottom-4 left-0 right-0 flex justify-center px-4"><button class="flex items-center gap-2 px-6 py-3 bg-white/90 hover:bg-white rounded-full transition-colors shadow-lg" type="button"><svg class="w-5 h-5 text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <span class="text-gray-900 font-medium"><!></span></button></div>'),Ot=l('<div class="flex items-center justify-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div></div>'),Qt=l('<div class="flex flex-col items-center justify-center p-8 text-center"><svg class="w-12 h-12 text-muted-foreground mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <p class="text-muted-foreground text-sm">No comments yet</p> <p class="text-muted-foreground text-xs mt-1">Be the first to comment!</p></div>'),$t=l('<div class="p-4"><!></div>'),er=l('<div class="divide-y divide-border"></div>'),tr=l('<div class="mb-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-red-400 text-sm"> </div>'),rr=l('<div class="fixed inset-0 z-[9999] bg-black" role="dialog" aria-modal="true"><div class="hidden md:flex items-center justify-center h-full w-full"><button class="absolute top-6 left-6 z-[10000] w-12 h-12 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-sm transition-colors flex items-center justify-center" type="button" aria-label="Close"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <div class="relative w-full h-full flex max-w-[1600px] mx-auto" tabindex="0"><div class="flex-1 flex items-center justify-center p-8 bg-black min-w-0"><!></div> <div class="w-[400px] bg-[#1a1a1a] border-l border-neutral-800 flex flex-col shrink-0"><div class="border-b border-neutral-800 p-4"><div class="flex items-start gap-3"><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 min-w-0"><button type="button" class="hover:underline"><p class="font-semibold text-white"> </p></button> <!></div></div> <!></div> <div class="flex-1 overflow-y-auto"><!></div> <div class="border-t border-neutral-800 p-4 bg-[#1a1a1a]"><!> <!></div></div></div></div> <div class="md:hidden flex flex-col h-full relative"><button class="absolute top-4 left-4 z-50 w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm transition-colors flex items-center justify-center" type="button" aria-label="Close"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <div class="flex-1 flex flex-col items-center justify-center bg-black overflow-hidden relative"><!> <div class="absolute top-16 left-0 right-0 p-4 bg-gradient-to-b from-black/60 to-transparent"><div class="flex items-start gap-3"><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 min-w-0"><button type="button" class="hover:underline"><p class="font-semibold text-white"> </p></button> <!></div></div> <!></div> <!></div> <div style="height: 80vh; border-top-left-radius: 16px; border-top-right-radius: 16px;"><div class="flex justify-center py-3 border-b border-border"><div class="w-12 h-1 bg-muted-foreground/30 rounded-full"></div></div> <div class="px-4 py-3 border-b border-border flex items-center justify-between"><h3 class="font-semibold text-foreground"> </h3> <button class="text-muted-foreground hover:text-foreground" type="button"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div> <div class="flex-1 overflow-y-auto"><!></div> <div class="border-t border-border p-4 bg-background"><!> <!></div></div></div></div>');function ar(_e,a){Ee(a,!0);let j=ne(""),N=ne(!1),ve=ne(0),Z=ne(0),F=ne(!1);const P=Me.$subscribe(()=>{if(!(!a.open||!a.event.id))return{filters:[{kinds:[pt.Text],"#e":[a.event.id]}],bufferMs:100}}),E=Y(()=>[...P.events].sort((h,M)=>(h.created_at||0)-(M.created_at||0))),te=Y(()=>!P.eosed);let K=ne(null);Ae(()=>{a.event.author.fetchProfile().then(h=>{T(K,h,!0)})});const D=Y(()=>t(K)?.name||t(K)?.displayName||"Anonymous"),de=Y(()=>xt.npubEncode(a.event.pubkey));function se(h){}function c(h){T(j,h,!0),setTimeout(()=>T(j,""),5e3)}function g(){window.location.href=`/p/${t(de)}`}function I(h){h.key==="Escape"&&a.onClose()}function x(h){T(ve,h.touches[0].clientY,!0),T(F,!0)}function p(h){if(!t(F))return;T(Z,h.touches[0].clientY,!0);const M=t(Z)-t(ve);!t(N)&&M<-50?(T(N,!0),T(F,!1)):t(N)&&M>50&&(T(N,!1),T(F,!1))}function d(){T(F,!1)}Ae(()=>{a.open?document.body.style.overflow="hidden":document.body.style.overflow=""});var w=ie(),G=R(w);{var X=h=>{var M=rr(),J=r(M),O=r(J);O.__click=function(...o){a.onClose?.apply(this,o)};var W=s(O,2);W.__click=o=>o.stopPropagation(),W.__keydown=I;var Q=r(W),ce=r(Q);{var ue=o=>{var n=Ut();n.__click=function(...y){a.onClose?.apply(this,y)},b(()=>{A(n,"src",a.imeta.url),A(n,"alt",a.imeta.alt||a.event.content||"Image")}),i(o,n)},ge=o=>{var n=ie(),y=R(n);{var oe=m=>{var _=Ht();b(()=>A(_,"src",a.imeta.url)),i(m,_)},le=m=>{var _=ie(),C=R(_);{var q=S=>{var ee=St(),Fe=r(ee);e(ee),b(()=>A(Fe,"src",a.imeta.url)),i(S,ee)};v(C,S=>{a.mediaType==="audio"&&S(q)},!0)}i(m,_)};v(y,m=>{a.mediaType==="video"?m(oe):m(le,!1)},!0)}i(o,n)};v(ce,o=>{a.mediaType==="image"?o(ue):o(ge,!1)})}e(Q);var B=s(Q,2),L=r(B),k=r(L),V=r(k);V.__click=g;var u=r(V);De(u,{get ndk(){return Me},get pubkey(){return a.event.pubkey},class:"w-10 h-10 cursor-pointer hover:opacity-80 transition-opacity"}),e(V);var f=s(V,2),U=r(f);U.__click=g;var me=r(U),pe=r(me,!0);e(me),e(U);var re=s(U,2);{var ae=o=>{Ce(o,{get timestamp(){return a.event.created_at},class:"text-sm text-gray-400"})};v(re,o=>{a.event.created_at&&o(ae)})}e(f),e(k);var he=s(k,2);{var H=o=>{var n=Yt(),y=r(n,!0);e(n),b(()=>z(y,a.event.content)),i(o,n)};v(he,o=>{a.event.content&&o(H)})}e(L);var $=s(L,2),fe=r($);{var be=o=>{var n=Ft();i(o,n)},Ne=o=>{var n=ie(),y=R(n);{var oe=m=>{var _=Kt();i(m,_)},le=m=>{var _=Dt();We(_,21,()=>t(E),C=>C.id,(C,q)=>{var S=Wt(),ee=r(S);$e(ee,{get event(){return t(q)}}),e(S),i(C,S)}),e(_),i(m,_)};v(y,m=>{t(E).length===0?m(oe):m(le,!1)},!0)}i(o,n)};v(fe,o=>{t(te)?o(be):o(Ne,!1)})}e($);var Te=s($,2),xe=r(Te);{var ye=o=>{var n=Gt(),y=r(n,!0);e(n),b(()=>z(y,t(j))),i(o,n)};v(xe,o=>{t(j)&&o(ye)})}var Pe=s(xe,2);Qe(Pe,{get article(){return a.event},onCommentPublished:se,onError:c}),e(Te),e(B),e(W),e(J);var ze=s(J,2),Re=r(ze);Re.__click=function(...o){a.onClose?.apply(this,o)};var we=s(Re,2);we.__touchstart=x,we.__touchmove=p,we.__touchend=d;var Xe=r(we);{var et=o=>{var n=Rt();b(()=>{A(n,"src",a.imeta.url),A(n,"alt",a.imeta.alt||a.event.content||"Image")}),i(o,n)},tt=o=>{var n=ie(),y=R(n);{var oe=m=>{var _=Xt();b(()=>A(_,"src",a.imeta.url)),i(m,_)},le=m=>{var _=ie(),C=R(_);{var q=S=>{var ee=qt(),Fe=r(ee);e(ee),b(()=>A(Fe,"src",a.imeta.url)),i(S,ee)};v(C,S=>{a.mediaType==="audio"&&S(q)},!0)}i(m,_)};v(y,m=>{a.mediaType==="video"?m(oe):m(le,!1)},!0)}i(o,n)};v(Xe,o=>{a.mediaType==="image"?o(et):o(tt,!1)})}var Ie=s(Xe,2),Ue=r(Ie),Be=r(Ue);Be.__click=g;var rt=r(Be);De(rt,{get ndk(){return Me},get pubkey(){return a.event.pubkey},class:"w-10 h-10 cursor-pointer hover:opacity-80 transition-opacity"}),e(Be);var qe=s(Be,2),Ve=r(qe);Ve.__click=g;var Ze=r(Ve),at=r(Ze,!0);e(Ze),e(Ve);var ot=s(Ve,2);{var it=o=>{Ce(o,{get timestamp(){return a.event.created_at},class:"text-sm text-white/70"})};v(ot,o=>{a.event.created_at&&o(it)})}e(qe),e(Ue);var nt=s(Ue,2);{var st=o=>{var n=Zt(),y=r(n,!0);e(n),b(()=>z(y,a.event.content)),i(o,n)};v(nt,o=>{a.event.content&&o(st)})}e(Ie);var lt=s(Ie,2);{var vt=o=>{var n=Jt(),y=r(n);y.__click=()=>T(N,!0);var oe=s(r(y),2),le=r(oe);{var m=C=>{var q=je();b(()=>z(q,`View ${t(E).length??""} ${t(E).length===1?"Comment":"Comments"}`)),i(C,q)},_=C=>{var q=je("Add Comment");i(C,q)};v(le,C=>{t(E).length>0?C(m):C(_,!1)})}e(oe),e(y),e(n),i(o,n)};v(lt,o=>{t(N)||o(vt)})}e(we);var ke=s(we,2);ke.__touchstart=x,ke.__touchmove=p,ke.__touchend=d;var He=s(r(ke),2),Se=r(He),dt=r(Se);e(Se);var ct=s(Se,2);ct.__click=()=>T(N,!1),e(He);var Ye=s(He,2),ut=r(Ye);{var mt=o=>{var n=Ot();i(o,n)},ft=o=>{var n=ie(),y=R(n);{var oe=m=>{var _=Qt();i(m,_)},le=m=>{var _=er();We(_,21,()=>t(E),C=>C.id,(C,q)=>{var S=$t(),ee=r(S);$e(ee,{get event(){return t(q)}}),e(S),i(C,S)}),e(_),i(m,_)};v(y,m=>{t(E).length===0?m(oe):m(le,!1)},!0)}i(o,n)};v(ut,o=>{t(te)?o(mt):o(ft,!1)})}e(Ye);var Je=s(Ye,2),Oe=r(Je);{var _t=o=>{var n=tr(),y=r(n,!0);e(n),b(()=>z(y,t(j))),i(o,n)};v(Oe,o=>{t(j)&&o(_t)})}var gt=s(Oe,2);Qe(gt,{get article(){return a.event},onCommentPublished:se,onError:c}),e(Je),e(ke),e(ze),e(M),yt(M,o=>jt?.(o)),b(()=>{z(pe,t(D)),z(at,t(D)),Ke(ke,1,`absolute inset-x-0 bottom-0 bg-background flex flex-col transition-transform duration-300 ease-out ${t(N)?"translate-y-0":"translate-y-full"}`),z(dt,`${t(E).length??""} ${t(E).length===1?"Comment":"Comments"}`)}),i(h,M)};v(G,h=>{a.open&&h(X)})}i(_e,w),Le()}Ge(["click","keydown","touchstart","touchmove","touchend"]);var or=l('<img class="w-full h-full object-cover transition-transform group-hover:scale-105" loading="lazy"/>'),ir=l('<div class="relative w-full h-full bg-background flex items-center justify-center"><video class="max-w-full max-h-full" preload="metadata"><track kind="captions"/></video> <div class="absolute inset-0 flex items-center justify-center pointer-events-none"><div class="w-16 h-16 bg-white/90 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-neutral-900 ml-1" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg></div></div></div>',2),nr=l('<div class="w-full h-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center"><svg class="w-16 h-16 text-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg></div>'),sr=l('<span class="text-xs text-muted-foreground px-2 text-center"> </span>'),lr=l('<div class="w-full h-full bg-background flex flex-col items-center justify-center gap-2"><svg class="w-16 h-16 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <!></div>'),vr=l('<p class="text-foreground text-sm line-clamp-2 mb-1"> </p>'),dr=l("<span> </span>"),cr=l("<span> </span>"),ur=l('<div class="absolute top-2 left-2 bg-background/50 backdrop-blur-sm px-2 py-1 rounded text-foreground text-xs"><!> <!> <!></div>'),mr=l('<button type="button" class="group relative aspect-square overflow-hidden bg-background cursor-pointer w-full"><!> <div class="absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 to-transparent p-3 opacity-0 group-hover:opacity-100 transition-opacity"><!> <div class="flex items-center gap-2 text-foreground/80 text-xs"><!> <!></div></div> <!></button>'),fr=l('<div class="grid grid-cols-3 gap-1"></div>'),_r=l("<!> <!>",1);function Lr(_e,a){Ee(a,!0);let j=ne(null);function N(c,g,I){T(j,{event:c,imeta:g,mediaType:I},!0)}function ve(){T(j,null)}function Z(c){const g=/(https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg|avif|mp4|webm|mov|avi|mkv))/gi;return c.match(g)||[]}function F(c){const g=c.m,I=c.url;if(g){if(g.startsWith("image/"))return"image";if(g.startsWith("video/"))return"video";if(g.startsWith("audio/"))return"audio"}else if(I){const x=I.split(".").pop()?.toLowerCase();if(["jpg","jpeg","png","gif","webp","svg","avif"].includes(x||""))return"image";if(["mp4","webm","mov","avi","mkv"].includes(x||""))return"video";if(["mp3","wav","ogg","flac","m4a"].includes(x||""))return"audio"}return"file"}const P=Y(()=>a.events.flatMap(c=>{const x=c.tags.filter(d=>d[0]==="imeta").map(d=>wt(d)).filter(d=>d.url).map(d=>({event:c,imeta:d}));return x.length>0?x:Z(c.content).map(d=>{const w=d.split(".").pop()?.toLowerCase(),G=["mp4","webm","mov","avi","mkv"].includes(w||"");return{event:c,imeta:{url:d,m:G?"video/"+w:"image/"+w}}})}));var E=_r(),te=R(E);{var K=c=>{Tt(c,{icon:"image",title:"No media uploaded yet"})},D=c=>{var g=fr();We(g,23,()=>t(P),({event:I,imeta:x},p)=>`${I.id}-${p}`,(I,x)=>{let p=()=>t(x).event,d=()=>t(x).imeta;const w=Y(()=>F(d())),G=Y(()=>d().size?(parseInt(d().size)/(1024*1024)).toFixed(1):null);var X=mr();X.__click=()=>N(p(),d(),t(w));var h=r(X);{var M=u=>{var f=or();b(()=>{A(f,"src",d().url),A(f,"alt",d().alt||p().content||"Image")}),i(u,f)},J=u=>{var f=ie(),U=R(f);{var me=re=>{var ae=ir(),he=r(ae);ht(2),e(ae),b(()=>A(he,"src",d().url)),i(re,ae)},pe=re=>{var ae=ie(),he=R(ae);{var H=fe=>{var be=nr();i(fe,be)},$=fe=>{var be=lr(),Ne=s(r(be),2);{var Te=xe=>{var ye=sr(),Pe=r(ye);e(ye),b(ze=>z(Pe,`${ze??""}...`),[()=>d().url.split("/").pop()?.substring(0,20)]),i(xe,ye)};v(Ne,xe=>{d().url&&xe(Te)})}e(be),i(fe,be)};v(he,fe=>{t(w)==="audio"?fe(H):fe($,!1)},!0)}i(re,ae)};v(U,re=>{t(w)==="video"?re(me):re(pe,!1)},!0)}i(u,f)};v(h,u=>{t(w)==="image"?u(M):u(J,!1)})}var O=s(h,2),W=r(O);{var Q=u=>{var f=vr(),U=r(f,!0);e(f),b(me=>z(U,me),[()=>p().content.trim()]),i(u,f)};v(W,u=>{p().content&&u(Q)})}var ce=s(W,2),ue=r(ce);{var ge=u=>{var f=dr(),U=r(f);e(f),b(()=>z(U,`${t(G)??""} MB`)),i(u,f)};v(ue,u=>{t(G)&&u(ge)})}var B=s(ue,2);{var L=u=>{var f=cr(),U=r(f,!0);e(f),b(()=>z(U,d().dim)),i(u,f)};v(B,u=>{d().dim&&u(L)})}e(ce),e(O);var k=s(O,2);{var V=u=>{var f=ur(),U=r(f);{var me=H=>{var $=je("Video");i(H,$)};v(U,H=>{t(w)==="video"&&H(me)})}var pe=s(U,2);{var re=H=>{var $=je("Audio");i(H,$)};v(pe,H=>{t(w)==="audio"&&H(re)})}var ae=s(pe,2);{var he=H=>{var $=je("File");i(H,$)};v(ae,H=>{t(w)==="file"&&H(he)})}e(f),i(u,f)};v(k,u=>{t(w)!=="image"&&u(V)})}e(X),i(I,X)}),e(g),i(c,g)};v(te,c=>{t(P).length===0?c(K):c(D,!1)})}var de=s(te,2);{var se=c=>{ar(c,{open:!0,get event(){return t(j).event},get imeta(){return t(j).imeta},get mediaType(){return t(j).mediaType},onClose:ve})};v(de,c=>{t(j)&&c(se)})}i(_e,E),Le()}Ge(["click"]);export{Er as A,Lr as M};
