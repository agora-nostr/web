import{s as k,b as Q,g as e,d as tt,p as rt,K as _e,u as Ie,i as f,k as t,t as y,e as i,h as ot,j as l,r,a as h,c as he,f as K,l as H,M as re,L as de}from"./Bq750rDx.js";import{c as at,n as Y,s,r as U,k as Ve,A as st}from"./CdRP5_sk.js";import"./DsnmJJEf.js";import{i as _}from"./BcjopvHb.js";import{e as ve}from"./Cjcfrngr.js";import{a as we}from"./BKrWP4DR.js";import{a as E,c as ce,b as it}from"./uSFILAY7.js";import{p as ye,b as lt}from"./BL6J_geM.js";import{g as ke}from"./C88829DE.js";import{u as ee}from"./BKSKCJuW.js";import{c as Ae}from"./a7XEC-kH.js";import{p as nt}from"./CK1WpjU7.js";import{f as dt}from"./BT8HVFUh.js";import{R as te}from"./DoEkGPLs.js";const Zt=at();let Se=Q("conversations");const Ut={get selected(){return e(Se)},set(fe){k(Se,fe,!0)}};var vt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),ct=f('<div class="px-2 py-1"><button class="w-full px-3 py-2.5 rounded-lg bg-muted/50 transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div> <div class="border-t border-border my-1"></div>',1),ft=re('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),ut=f('<button><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <div class="flex-1"><div class="font-medium text-foreground">Following</div> <div class="text-xs text-muted-foreground">All posts from people you follow</div></div> <!></button>'),mt=f('<div class="border-t border-border my-1"></div>'),pt=f('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),gt=f('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),xt=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),_t=f('<button><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!></button>'),ht=f('<!> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Follow Packs</div> <!></div>',1),wt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),yt=f('<button class="w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <svg class="w-3.5 h-3.5 text-primary flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div></button>'),kt=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium flex items-center justify-between"><span>Favorite Relays</span> <svg class="w-3 h-3 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div>',1),bt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),Rt=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),Mt=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div> <!></button>'),Ct=f('<div class="text-xs text-muted-foreground truncate"> </div>'),Ft=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),Lt=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div></div> <!></div> <!></button>'),jt=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Other relays</div> <!></div>',1),zt=f('<!> <!> <!> <!> <div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Agoras</div> <!></div> <!> <div class="border-t border-border mt-1"><a href="/relay-feeds" class="block w-full px-4 py-2.5 text-sm text-center text-primary hover:bg-muted transition-colors">Browse Interesting Relays</a></div>',1),Pt=f('<img alt=""/>'),Bt=f('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),It=re('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'),Vt=f('<span class="font-medium flex-1 text-left whitespace-nowrap overflow-hidden text-ellipsis"> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',1),At=f('<div class="absolute left-0 mt-1 w-64 bg-popover border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),St=f('<div class="w-80 bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Ht=f('<div class="relative"><button><!> <!></button>  <!></div>');function er(fe,oe){rt(oe,!0);const ae=ye(oe,"active",3,!1),ue=ye(oe,"collapsed",3,!1),V=ye(oe,"iconOnly",3,!1);let j=Q(!1),se=Q(null),ie=Q(_e({top:0,left:0,width:0}));const He=h(()=>{const a=Y.$sessions?.relayList;return a?Array.from(a.keys()):[]}),be=h(()=>e(He).filter(a=>!Ve(a)&&!U.isFavorite(a))),Oe=h(()=>Y.$sessions?.follows||[]),Ee=h(()=>e(Oe).size>0),Re=h(()=>!!Y.$currentUser&&e(Ee));let le=Q(_e([])),ne=Q(_e([]));Ie(()=>{const a=dt.favoritePacks;if(a.length===0){k(le,[],!0);return}Promise.all(a.map(o=>Y.fetchEvent(o))).then(o=>{k(le,o.filter(b=>b!==null),!0)}).catch(o=>{console.error("Failed to fetch favorite packs:",o),k(le,[],!0)})}),Ie(()=>{if(!Y.$currentUser){k(ne,[],!0);return}Y.fetchEvents({kinds:[39089],authors:[Y.$currentUser.pubkey]}).then(a=>{k(ne,Array.from(a),!0)}).catch(a=>{console.error("Failed to fetch user packs:",a),k(ne,[],!0)})});const me=h(()=>{const a=new Map;for(const o of e(ne))a.set(o.id,o);for(const o of e(le))a.set(o.id,o);return Array.from(a.values())}),Me=h(()=>!s.selectedRelay||q(s.selectedRelay)?null:ee(s.selectedRelay));function q(a){return a?.startsWith("followpack:")??!1}const X=h(()=>{if(!s.selectedRelay||!q(s.selectedRelay))return null;const a=s.selectedRelay.replace("followpack:","");return e(me).find(o=>o.id===a||o.encode()===a)}),Ce=h(()=>q(s.selectedRelay)&&e(X)?e(X).tagValue("title")||"Untitled Pack":s.selectedRelay&&e(Me)?.info?.name?e(Me).info.name:s.selectedRelay?s.selectedRelay.replace("wss://","").replace("ws://",""):"Following");function $e(){if(ae()||V()){if(!e(j)&&e(se)&&!V()){const a=e(se).getBoundingClientRect();k(ie,{top:a.bottom+4,left:a.left,width:a.width},!0)}k(j,!e(j))}else ke("/")}function Fe(a){s.setSelectedRelay(a),k(j,!1)}function De(){s.setSelectedRelay(null),k(j,!1)}function Ge(a){s.setSelectedRelay(`followpack:${a}`),k(j,!1)}function Le(){k(j,!1)}var pe=Ht();{const a=o=>{var b=zt(),z=K(b);{var $=c=>{const v=h(()=>ee(s.selectedRelay));var w=ct(),R=K(w),g=t(R);g.__click=()=>{k(j,!1),ke(`/?relay=${encodeURIComponent(s.selectedRelay)}`)};var m=t(g);te(m,{get relayUrl(){return s.selectedRelay},size:"md"});var p=l(m,2),d=t(p),A=t(d,!0);r(d);var F=l(d,2);{var L=M=>{var P=vt(),x=t(P,!0);r(P),y(()=>H(x,e(v).info.description)),i(M,P)};_(F,M=>{e(v).info?.description&&M(L)})}r(p),de(2),r(g),r(R),de(2),y(M=>H(A,M),[()=>e(v).info?.name||s.selectedRelay.replace("wss://","").replace("ws://","")]),i(c,w)};_(z,c=>{s.selectedRelay&&!q(s.selectedRelay)&&!U?.isFavorite(s.selectedRelay)&&!Ve(s.selectedRelay)&&c($)})}var O=l(z,2);{var u=c=>{var v=ut();v.__click=De;var w=l(t(v),4);{var R=g=>{var m=ft();i(g,m)};_(w,g=>{s.selectedRelay||g(R)})}r(v),y(()=>E(v,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay?"":"bg-muted/50"}`)),i(c,v)};_(O,c=>{e(Re)&&c(u)})}var n=l(O,2);{var D=c=>{var v=ht(),w=K(v);{var R=p=>{var d=mt();i(p,d)};_(w,p=>{e(Re)&&p(R)})}var g=l(w,2),m=l(t(g),2);ve(m,17,()=>e(me),p=>p.id,(p,d)=>{const A=h(()=>e(d).tagValue("title")||"Untitled Pack"),F=h(()=>e(d).tagValue("image")),L=h(()=>e(d).tagValue("description")),M=h(()=>e(d).tags.filter(I=>I[0]==="p").length),P=h(()=>q(s.selectedRelay)&&e(X)?.id===e(d).id);var x=_t();x.__click=()=>Ge(e(d).id);var B=t(x);{var S=I=>{var J=pt();y(()=>ce(J,"src",e(F))),i(I,J)},W=I=>{var J=gt();i(I,J)};_(B,I=>{e(F)?I(S):I(W,!1)})}var C=l(B,2),G=t(C),xe=t(G,!0);r(G);var Be=l(G,2),Ze=t(Be,!0);r(Be),r(C);var Ue=l(C,2);{var et=I=>{var J=xt();i(I,J)};_(Ue,I=>{e(P)&&I(et)})}r(x),y(()=>{E(x,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${e(P)?"bg-muted/50":""}`),H(xe,e(A)),H(Ze,e(L)||`${e(M)} members`)}),i(p,x)}),r(g),i(c,v)};_(n,c=>{e(me).length>0&&c(D)})}var T=l(n,2);{var Z=c=>{var v=kt(),w=l(K(v),2),R=l(t(w),2);ve(R,16,()=>U.relays,g=>g,(g,m)=>{const p=h(()=>ee(m));var d=yt();d.__click=()=>{k(j,!1),ke(`/?relay=${encodeURIComponent(m)}`)};var A=t(d);te(A,{get relayUrl(){return m},size:"md"});var F=l(A,2),L=t(F),M=t(L),P=t(M,!0);r(M),de(2),r(L);var x=l(L,2);{var B=S=>{var W=wt(),C=t(W,!0);r(W),y(()=>H(C,e(p).info.description)),i(S,W)};_(x,S=>{e(p).info?.description&&S(B)})}r(F),r(d),y(S=>H(P,S),[()=>e(p).info?.name||m.replace("wss://","").replace("ws://","")]),i(g,d)}),r(w),i(c,v)};_(T,c=>{U&&U.relays.length>0&&c(Z)})}var ge=l(T,4),Je=l(t(ge),2);ve(Je,16,()=>st,c=>c,(c,v)=>{const w=h(()=>ee(v));var R=Mt();R.__click=()=>Fe(v);var g=t(R);te(g,{get relayUrl(){return v},size:"md"});var m=l(g,2),p=t(m),d=t(p),A=t(d,!0);r(d),de(2),r(p);var F=l(p,2);{var L=x=>{var B=bt(),S=t(B,!0);r(B),y(()=>H(S,e(w).info.description)),i(x,B)};_(F,x=>{e(w).info?.description&&x(L)})}r(m);var M=l(m,2);{var P=x=>{var B=Rt();i(x,B)};_(M,x=>{s.selectedRelay===v&&x(P)})}r(R),y(x=>{E(R,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay===v?"bg-muted/50":""}`),H(A,x)},[()=>e(w).info?.name||v.replace("wss://","").replace("ws://","")]),i(c,R)}),r(ge);var ze=l(ge,2);{var Qe=c=>{var v=jt(),w=l(K(v),2),R=l(t(w),2);ve(R,16,()=>e(be),g=>g,(g,m)=>{const p=h(()=>ee(m));var d=Lt();d.__click=()=>Fe(m);var A=t(d);te(A,{get relayUrl(){return m},size:"md"});var F=l(A,2),L=t(F),M=t(L),P=t(M,!0);r(M),r(L);var x=l(L,2);{var B=C=>{var G=Ct(),xe=t(G,!0);r(G),y(()=>H(xe,e(p).info.description)),i(C,G)};_(x,C=>{e(p).info?.description&&C(B)})}r(F);var S=l(F,2);{var W=C=>{var G=Ft();i(C,G)};_(S,C=>{s.selectedRelay===m&&C(W)})}r(d),y(C=>{E(d,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay===m?"bg-muted/50":""}`),H(P,C)},[()=>e(p).info?.name||m.replace("wss://","").replace("ws://","")]),i(g,d)}),r(w),i(c,v)};_(ze,c=>{e(be).length>0&&c(Qe)})}var Pe=l(ze,2),Xe=t(Pe);Xe.__click=()=>k(j,!1),r(Pe),i(o,b)};var N=t(pe);N.__click=$e;var je=t(N);{var Ke=o=>{var b=he(),z=K(b);{var $=u=>{var n=Pt();y(D=>{ce(n,"src",D),E(n,1,`${V()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)},[()=>e(X).tagValue("image")]),i(u,n)},O=u=>{var n=Bt(),D=t(n);r(n),y(()=>{E(n,1,`${V()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),E(D,0,`${V()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),i(u,n)};_(z,u=>{e(X)?.tagValue("image")?u($):u(O,!1)})}i(o,b)},Ne=o=>{var b=he(),z=K(b);{var $=u=>{{let n=h(()=>V()?"md":"lg");te(u,{get relayUrl(){return s.selectedRelay},get size(){return e(n)}})}},O=u=>{var n=It();y(()=>E(n,0,V()?"w-5 h-5 text-muted-foreground":"w-6 h-6")),i(u,n)};_(z,u=>{s.selectedRelay?u($):u(O,!1)},!0)}i(o,b)};_(je,o=>{q(s.selectedRelay)?o(Ke):o(Ne,!1)})}var Te=l(je,2);{var We=o=>{var b=Vt(),z=K(b),$=t(z,!0);r(z);var O=l(z,2);y(()=>{H($,e(Ce)),E(O,0,`w-4 h-4 transition-transform ${e(j)?"rotate-180":""}`)}),i(o,b)};_(Te,o=>{!ue()&&!V()&&o(We)})}r(N),lt(N,o=>k(se,o),()=>e(se));var Ye=l(N,2);{var qe=o=>{var b=he(),z=K(b);{var $=u=>{var n=At(),D=t(n);a(D),r(n),we(n,(T,Z)=>Ae?.(T,Z),()=>Le),i(u,n)},O=u=>{var n=St(),D=t(n);a(D),r(n),we(n,T=>nt?.(T)),we(n,(T,Z)=>Ae?.(T,Z),()=>Le),y(()=>it(n,`position: fixed; top: ${e(ie).top??""}px; left: ${e(ie).left??""}px; min-width: ${e(ie).width??""}px;`)),i(u,n)};_(z,u=>{V()?u($):u(O,!1)})}i(o,b)};_(Ye,o=>{e(j)&&(ae()||V())&&o(qe)})}r(pe),y(()=>{E(N,1,V()?"flex items-center justify-center w-8 h-8 rounded-full hover:bg-muted/50 transition-colors":ue()?"flex items-center justify-center p-3 rounded-lg transition-colors w-full "+(ae()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50"):"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full "+(ae()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50")),ce(N,"aria-label",s.selectedRelay?"Change filter":"Change following filter"),ce(N,"title",ue()?e(Ce):void 0)})}i(fe,pe),ot()}tt(["click"]);export{er as R,Zt as c,Ut as h};
