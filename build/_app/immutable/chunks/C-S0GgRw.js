import{f as U,a as o,c as N,j as re,r as pe,s as W}from"./rzUyzf2y.js";import{p as q,u as Z,s as c,b as A,g as t,a as p,aO as he,e as L,r as O,t as S,c as z,B as $,d as ne,f as w}from"./AsQG98fS.js";import{s as ee}from"./DNVUPZsi.js";import{j as ke,e as X,a as B,c as ae,b as ge}from"./CS0aOiUg.js";import{p as E}from"./w-gpJwMz.js";import{D as be}from"./tv6-RHC_.js";import{t as ye}from"./0JNfDbnS.js";import{i as y}from"./DZKExFZC.js";function Ue(m){const e=m.slice(0,6),_=`#${e}`,n=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),s=parseInt(e.slice(4,6),16),i=Math.max(n,r,s)/255,a=Math.min(n,r,s)/255,h=(i+a)/2;let f=0,l=0;if(i!==a){const u=i-a;switch(l=h>.5?u/(2-i-a):u/(i+a),i){case n/255:f=((r/255-s/255)/u+(r<s?6:0))/6;break;case r/255:f=((s/255-n/255)/u+2)/6;break;case s/255:f=((n/255-r/255)/u+4)/6;break}}const I=(f*360+30)%360,j=Math.min(h*100+10,90);return`linear-gradient(135deg, ${_}, hsl(${I}, ${l*100}%, ${j}%))`}const H=Symbol("user");function Y(...m){return ye(ke(m))}var Ne=U("<div><!></div>");function we(m,e){q(e,!0);let _=E(e,"class",3,"");const n=p(()=>{if(e.user)return e.user;if(e.pubkey)try{return e.ndk.getUser({pubkey:e.pubkey})}catch{return null}return null});let r=A(null);Z(()=>{e.profile!==void 0?c(r,null):t(n)?c(r,be(()=>({user:t(n)}),e.ndk),!0):c(r,null)});const s=p(()=>e.profile!==void 0?e.profile:t(r)?.profile);he(H,{get ndk(){return e.ndk},get user(){return e.user},get ndkUser(){return t(n)},get profile(){return t(s)},get onclick(){return e.onclick}});var a=Ne(),h=L(a);ee(h,()=>e.children),O(a),S(f=>B(a,1,f),[()=>X(Y("contents",_()))]),o(m,a),z()}var xe=U('<div class="rounded-full flex items-center justify-center w-full h-full absolute inset-0"> </div>'),Ee=U("<img/>"),Ie=U("<div><!> <!></div>");function Pe(m,e){q(e,!0);let _=E(e,"class",3,"");const n=$(H);if(!n)throw new Error("User.Avatar must be used within User.Root");const r=p(()=>n.profile?.picture||e.fallback),s=p(()=>n.ndkUser?.pubkey?Ue(n.ndkUser.pubkey):"var(--primary)");let i=A(!1),a=A(!1);function h(){c(i,!0),c(a,!1)}function f(){c(i,!1),c(a,!0)}Z(()=>{c(i,!1),c(a,!1)});var l=Ie(),I=L(l);{var j=d=>{var v=N(),C=w(v);{var k=g=>{var b=N(),M=w(b);ee(M,()=>e.customFallback),o(g,b)},P=g=>{var b=xe(),M=L(b,!0);O(b),S(T=>{ge(b,`background: ${t(s)??""};`),W(M,T)},[()=>n.ndkUser?.pubkey?.slice(0,2).toUpperCase()??"??"]),o(g,b)};y(C,g=>{e.customFallback?g(k):g(P,!1)})}o(d,v)};y(I,d=>{(!t(i)||!t(r))&&d(j)})}var u=ne(I,2);{var x=d=>{var v=Ee();S(C=>{ae(v,"src",t(r)),ae(v,"alt",e.alt),B(v,1,C)},[()=>X(Y("rounded-full object-cover block w-full h-full absolute inset-0",t(i)?"opacity-100":"opacity-0"))]),re("load",v,h),re("error",v,f),pe(v),o(d,v)};y(u,d=>{t(r)&&d(x)})}O(l),S(d=>B(l,1,d),[()=>X(Y("rounded-full relative w-12 h-12",_()))]),o(m,l),z()}var Re=U("<span> </span>");function Ve(m,e){q(e,!0);let _=E(e,"field",3,"displayName"),n=E(e,"class",3,"");const r=$(H);if(!r)throw new Error("User.Name must be used within User.Root");const s=p(()=>{if(r.ndkUser)try{return r.ndkUser.pubkey}catch{return}}),i=p(()=>{if(!r.profile)return t(s)?.slice(0,8)+"..."||"Unknown";if(_()==="name")return r.profile.name||t(s)?.slice(0,8)+"...";if(_()==="displayName")return r.profile.displayName||r.profile.name||t(s)?.slice(0,8)+"...";if(_()==="both"){const f=r.profile.displayName||r.profile.name,l=r.profile.name&&r.profile.name!==r.profile.displayName?r.profile.name:null;return l?`${f} (@${l})`:f||t(s)?.slice(0,8)+"..."}return t(s)?.slice(0,8)+"..."||"Unknown"});var a=Re(),h=L(a,!0);O(a),S(f=>{B(a,1,f),W(h,t(i))},[()=>X(Y(n()))]),o(m,a),z()}var Fe=U('<span title="Verifying NIP-05...">⋯</span>'),Se=U('<span title="NIP-05 verified">✓</span>'),je=U('<span title="NIP-05 does not match pubkey">✗</span>'),Ce=U("<span> <!></span>");function Me(m,e){q(e,!0);const _=/^(?:([\w.+-]+)@)?([\w.-]+)$/;function n(k){return k||""}let r=E(e,"showNip05",3,!0),s=E(e,"showVerified",3,!0),i=E(e,"class",3,"");const a=$(H);if(!a)throw new Error("User.Nip05 must be used within User.Root");const h=p(()=>a.profile),f=p(()=>a.ndkUser),l=p(()=>t(h)?.nip05),I=p(()=>t(l)?_.test(t(l)):!1),j=p(()=>n(t(l)));let u=A(void 0),x=A(!1);Z(()=>{if(!s()||!t(l)||!t(f)||!t(I)){c(u,void 0);return}c(u,void 0),c(x,!0),t(f).validateNip05(t(l)).then(k=>{c(u,k,!0),c(x,!1)}).catch(()=>{c(u,null),c(x,!1)})});var d=N(),v=w(d);{var C=k=>{var P=Ce(),g=L(P),b=ne(g);{var M=T=>{var te=N(),se=w(te);{var ie=R=>{var G=N(),J=w(G);ee(J,()=>e.verificationSnippet,()=>({status:t(u),isVerifying:t(x)})),o(R,G)},le=R=>{var G=N(),J=w(G);{var oe=V=>{var D=Fe();o(V,D)},fe=V=>{var D=N(),ce=w(D);{var ue=F=>{var K=Se();o(F,K)},de=F=>{var K=N(),ve=w(K);{var me=Q=>{var _e=je();o(Q,_e)};y(ve,Q=>{t(u)===!1&&Q(me)},!0)}o(F,K)};y(ce,F=>{t(u)===!0?F(ue):F(de,!1)},!0)}o(V,D)};y(J,V=>{t(x)?V(oe):V(fe,!1)})}o(R,G)};y(se,R=>{e.verificationSnippet?R(ie):R(le,!1)})}o(T,te)};y(b,T=>{s()&&T(M)})}O(P),S(()=>{B(P,1,X(i())),W(g,`${t(j)??""} `)}),o(k,P)};y(v,k=>{r()&&t(l)&&k(C)})}o(m,d),z()}const Ke={Root:we,Avatar:Pe,Name:Ve,Nip05:Me};export{Ke as U,Y as c};
