import{c as P,a as p,f as D,v as lt,p as Ve}from"./rzUyzf2y.js";import{a as m,g as o,p as te,f as _,c as oe,b as V,s as i,u as _e,aN as at,E as ce,d as le,e as G,r as Z,x as Ee,t as ut}from"./AsQG98fS.js";import{i as M}from"./DZKExFZC.js";import{e as Me}from"./Cztbr3Ea.js";import{s as Q}from"./DNVUPZsi.js";import{c as X}from"./Dt3q2Svx.js";import{d as J,e as ht,c as Oe,a as dt}from"./CS0aOiUg.js";import{p as v,r as pe,s as ye}from"./w-gpJwMz.js";import{h as ct}from"./tv6-RHC_.js";import{r as pt}from"./CnuptT3n.js";import{c as he,U as be}from"./C-S0GgRw.js";import{r as gt,m as re,C as De,f as Ne,u as we,v as ft,w as ee,x as Ue,E as Ke,A as ne,y as de,z as vt,B as mt,S as bt,F as yt,G as _t,H as Nt,I as wt,J as Le,K as Ct,L as St,N as Pt,O as xt,P as It,Q as kt,T as At,U as Ot,V as Ht,W as Rt,X as Tt,Y as Ft,Z as He,_ as Vt,$ as Be,a0 as ze,a1 as We,a2 as qe,a3 as Ye,a4 as Et,a5 as Mt,a6 as Re,a7 as Ge,a8 as Dt,i as y,g as Ut,a9 as $,aa as Kt,h as Ze}from"./CVV5LOp_.js";import{g as Lt,F as Bt,a as zt,P as Wt,b as qt,M as Yt}from"./D3kz06El.js";import{b as Gt}from"./DF8Bk5Sh.js";const Zt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",transform:"translateX(-100%)"},Qt=gt(Zt);class Xt{#e=()=>{};#t=m(()=>this.#e());constructor(e,t){let r;t!==void 0&&(r=t),this.#e=()=>{try{return r}finally{r=e()}}}get current(){return o(this.#t)}}function Jt(s,e,t=!0){if(!(s.length===0||e<0||e>=s.length))return s.length===1&&e===0?s[0]:e===s.length-1?t?s[0]:void 0:s[e+1]}function jt(s,e,t=!0){if(!(s.length===0||e<0||e>=s.length))return s.length===1&&e===0?s[0]:e===0?t?s[s.length-1]:void 0:s[e-1]}function $t(s,e,t,r=!0){if(s.length===0||e<0||e>=s.length)return;let n=e+t;return r?n=(n%s.length+s.length)%s.length:n=Math.max(0,Math.min(n,s.length-1)),s[n]}function eo(s,e,t,r=!0){if(s.length===0||e<0||e>=s.length)return;let n=e-t;return r?n=(n%s.length+s.length)%s.length:n=Math.max(0,Math.min(n,s.length-1)),s[n]}var to=D("<input/>"),oo=D("<input/>");function ro(s,e){te(e,!0);let t=v(e,"value",15),r=pe(e,["$$slots","$$events","$$legacy","value"]);const n=m(()=>re(r,{"aria-hidden":"true",tabindex:-1,style:Qt}));var u=P(),h=_(u);{var b=I=>{var N=to();J(N,()=>({...o(n),value:t()}),void 0,void 0,void 0,void 0,!0),p(I,N)},x=I=>{var N=oo();J(N,()=>({...o(n)}),void 0,void 0,void 0,void 0,!0),Gt(N,t),p(I,N)};M(h,I=>{o(n).type==="checkbox"?I(b):I(x,!1)})}p(s,u),oe()}const Te=[vt,Ke,mt,bt,yt,_t,Nt,wt,Le,Ct,St,Pt,xt,It,kt,At,Ot,Ht,Rt,Tt,Ft],so=[de,Be,ze],io=[ne,We,qe],no=[...so,...io],lo=Ut({component:"select",parts:["trigger","content","item","viewport","scroll-up-button","scroll-down-button","group","group-label","separator","arrow","input","content-wrapper","item-text","value"]}),ae=new De("Select.Root | Combobox.Root"),ao=new De("Select.Content | Combobox.Content");class Qe{opts;#e=V(!1);get touchedInput(){return o(this.#e)}set touchedInput(e){i(this.#e,e,!0)}#t=V(null);get inputNode(){return o(this.#t)}set inputNode(e){i(this.#t,e,!0)}#o=V(null);get contentNode(){return o(this.#o)}set contentNode(e){i(this.#o,e,!0)}contentPresence;#r=V(null);get viewportNode(){return o(this.#r)}set viewportNode(e){i(this.#r,e,!0)}#s=V(null);get triggerNode(){return o(this.#s)}set triggerNode(e){i(this.#s,e,!0)}#i=V("");get valueId(){return o(this.#i)}set valueId(e){i(this.#i,e,!0)}#n=V(null);get highlightedNode(){return o(this.#n)}set highlightedNode(e){i(this.#n,e,!0)}#l=m(()=>this.highlightedNode?this.highlightedNode.getAttribute("data-value"):null);get highlightedValue(){return o(this.#l)}set highlightedValue(e){i(this.#l,e)}#a=m(()=>{if(this.highlightedNode)return this.highlightedNode.id});get highlightedId(){return o(this.#a)}set highlightedId(e){i(this.#a,e)}#u=m(()=>this.highlightedNode?this.highlightedNode.getAttribute("data-label"):null);get highlightedLabel(){return o(this.#u)}set highlightedLabel(e){i(this.#u,e)}isUsingKeyboard=!1;isCombobox=!1;domContext=new we(()=>null);constructor(e){this.opts=e,this.isCombobox=e.isCombobox,this.contentPresence=new Dt({ref:y(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}}),at(()=>{this.opts.open.current||this.setHighlightedNode(null)})}setHighlightedNode(e,t=!1){this.highlightedNode=e,e&&(this.isUsingKeyboard||t)&&e.scrollIntoView({block:this.opts.scrollAlignment.current})}getCandidateNodes(){const e=this.contentNode;return e?Array.from(e.querySelectorAll(`[${this.getBitsAttr("item")}]:not([data-disabled])`)):[]}setHighlightedToFirstCandidate(e=!1){this.setHighlightedNode(null);let t=this.getCandidateNodes();if(t.length){if(this.viewportNode){const r=this.viewportNode.getBoundingClientRect();t=t.filter(n=>{if(!this.viewportNode)return!1;const u=n.getBoundingClientRect();return u.right<r.right&&u.left>r.left&&u.bottom<r.bottom&&u.top>r.top})}this.setHighlightedNode(t[0],e)}}getNodeByValue(e){return this.getCandidateNodes().find(r=>r.dataset.value===e)??null}setOpen(e){this.opts.open.current=e}toggleOpen(){this.opts.open.current=!this.opts.open.current}handleOpen(){this.setOpen(!0)}handleClose(){this.setHighlightedNode(null),this.setOpen(!1)}toggleMenu(){this.toggleOpen()}getBitsAttr=e=>lo.getAttr(e,this.isCombobox?"combobox":void 0)}class uo extends Qe{opts;isMulti=!1;#e=m(()=>this.opts.value.current!=="");get hasValue(){return o(this.#e)}set hasValue(e){i(this.#e,e)}#t=m(()=>this.opts.items.current.length?this.opts.items.current.find(e=>e.value===this.opts.value.current)?.label??"":"");get currentLabel(){return o(this.#t)}set currentLabel(e){i(this.#t,e)}#o=m(()=>this.opts.items.current.length?this.opts.items.current.filter(t=>!t.disabled).map(t=>t.label):[]);get candidateLabels(){return o(this.#o)}set candidateLabels(e){i(this.#o,e)}#r=m(()=>!(this.isMulti||this.opts.items.current.length===0));get dataTypeaheadEnabled(){return o(this.#r)}set dataTypeaheadEnabled(e){i(this.#r,e)}constructor(e){super(e),this.opts=e,_e(()=>{!this.opts.open.current&&this.highlightedNode&&this.setHighlightedNode(null)}),ee(()=>this.opts.open.current,()=>{this.opts.open.current&&this.setInitialHighlightedNode()})}includesItem(e){return this.opts.value.current===e}toggleItem(e,t=e){const r=this.includesItem(e)?"":e;this.opts.value.current=r,r!==""&&(this.opts.inputValue.current=t)}setInitialHighlightedNode(){Ge(()=>{if(!(this.highlightedNode&&this.domContext.getDocument().contains(this.highlightedNode))){if(this.opts.value.current!==""){const e=this.getNodeByValue(this.opts.value.current);if(e){this.setHighlightedNode(e,!0);return}}this.setHighlightedToFirstCandidate(!0)}})}}class ho extends Qe{opts;isMulti=!0;#e=m(()=>this.opts.value.current.length>0);get hasValue(){return o(this.#e)}set hasValue(e){i(this.#e,e)}constructor(e){super(e),this.opts=e,_e(()=>{!this.opts.open.current&&this.highlightedNode&&this.setHighlightedNode(null)}),ee(()=>this.opts.open.current,()=>{this.opts.open.current&&this.setInitialHighlightedNode()})}includesItem(e){return this.opts.value.current.includes(e)}toggleItem(e,t=e){this.includesItem(e)?this.opts.value.current=this.opts.value.current.filter(r=>r!==e):this.opts.value.current=[...this.opts.value.current,e],this.opts.inputValue.current=t}setInitialHighlightedNode(){Ge(()=>{if(this.domContext&&!(this.highlightedNode&&this.domContext.getDocument().contains(this.highlightedNode))){if(this.opts.value.current.length&&this.opts.value.current[0]!==""){const e=this.getNodeByValue(this.opts.value.current[0]);if(e){this.setHighlightedNode(e,!0);return}}this.setHighlightedToFirstCandidate(!0)}})}}class co{static create(e){const{type:t,...r}=e,n=t==="single"?new uo(r):new ho(r);return ae.set(n)}}class Ce{static create(e){return new Ce(e,ae.get())}opts;root;attachment;constructor(e,t){this.opts=e,this.root=t,this.attachment=Ne(e.ref,r=>this.root.inputNode=r),this.root.domContext=new we(e.ref),this.onkeydown=this.onkeydown.bind(this),this.oninput=this.oninput.bind(this),ee([()=>this.root.opts.value.current,()=>this.opts.clearOnDeselect.current],([r,n],[u])=>{n&&(Array.isArray(r)&&Array.isArray(u)?r.length===0&&u.length!==0&&(this.root.opts.inputValue.current=""):r===""&&u!==""&&(this.root.opts.inputValue.current=""))})}onkeydown(e){if(this.root.isUsingKeyboard=!0,e.key!==Ke){if((e.key===ne||e.key===de)&&e.preventDefault(),!this.root.opts.open.current){if(Te.includes(e.key)||e.key===He||e.key===Vt&&this.root.opts.inputValue.current===""||(this.root.handleOpen(),this.root.hasValue))return;const t=this.root.getCandidateNodes();if(!t.length)return;if(e.key===de){const r=t[0];this.root.setHighlightedNode(r)}else if(e.key===ne){const r=t[t.length-1];this.root.setHighlightedNode(r)}return}if(e.key===He){this.root.handleClose();return}if(e.key===Le&&!e.isComposing){e.preventDefault();const t=this.root.highlightedValue===this.root.opts.value.current;if(!this.root.opts.allowDeselect.current&&t&&!this.root.isMulti){this.root.handleClose();return}this.root.highlightedValue&&this.root.highlightedNode&&this.root.highlightedNode.isConnected&&this.root.toggleItem(this.root.highlightedValue,this.root.highlightedLabel??void 0),!this.root.isMulti&&!t&&this.root.handleClose()}if(e.key===ne&&e.altKey&&this.root.handleClose(),no.includes(e.key)){e.preventDefault();const t=this.root.getCandidateNodes(),r=this.root.highlightedNode,n=r?t.indexOf(r):-1,u=this.root.opts.loop.current;let h;if(e.key===de?h=Jt(t,n,u):e.key===ne?h=jt(t,n,u):e.key===We?h=$t(t,n,10,u):e.key===Be?h=eo(t,n,10,u):e.key===ze?h=t[0]:e.key===qe&&(h=t[t.length-1]),!h)return;this.root.setHighlightedNode(h);return}Te.includes(e.key)||this.root.highlightedNode||this.root.setHighlightedToFirstCandidate()}}oninput(e){this.root.opts.inputValue.current=e.currentTarget.value,this.root.setHighlightedToFirstCandidate()}#e=m(()=>({id:this.opts.id.current,role:"combobox",disabled:this.root.opts.disabled.current?!0:void 0,"aria-activedescendant":this.root.highlightedId,"aria-autocomplete":"list","aria-expanded":Et(this.root.opts.open.current),"data-state":Ue(this.root.opts.open.current),"data-disabled":Ye(this.root.opts.disabled.current),onkeydown:this.onkeydown,oninput:this.oninput,[this.root.getBitsAttr("input")]:"",...this.attachment}));get props(){return o(this.#e)}set props(e){i(this.#e,e)}}class Se{static create(e){return ao.set(new Se(e,ae.get()))}opts;root;attachment;#e=V(!1);get isPositioned(){return o(this.#e)}set isPositioned(e){i(this.#e,e,!0)}domContext;constructor(e,t){this.opts=e,this.root=t,this.attachment=Ne(e.ref,r=>this.root.contentNode=r),this.domContext=new we(this.opts.ref),this.root.domContext===null&&(this.root.domContext=this.domContext),ft(()=>{this.root.contentNode=null,this.isPositioned=!1}),ee(()=>this.root.opts.open.current,()=>{this.root.opts.open.current||(this.isPositioned=!1)}),this.onpointermove=this.onpointermove.bind(this)}onpointermove(e){this.root.isUsingKeyboard=!1}#t=m(()=>Lt(this.root.isCombobox?"combobox":"select"));onInteractOutside=e=>{if(e.target===this.root.triggerNode||e.target===this.root.inputNode){e.preventDefault();return}this.opts.onInteractOutside.current(e),!e.defaultPrevented&&this.root.handleClose()};onEscapeKeydown=e=>{this.opts.onEscapeKeydown.current(e),!e.defaultPrevented&&this.root.handleClose()};onOpenAutoFocus=e=>{e.preventDefault()};onCloseAutoFocus=e=>{e.preventDefault()};get shouldRender(){return this.root.contentPresence.shouldRender}#o=m(()=>({open:this.root.opts.open.current}));get snippetProps(){return o(this.#o)}set snippetProps(e){i(this.#o,e)}#r=m(()=>({id:this.opts.id.current,role:"listbox","aria-multiselectable":this.root.isMulti?"true":void 0,"data-state":Ue(this.root.opts.open.current),[this.root.getBitsAttr("content")]:"",style:{display:"flex",flexDirection:"column",outline:"none",boxSizing:"border-box",pointerEvents:"auto",...o(this.#t)},onpointermove:this.onpointermove,...this.attachment}));get props(){return o(this.#r)}set props(e){i(this.#r,e)}popperProps={onInteractOutside:this.onInteractOutside,onEscapeKeydown:this.onEscapeKeydown,onOpenAutoFocus:this.onOpenAutoFocus,onCloseAutoFocus:this.onCloseAutoFocus,trapFocus:!1,loop:!1,onPlaced:()=>{this.root.opts.open.current&&(this.isPositioned=!0)}}}class Pe{static create(e){return new Pe(e,ae.get())}opts;root;attachment;#e=m(()=>this.root.includesItem(this.opts.value.current));get isSelected(){return o(this.#e)}set isSelected(e){i(this.#e,e)}#t=m(()=>this.root.highlightedValue===this.opts.value.current);get isHighlighted(){return o(this.#t)}set isHighlighted(e){i(this.#t,e)}prevHighlighted=new Xt(()=>this.isHighlighted);#o=V(!1);get mounted(){return o(this.#o)}set mounted(e){i(this.#o,e,!0)}constructor(e,t){this.opts=e,this.root=t,this.attachment=Ne(e.ref),ee([()=>this.isHighlighted,()=>this.prevHighlighted.current],()=>{this.isHighlighted?this.opts.onHighlight.current():this.prevHighlighted.current&&this.opts.onUnhighlight.current()}),ee(()=>this.mounted,()=>{this.mounted&&this.root.setInitialHighlightedNode()}),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onpointermove=this.onpointermove.bind(this)}handleSelect(){if(this.opts.disabled.current)return;const e=this.opts.value.current===this.root.opts.value.current;if(!this.root.opts.allowDeselect.current&&e&&!this.root.isMulti){this.root.handleClose();return}this.root.toggleItem(this.opts.value.current,this.opts.label.current),!this.root.isMulti&&!e&&this.root.handleClose()}#r=m(()=>({selected:this.isSelected,highlighted:this.isHighlighted}));get snippetProps(){return o(this.#r)}set snippetProps(e){i(this.#r,e)}onpointerdown(e){e.preventDefault()}onpointerup(e){if(!(e.defaultPrevented||!this.opts.ref.current)){if(e.pointerType==="touch"&&!Mt){lt(this.opts.ref.current,"click",()=>{this.handleSelect(),this.root.setHighlightedNode(this.opts.ref.current)},{once:!0});return}e.preventDefault(),this.handleSelect(),e.pointerType==="touch"&&this.root.setHighlightedNode(this.opts.ref.current)}}onpointermove(e){e.pointerType!=="touch"&&this.root.highlightedNode!==this.opts.ref.current&&this.root.setHighlightedNode(this.opts.ref.current)}#s=m(()=>({id:this.opts.id.current,role:"option","aria-selected":this.root.includesItem(this.opts.value.current)?"true":void 0,"data-value":this.opts.value.current,"data-disabled":Ye(this.opts.disabled.current),"data-highlighted":this.root.highlightedValue===this.opts.value.current&&!this.opts.disabled.current?"":void 0,"data-selected":this.root.includesItem(this.opts.value.current)?"":void 0,"data-label":this.opts.label.current,[this.root.getBitsAttr("item")]:"",onpointermove:this.onpointermove,onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,...this.attachment}));get props(){return o(this.#s)}set props(e){i(this.#s,e)}}class xe{static create(e){return new xe(e,ae.get())}opts;root;#e=m(()=>this.root.opts.name.current!=="");get shouldRender(){return o(this.#e)}set shouldRender(e){i(this.#e,e)}constructor(e,t){this.opts=e,this.root=t,this.onfocus=this.onfocus.bind(this)}onfocus(e){e.preventDefault(),this.root.isCombobox?this.root.inputNode?.focus():this.root.triggerNode?.focus()}#t=m(()=>({disabled:Re(this.root.opts.disabled.current),required:Re(this.root.opts.required.current),name:this.root.opts.name.current,value:this.opts.value.current,onfocus:this.onfocus}));get props(){return o(this.#t)}set props(e){i(this.#t,e)}}function Fe(s,e){te(e,!0);let t=v(e,"value",15);const r=xe.create({value:y(()=>t())});var n=P(),u=_(n);{var h=b=>{ro(b,ye(()=>r.props,{get autocomplete(){return e.autocomplete},get value(){return t()},set value(x){t(x)}}))};M(u,b=>{r.shouldRender&&b(h)})}p(s,n),oe()}var po=D("<!> <!>",1);function go(s,e){te(e,!0);let t=v(e,"value",15),r=v(e,"onValueChange",3,$),n=v(e,"name",3,""),u=v(e,"disabled",3,!1),h=v(e,"open",15,!1),b=v(e,"onOpenChange",3,$),x=v(e,"onOpenChangeComplete",3,$),I=v(e,"loop",3,!1),N=v(e,"scrollAlignment",3,"nearest"),w=v(e,"required",3,!1),O=v(e,"items",19,()=>[]),U=v(e,"allowDeselect",3,!0),C=v(e,"inputValue",7,"");if(t()===void 0){const c=e.type==="single"?"":[];t(c)}ee.pre(()=>t(),()=>{t()===void 0&&t(e.type==="single"?"":[])});const d=co.create({type:e.type,value:y(()=>t(),c=>{t(c),r()(c)}),disabled:y(()=>u()),required:y(()=>w()),open:y(()=>h(),c=>{h(c),b()(c)}),loop:y(()=>I()),scrollAlignment:y(()=>N()),name:y(()=>n()),isCombobox:!0,items:y(()=>O()),allowDeselect:y(()=>U()),inputValue:y(()=>C(),c=>C(c)),onOpenChangeComplete:y(()=>x())});var l=po(),a=_(l);Bt(a,{children:(c,E)=>{var H=P(),R=_(H);Q(R,()=>e.children??ce),p(c,H)},$$slots:{default:!0}});var g=le(a,2);{var f=c=>{var E=P(),H=_(E);{var R=K=>{var k=P(),T=_(k);Me(T,16,()=>d.opts.value.current,A=>A,(A,F)=>{Fe(A,{get value(){return F}})}),p(K,k)};M(H,K=>{d.opts.value.current.length&&K(R)})}p(c,E)},S=c=>{Fe(c,{get value(){return d.opts.value.current},set value(E){d.opts.value.current=E}})};M(g,c=>{Array.isArray(d.opts.value.current)?c(f):c(S,!1)})}p(s,l),oe()}var fo=D("<input/>");function vo(s,e){te(e,!0);let t=v(e,"id",19,Kt),r=v(e,"ref",15,null),n=v(e,"clearOnDeselect",3,!1),u=pe(e,["$$slots","$$events","$$legacy","id","ref","child","defaultValue","clearOnDeselect"]);const h=Ce.create({id:y(()=>t()),ref:y(()=>r(),N=>r(N)),clearOnDeselect:y(()=>n())});e.defaultValue&&(h.root.opts.inputValue.current=e.defaultValue);const b=m(()=>re(u,h.props,{value:h.root.opts.inputValue.current}));var x=P(),I=_(x);X(I,()=>zt,(N,w)=>{w(N,{get id(){return t()},get ref(){return h.opts.ref},children:(O,U)=>{var C=P(),d=_(C);{var l=g=>{var f=P(),S=_(f);Q(S,()=>e.child,()=>({props:o(b)})),p(g,f)},a=g=>{var f=fo();J(f,()=>({...o(b)}),void 0,void 0,void 0,void 0,!0),p(g,f)};M(d,g=>{e.child?g(l):g(a,!1)})}p(O,C)},$$slots:{default:!0}})}),p(s,x),oe()}var mo=D("<div><div><!></div></div>"),bo=D("<div><div><!></div></div>");function yo(s,e){const t=Ve();te(e,!0);let r=v(e,"id",19,()=>Ze(t)),n=v(e,"ref",15,null),u=v(e,"forceMount",3,!1),h=v(e,"side",3,"bottom"),b=v(e,"onInteractOutside",3,$),x=v(e,"onEscapeKeydown",3,$),I=v(e,"preventScroll",3,!1),N=pe(e,["$$slots","$$events","$$legacy","id","ref","forceMount","side","onInteractOutside","onEscapeKeydown","children","child","preventScroll"]);const w=Se.create({id:y(()=>r()),ref:y(()=>n(),a=>n(a)),onInteractOutside:y(()=>b()),onEscapeKeydown:y(()=>x())}),O=m(()=>re(N,w.props));var U=P(),C=_(U);{var d=a=>{Wt(a,ye(()=>o(O),()=>w.popperProps,{get ref(){return w.opts.ref},get side(){return h()},get enabled(){return w.root.opts.open.current},get id(){return r()},get preventScroll(){return I()},forceMount:!0,get shouldRender(){return w.shouldRender},popper:(f,S)=>{let c=()=>S?.().props,E=()=>S?.().wrapperProps;const H=m(()=>re(c(),{style:w.props.style}));var R=P(),K=_(R);{var k=A=>{var F=P(),L=_(F);{let B=m(()=>({props:o(H),wrapperProps:E(),...w.snippetProps}));Q(L,()=>e.child,()=>o(B))}p(A,F)},T=A=>{var F=mo();J(F,()=>({...E()}));var L=G(F);J(L,()=>({...o(H)}));var B=G(L);Q(B,()=>e.children??ce),Z(L),Z(F),p(A,F)};M(K,A=>{e.child?A(k):A(T,!1)})}p(f,R)},$$slots:{popper:!0}}))},l=a=>{var g=P(),f=_(g);{var S=c=>{qt(c,ye(()=>o(O),()=>w.popperProps,{get ref(){return w.opts.ref},get side(){return h()},get open(){return w.root.opts.open.current},get id(){return r()},get preventScroll(){return I()},forceMount:!1,get shouldRender(){return w.shouldRender},popper:(H,R)=>{let K=()=>R?.().props,k=()=>R?.().wrapperProps;const T=m(()=>re(K(),{style:w.props.style}));var A=P(),F=_(A);{var L=z=>{var q=P(),j=_(q);{let W=m(()=>({props:o(T),wrapperProps:k(),...w.snippetProps}));Q(j,()=>e.child,()=>o(W))}p(z,q)},B=z=>{var q=bo();J(q,()=>({...k()}));var j=G(q);J(j,()=>({...o(T)}));var W=G(j);Q(W,()=>e.children??ce),Z(j),Z(q),p(z,q)};M(F,z=>{e.child?z(L):z(B,!1)})}p(H,A)},$$slots:{popper:!0}}))};M(f,c=>{u()||c(S)},!0)}p(a,g)};M(C,a=>{u()?a(d):a(l,!1)})}p(s,U),oe()}var _o=D("<div><!></div>"),No=D("<!> <!>",1);function wo(s,e){const t=Ve();te(e,!0);let r=v(e,"id",19,()=>Ze(t)),n=v(e,"ref",15,null),u=v(e,"label",19,()=>e.value),h=v(e,"disabled",3,!1),b=v(e,"onHighlight",3,$),x=v(e,"onUnhighlight",3,$),I=pe(e,["$$slots","$$events","$$legacy","id","ref","value","label","disabled","children","child","onHighlight","onUnhighlight"]);const N=Pe.create({id:y(()=>r()),ref:y(()=>n(),a=>n(a)),value:y(()=>e.value),disabled:y(()=>h()),label:y(()=>u()),onHighlight:y(()=>b()),onUnhighlight:y(()=>x())}),w=m(()=>re(I,N.props));var O=No(),U=_(O);{var C=a=>{var g=P(),f=_(g);{let S=m(()=>({props:o(w),...N.snippetProps}));Q(f,()=>e.child,()=>o(S))}p(a,g)},d=a=>{var g=_o();J(g,()=>({...o(w)}));var f=G(g);Q(f,()=>e.children??ce,()=>N.snippetProps),Z(g),p(a,g)};M(U,a=>{e.child?a(C):a(d,!1)})}var l=le(U,2);Yt(l,{get mounted(){return N.mounted},set mounted(a){N.mounted=a}}),p(s,O),oe()}const Co=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,So=/^(npub1|nprofile1)[a-z0-9]{20,}/i;function Po(s,e){const t=pt(e);let r=V(Ee([])),n=V(null),u=V(!1),h=null,b=null;async function x(d){if(!d.trim())return[];const l=t.cacheAdapter;if(!l?.getProfiles){const f=l?.getAllProfilesSync?.()||new Map,S=[],c=d.toLowerCase();for(const[E,H]of f){const R="profile"in H?H.profile:H;if(R.name?.toLowerCase().includes(c)||R.displayName?.toLowerCase().includes(c)||R.nip05?.toLowerCase().includes(c)||R.about?.toLowerCase().includes(c)){const K=t.getUser({pubkey:E});S.push({user:K})}}return S}const a=await l.getProfiles({fields:["name","displayName","nip05","about"],contains:d});return a?Array.from(a.keys()).map(f=>({user:t.getUser({pubkey:f})})):[]}async function I(d){try{const l=await t.fetchUser(d);return l?{user:l}:null}catch{return null}}async function N(d){if(!d.trim()){i(r,[],!0);return}const l=await x(d);l.sort((a,g)=>{const f=t.$follows.has(a.user.pubkey),S=t.$follows.has(g.user.pubkey);return f&&!S?-1:!f&&S?1:0}),i(r,l,!0)}async function w(d){i(u,!0);const l=await I(d);if(l){const a=o(r).findIndex(g=>g.user.pubkey===l.user.pubkey);a===-1?t.$follows.has(l.user.pubkey)?i(r,[l,...o(r)],!0):i(r,[...o(r),l],!0):o(r)[a]=l}i(u,!1)}function O(d,l){if(b&&(b.stop(),b=null),!d.trim()||l.length===0)return;i(u,!0);const a=l.map(S=>t.pool.getRelay(S,!0,!0)),g=new ct(new Set(a),t),f=t.subscribe({kinds:[0],search:d},{closeOnEose:!0,groupable:!1,subId:"user-search"},g,!1);b=f,f.on("event",S=>{const c=t.getUser({pubkey:S.pubkey});o(r).findIndex(H=>H.user.pubkey===c.pubkey)===-1&&(t.$follows.has(c.pubkey)?i(r,[{user:c},...o(r)],!0):i(r,[...o(r),{user:c}],!0))}),f.on("eose",()=>{i(u,!1)}),f.start()}_e(()=>{const{query:d,debounceMs:l=300,relaySearch:a}=s();h&&(clearTimeout(h),h=null),b&&(b.stop(),b=null),N(d);const g=Co.test(d),f=So.test(d);return(g||f||a)&&(h=setTimeout(()=>{(g||f)&&w(d),a&&a.length>0&&O(d,a)},l)),()=>{h&&(clearTimeout(h),h=null),b&&(b.stop(),b=null)}});function U(d){i(n,d,!0);const{onSelect:l}=s();l&&l(d)}function C(){i(n,null),i(r,[],!0)}return{get results(){return o(r)},get selectedUser(){return o(n)},get loading(){return o(u)},selectUser:U,clear:C}}var xo=D('<div class="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"><svg class="animate-spin h-4 w-4 text-muted-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>'),Io=D('<div class="flex items-center gap-3 w-full"><!> <div class="flex-1 min-w-0"><!></div></div>'),ko=D('<div class="py-6 text-center text-sm text-muted-foreground">No users found</div>'),Ao=D('<div class="relative"><!> <!></div> <!>',1),Oo=D('<div data-user-search-combobox=""><!></div>');function Go(s,e){te(e,!0);let t=v(e,"placeholder",3,"Search users by name, NIP-05, npub..."),r=v(e,"debounceMs",3,300),n=v(e,"class",3,""),u=V(""),h=V(Ee([])),b=V(!1);const x=Po(()=>({query:o(u),onSelect:C=>{e.onSelect&&e.onSelect(C),i(b,!1),i(u,""),i(h,[],!0)},debounceMs:r()}),e.ndk),I=m(()=>x.results.slice(0,8));function N(C){if(i(h,C,!0),C.length>0){const d=C[0],l=o(I).find(a=>a.user.pubkey===d);l&&x.selectUser(l.user)}}function w(C){i(u,C.target.value,!0)}var O=Oo(),U=G(O);X(U,()=>go,(C,d)=>{d(C,{type:"multiple",onValueChange:N,get open(){return o(b)},set open(l){i(b,l,!0)},get value(){return o(h)},set value(l){i(h,l,!0)},children:(l,a)=>{var g=Ao(),f=_(g),S=G(f);{var c=k=>{var T=P(),A=_(T);Q(A,()=>e.input,()=>({value:o(u),oninput:w,loading:x.loading})),p(k,T)},E=k=>{var T=P(),A=_(T);{let F=m(()=>he("flex h-10 w-full rounded-md border border-border bg-background px-3 py-2 text-sm","placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:cursor-not-allowed disabled:opacity-50"));X(A,()=>vo,(L,B)=>{B(L,{oninput:z=>i(u,z.currentTarget.value,!0),get placeholder(){return t()},"aria-label":"Search users",get class(){return o(F)}})})}p(k,T)};M(S,k=>{e.input?k(c):k(E,!1)})}var H=le(S,2);{var R=k=>{var T=xo();p(k,T)};M(H,k=>{x.loading&&k(R)})}Z(f);var K=le(f,2);{let k=m(()=>he("z-50 max-h-96 min-w-full overflow-y-auto rounded-md border border-border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95"));X(K,()=>yo,(T,A)=>{A(T,{get class(){return o(k)},sideOffset:4,children:(F,L)=>{var B=P(),z=_(B);{var q=W=>{var se=P(),ge=_(se);Me(ge,17,()=>o(I),ie=>ie.user.pubkey,(ie,Y)=>{var ue=P(),Xe=_(ue);{let Je=m(()=>o(Y).user.profile?.displayName||o(Y).user.profile?.name||o(Y).user.npub),je=m(()=>he("relative flex cursor-pointer select-none items-center gap-3 px-4 py-3 border-b border-border last:border-b-0","data-[highlighted]:bg-muted/50 transition-colors outline-none"));X(Xe,()=>wo,($e,et)=>{et($e,{get value(){return o(Y).user.pubkey},get label(){return o(Je)},get class(){return o(je)},children:(tt,Ho)=>{var Ie=P(),ot=_(Ie);X(ot,()=>be.Root,(rt,st)=>{st(rt,{get ndk(){return e.ndk},get pubkey(){return o(Y).user.pubkey},children:(it,Ro)=>{var fe=Io(),ke=G(fe);X(ke,()=>be.Avatar,(ve,me)=>{me(ve,{class:"w-10 h-10"})});var Ae=le(ke,2),nt=G(Ae);X(nt,()=>be.Name,(ve,me)=>{me(ve,{field:"displayName",class:"text-sm truncate"})}),Z(Ae),Z(fe),p(it,fe)},$$slots:{default:!0}})}),p(tt,Ie)},$$slots:{default:!0}})})}p(ie,ue)}),p(W,se)},j=W=>{var se=P(),ge=_(se);{var ie=Y=>{var ue=ko();p(Y,ue)};M(ge,Y=>{o(u).trim().length>0&&!x.loading&&Y(ie)},!0)}p(W,se)};M(z,W=>{o(I).length>0?W(q):W(j,!1)})}p(F,B)},$$slots:{default:!0}})})}p(l,g)},$$slots:{default:!0}})}),Z(O),ut(C=>{Oe(O,"data-loading",x.loading?"":void 0),Oe(O,"data-open",o(b)?"":void 0),dt(O,1,C)},[()=>ht(he("relative w-full",n()))]),p(s,O),oe()}export{Go as U};
