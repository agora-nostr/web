import{d as Ve,f as O,a as i,c as ne,s as c,i as N}from"./rzUyzf2y.js";import{p as Be,e as t,r,d as s,c as Ue,u as xe,s as se,b as _e,g as e,a as J,f as Q,t as te}from"./AsQG98fS.js";import{i as u}from"./DZKExFZC.js";import{c as ye}from"./Dt3q2Svx.js";import{a as be}from"./CS0aOiUg.js";import{p as ue}from"./w-gpJwMz.js";import{n as Te,d as Se}from"./tv6-RHC_.js";import{U as Ce}from"./C-S0GgRw.js";import{U as Me}from"./DdUskozk.js";import{T as He}from"./2VdFane9.js";import{E as Ee}from"./CCwRoHwR.js";import{E as ze}from"./Cxhu68Im.js";import{g as Ie}from"./BgxlgyeA.js";var Pe=O('<div class="flex items-center gap-2 sm:gap-3"><div class="flex items-center gap-2 flex-1 min-w-0"><!></div> <!> <!></div>');function je(f,a){Be(a,!0);const M=ue(a,"avatarClass",3,"w-9 h-9 sm:w-12 sm:h-12"),D=ue(a,"nameClass",3,"text-base font-semibold"),W=ue(a,"variant",3,"compact");var g=Pe(),m=t(g);m.__click=n=>n.stopPropagation();var fe=t(m);{var X=n=>{Me(n,{get pubkey(){return a.event.pubkey},variant:"avatar-name-handle",get avatarSize(){return M()},get nameSize(){return D()}})},h=n=>{Me(n,{get pubkey(){return a.event.pubkey},variant:"avatar-name-meta",get avatarSize(){return M()},get nameSize(){return D()}})};u(fe,n=>{W()==="compact"?n(X):n(h,!1)})}r(m);var ie=s(m,2);{var Y=n=>{He(n,{get timestamp(){return a.event.created_at},class:"text-muted-foreground text-sm flex-shrink-0"})};u(ie,n=>{a.event.created_at&&n(Y)})}var re=s(ie,2);Ee(re,{get event(){return a.event}}),r(g),i(f,g),Ue()}Ve(["click"]);const de=new Map;async function Re(f){if(de.has(f))return de.get(f)??null;try{const a=`https://api.allorigins.win/get?url=${encodeURIComponent(f)}`,M=await fetch(a);if(!M.ok)return de.set(f,null),null;const W=(await M.json()).contents,g=Oe(W);return de.set(f,g),g}catch(a){return console.error("Failed to fetch URL metadata:",a),de.set(f,null),null}}function Oe(f){const a={},M=f.match(/<meta\s+property=["']og:title["']\s+content=["']([^"']+)["']/i),D=f.match(/<meta\s+property=["']og:description["']\s+content=["']([^"']+)["']/i),W=f.match(/<meta\s+property=["']og:image["']\s+content=["']([^"']+)["']/i),g=f.match(/<meta\s+property=["']og:site_name["']\s+content=["']([^"']+)["']/i),m=f.match(/<title[^>]*>([^<]+)<\/title>/i);return a.title=M?.[1]||m?.[1],a.description=D?.[1],a.image=W?.[1],a.siteName=g?.[1],a}var De=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),Fe=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),qe=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),Ke=O('<button type="button" class="absolute bottom-3 right-3 flex items-center gap-2 px-3 py-1.5 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[200px] truncate"> </span></button>'),Ge=O('<article class="p-3 sm:p-4 hover:bg-card/30 transition-colors border-b border-border"><div class="mb-3"><!></div> <div class="relative rounded-lg overflow-hidden bg-card border border-border shadow-lg mb-2 cursor-pointer"><div class="relative flex flex-col items-center justify-center py-12 sm:py-16 px-8 sm:px-12 min-h-[200px] max-h-[600px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <!></div> <!></article>'),Je=O("<span>·</span> <!>",1),Qe=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),We=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),Xe=O('<span>·</span> <span class="flex items-center gap-1"><!> </span>',1),Ye=O('<div class="block p-4 hover:bg-card/30 transition-colors rounded-lg group cursor-pointer"><div class="relative"><div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-primary/60 to-primary rounded-full"></div> <div class="pl-4"><div class="mb-3 relative"><p class="relative text-foreground text-base leading-relaxed font-serif italic"> <mark class="bg-primary/20 text-foreground font-medium not-italic"> </mark> </p></div> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span> <!> <!></div></div></div></div>'),Ze=N('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),$e=N('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),et=N('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),tt=O('<button type="button" class="absolute bottom-2 right-2 flex items-center gap-1.5 px-2 py-1 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[100px] truncate text-[10px]"> </span></button>'),rt=O('<article class="hover:bg-card/30 transition-colors w-full"><div class="relative aspect-square rounded-lg overflow-hidden bg-card border border-border shadow-lg w-full cursor-pointer"><div class="relative flex flex-col items-center justify-center p-4 sm:p-6 min-h-[150px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <div class="absolute bottom-2 left-2"><svg class="w-4 h-4 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M18.5 1.15a2.25 2.25 0 00-3.18 0L3.78 12.69a2.25 2.25 0 000 3.18l4.35 4.35a2.25 2.25 0 003.18 0L22.85 8.68a2.25 2.25 0 000-3.18l-4.35-4.35zM9.93 18.84L5.16 14.07 15.3 3.93l4.77 4.77-10.14 10.14z"></path><path d="M2.5 22.5h10v1.5h-10z" opacity="0.5"></path></svg></div> <!></div> <div class="flex items-center gap-2 mt-2 px-1"><!> <span class="text-xs text-muted-foreground truncate"> </span></div></article>'),at=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),ot=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),nt=N('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),st=O('<button type="button" class="absolute bottom-3 right-3 flex items-center gap-2 px-3 py-1.5 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[200px] truncate"> </span></button>'),it=O('<article class="p-3 sm:p-4 hover:bg-card/30 transition-colors border-b border-border"><div class="mb-3"><!></div> <div class="relative rounded-lg overflow-hidden bg-card border border-border shadow-lg mb-2 cursor-pointer"><div class="relative flex flex-col items-center justify-center py-12 sm:py-16 px-8 sm:px-12 min-h-[200px] max-h-[600px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <!></div> <!></article>');function kt(f,a){Be(a,!0);let M=ue(a,"variant",3,"default"),D=_e(null);xe(()=>{a.event.author.fetchProfile().then(o=>{se(D,o,!0)})});const W=J(()=>e(D)?.name||e(D)?.displayName||"Anonymous"),g=J(()=>a.event.content),m=J(()=>{const o=a.event.tags.find(y=>y[0]==="a"),l=a.event.tags.find(y=>y[0]==="e"),w=a.event.tags.find(y=>y[0]==="r");return o||l||w}),fe=J(()=>a.event.tags.find(o=>o[0]==="context")),X=J(()=>e(fe)?.[1]||e(g)),h=J(()=>{if(!e(X)||e(X)===e(g))return{before:"",highlight:e(g),after:""};const o=e(X).indexOf(e(g));return o===-1?{before:"",highlight:e(g),after:""}:{before:e(X).slice(0,o),highlight:e(g),after:e(X).slice(o+e(g).length)}}),ie=J(()=>{const o=e(X).length;return M()==="grid"?o<100?"text-base":o<200?"text-sm":"text-xs":o<100?"text-2xl sm:text-3xl md:text-4xl":o<200?"text-xl sm:text-2xl md:text-3xl":o<350?"text-lg sm:text-xl md:text-2xl":o<500?"text-base sm:text-lg md:text-xl":"text-sm sm:text-base md:text-lg"});let Y=_e(void 0),re=_e(null);xe(()=>{if(!e(m)||e(m)[0]!=="a"){se(Y,void 0);return}const l=e(m)[1].split(":");if(l.length!==3){se(Y,void 0);return}const[w,y,S]=l;Te.guardrailOff("fetch-events-usage").fetchEvent({kinds:[parseInt(w)],authors:[y],"#d":[S]}).then(T=>{T&&se(Y,Se.from(T),!0)})}),xe(()=>{if(!e(m)||e(m)[0]!=="r"){se(re,null);return}const o=e(m)[1];Re(o).then(l=>{se(re,l,!0)}).catch(l=>{console.error("Failed to fetch URL metadata:",l),se(re,null)})});const n=J(()=>{if(!e(m))return null;const o=e(m)[0],l=e(m)[1];if(o==="r"){const w=e(re)?.title||e(re)?.siteName;if(w)return{type:"web",displayText:w,url:l};try{return{type:"web",displayText:new URL(l).hostname.replace("www.",""),url:l}}catch{return{type:"web",displayText:l,url:l}}}else{if(o==="a")return{type:"article",displayText:e(Y)?.tags.find(S=>S[0]==="title")?.[1]||"Article",value:l};if(o==="e")return{type:"event",displayText:"Note",value:l}}return null}),ke=J(()=>a.event.created_at);function ce(){const o=a.event.encode();window.location.href=`/e/${o}`}function ge(o){if(o.stopPropagation(),e(n)?.type==="web"&&e(n).url)window.open(e(n).url,"_blank","noopener,noreferrer");else if(e(n)?.type==="article"&&e(Y)){const l=Ie(e(Y));window.location.href=l}}var we=ne(),Ae=Q(we);{var Le=o=>{var l=Ge(),w=t(l),y=t(w);je(y,{get event(){return a.event},avatarClass:"w-9 h-9 sm:w-12 sm:h-12"}),r(w);var S=s(w,2);S.__click=ce;var T=t(S),E=t(T),Z=t(E),ae=t(Z,!0),F=s(ae),B=t(F,!0);r(F);var z=s(F,1,!0);r(Z),r(E),r(T);var x=s(T,2);{var q=_=>{var b=Ke();b.__click=ge;var j=t(b);{var K=v=>{var p=De();i(v,p)},G=v=>{var p=ne(),H=Q(p);{var I=d=>{var V=Fe();i(d,V)},k=d=>{var V=qe();i(d,V)};u(H,d=>{e(n).type==="article"?d(I):d(k,!1)},!0)}i(v,p)};u(j,v=>{e(n).type==="web"?v(K):v(G,!1)})}var $=s(j,2),oe=t($,!0);r($),r(b),te(()=>c(oe,e(n).displayText)),i(_,b)};u(x,_=>{e(n)&&_(q)})}r(S);var U=s(S,2);ze(U,{get event(){return a.event}}),r(l),te(()=>{be(Z,1,`text-card-foreground ${e(ie)??""} font-serif leading-relaxed text-center`),c(ae,e(h).before),c(B,e(h).highlight),c(z,e(h).after)}),i(o,l)},Ne=o=>{var l=ne(),w=Q(l);{var y=T=>{var E=Ye();E.__click=ce;var Z=t(E),ae=s(t(Z),2),F=t(ae),B=t(F),z=t(B),x=s(z),q=t(x,!0);r(x);var U=s(x);r(B),r(F);var _=s(F,2),b=t(_),j=t(b,!0);r(b);var K=s(b,2);{var G=v=>{var p=Je(),H=s(Q(p),2);He(H,{get timestamp(){return e(ke)}}),i(v,p)};u(K,v=>{e(ke)&&v(G)})}var $=s(K,2);{var oe=v=>{var p=Xe(),H=s(Q(p),2),I=t(H);{var k=A=>{var L=Qe();i(A,L)},d=A=>{var L=We();i(A,L)};u(I,A=>{e(n).type==="web"?A(k):A(d,!1)})}var V=s(I);r(H),te(()=>c(V,` ${e(n).displayText??""}`)),i(v,p)};u($,v=>{e(n)&&v(oe)})}r(_),r(ae),r(Z),r(E),te(()=>{c(z,`"${e(h).before??""}`),c(q,e(h).highlight),c(U,`${e(h).after??""}"`),c(j,e(W))}),i(T,E)},S=T=>{var E=ne(),Z=Q(E);{var ae=B=>{var z=rt(),x=t(z);x.__click=ce;var q=t(x),U=t(q),_=t(U),b=t(_,!0),j=s(b),K=t(j,!0);r(j);var G=s(j,1,!0);r(_),r(U),r(q);var $=s(q,4);{var oe=k=>{var d=tt();d.__click=ge;var V=t(d);{var A=C=>{var ve=Ze();i(C,ve)},L=C=>{var ve=ne(),me=Q(ve);{var pe=R=>{var he=$e();i(R,he)},ee=R=>{var he=et();i(R,he)};u(me,R=>{e(n).type==="article"?R(pe):R(ee,!1)},!0)}i(C,ve)};u(V,C=>{e(n).type==="web"?C(A):C(L,!1)})}var le=s(V,2),P=t(le,!0);r(le),r(d),te(()=>c(P,e(n).displayText)),i(k,d)};u($,k=>{e(n)&&k(oe)})}r(x);var v=s(x,2),p=t(v);ye(p,()=>Ce.Root,(k,d)=>{d(k,{get ndk(){return Te},get pubkey(){return a.event.pubkey},children:(V,A)=>{var L=ne(),le=Q(L);ye(le,()=>Ce.Avatar,(P,C)=>{C(P,{class:"w-5 h-5 rounded-full"})}),i(V,L)},$$slots:{default:!0}})});var H=s(p,2),I=t(H,!0);r(H),r(v),r(z),te(()=>{be(_,1,`text-card-foreground ${e(ie)??""} font-serif leading-relaxed text-center line-clamp-6`),c(b,e(h).before),c(K,e(h).highlight),c(G,e(h).after),c(I,e(W))}),i(B,z)},F=B=>{var z=it(),x=t(z),q=t(x);je(q,{get event(){return a.event},avatarClass:"w-9 h-9 sm:w-12 sm:h-12"}),r(x);var U=s(x,2);U.__click=ce;var _=t(U),b=t(_),j=t(b),K=t(j,!0),G=s(K),$=t(G,!0);r(G);var oe=s(G,1,!0);r(j),r(b),r(_);var v=s(_,2);{var p=I=>{var k=st();k.__click=ge;var d=t(k);{var V=P=>{var C=at();i(P,C)},A=P=>{var C=ne(),ve=Q(C);{var me=ee=>{var R=ot();i(ee,R)},pe=ee=>{var R=nt();i(ee,R)};u(ve,ee=>{e(n).type==="article"?ee(me):ee(pe,!1)},!0)}i(P,C)};u(d,P=>{e(n).type==="web"?P(V):P(A,!1)})}var L=s(d,2),le=t(L,!0);r(L),r(k),te(()=>c(le,e(n).displayText)),i(I,k)};u(v,I=>{e(n)&&I(p)})}r(U);var H=s(U,2);ze(H,{get event(){return a.event}}),r(z),te(()=>{be(j,1,`text-card-foreground ${e(ie)??""} font-serif leading-relaxed text-center`),c(K,e(h).before),c($,e(h).highlight),c(oe,e(h).after)}),i(B,z)};u(Z,B=>{M()==="grid"?B(ae):B(F,!1)},!0)}i(T,E)};u(w,T=>{M()==="compact"?T(y):T(S,!1)},!0)}i(o,l)};u(Ae,o=>{M()==="feed"?o(Le):o(Ne,!1)})}i(f,we),Ue()}Ve(["click"]);export{kt as H};
