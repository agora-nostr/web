import{s as k,b as Q,g as e,p as tt,x as _e,u as Ie,e as t,t as y,c as rt,d as l,r,a as h,f as N,y as de}from"./AsQG98fS.js";import{c as ot,n as q,s,r as U,k as Ve,A as at}from"./tv6-RHC_.js";import{d as st,f,a as i,c as he,s as H,i as re}from"./rzUyzf2y.js";import{i as _}from"./DZKExFZC.js";import{e as ve}from"./Cztbr3Ea.js";import{a as we}from"./CO-nanZk.js";import{a as E,c as ce,b as it}from"./CS0aOiUg.js";import{b as lt}from"./CkKAtl6l.js";import{p as ye}from"./w-gpJwMz.js";import{g as ke}from"./s53o-P2j.js";import{u as ee}from"./DHRuQT7d.js";import{c as Ae}from"./a7XEC-kH.js";import{p as nt}from"./DkZQAMY8.js";import{f as dt}from"./WdaJccXC.js";import{R as te}from"./ymyJjmi3.js";const Ut=ot();let Se=Q("conversations");const er={get selected(){return e(Se)},set(fe){k(Se,fe,!0)}};var vt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),ct=f('<div class="px-2 py-1"><button class="w-full px-3 py-2.5 rounded-lg bg-muted/50 transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div> <div class="border-t border-border my-1"></div>',1),ft=re('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),ut=f('<button><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <div class="flex-1"><div class="font-medium text-foreground">Following</div> <div class="text-xs text-muted-foreground">All posts from people you follow</div></div> <!></button>'),mt=f('<div class="border-t border-border my-1"></div>'),pt=f('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),xt=f('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),gt=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),_t=f('<button><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!></button>'),ht=f('<!> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Follow Packs</div> <!></div>',1),wt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),yt=f('<button class="w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <svg class="w-3.5 h-3.5 text-primary flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div></button>'),kt=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium flex items-center justify-between"><span>Favorite Relays</span> <svg class="w-3 h-3 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div>',1),bt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),Rt=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),Mt=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div> <!></button>'),Ct=f('<div class="text-xs text-muted-foreground truncate"> </div>'),Ft=re('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),zt=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div></div> <!></div> <!></button>'),Lt=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Other relays</div> <!></div>',1),jt=f('<!> <!> <!> <!> <div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Agoras</div> <!></div> <!> <div class="border-t border-border mt-1"><a href="/relay-feeds" class="block w-full px-4 py-2.5 text-sm text-center text-primary hover:bg-muted transition-colors">Browse Interesting Relays</a></div>',1),Pt=f('<img alt=""/>'),Bt=f('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),It=re('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'),Vt=f('<span class="font-medium flex-1 text-left whitespace-nowrap overflow-hidden text-ellipsis"> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',1),At=f('<div class="absolute left-0 mt-1 w-64 bg-popover border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),St=f('<div class="w-80 bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Ht=f('<div class="relative"><button><!> <!></button>  <!></div>');function tr(fe,oe){tt(oe,!0);const ae=ye(oe,"active",3,!1),ue=ye(oe,"collapsed",3,!1),V=ye(oe,"iconOnly",3,!1);let L=Q(!1),se=Q(null),ie=Q(_e({top:0,left:0,width:0}));const He=h(()=>{const a=q.$sessions?.relayList;return a?Array.from(a.keys()):[]}),be=h(()=>e(He).filter(a=>!Ve(a)&&!U.isFavorite(a))),Oe=h(()=>q.$sessions?.follows||[]),Ee=h(()=>e(Oe).size>0),Re=h(()=>!!q.$currentUser&&e(Ee));let le=Q(_e([])),ne=Q(_e([]));Ie(()=>{const a=dt.favoritePacks;if(a.length===0){k(le,[],!0);return}Promise.all(a.map(o=>q.fetchEvent(o))).then(o=>{k(le,o.filter(b=>b!==null),!0)}).catch(o=>{console.error("Failed to fetch favorite packs:",o),k(le,[],!0)})}),Ie(()=>{if(!q.$currentUser){k(ne,[],!0);return}q.fetchEvents({kinds:[39089],authors:[q.$currentUser.pubkey]}).then(a=>{k(ne,Array.from(a),!0)}).catch(a=>{console.error("Failed to fetch user packs:",a),k(ne,[],!0)})});const me=h(()=>{const a=new Map;for(const o of e(ne))a.set(o.id,o);for(const o of e(le))a.set(o.id,o);return Array.from(a.values())}),Me=h(()=>!s.selectedRelay||J(s.selectedRelay)?null:ee(s.selectedRelay));function J(a){return a?.startsWith("followpack:")??!1}const X=h(()=>{if(!s.selectedRelay||!J(s.selectedRelay))return null;const a=s.selectedRelay.replace("followpack:","");return e(me).find(o=>o.id===a||o.encode()===a)}),Ce=h(()=>J(s.selectedRelay)&&e(X)?e(X).tagValue("title")||"Untitled Pack":s.selectedRelay&&e(Me)?.info?.name?e(Me).info.name:s.selectedRelay?s.selectedRelay.replace("wss://","").replace("ws://",""):"Following");function $e(){if(ae()||V()){if(!e(L)&&e(se)&&!V()){const a=e(se).getBoundingClientRect();k(ie,{top:a.bottom+4,left:a.left,width:a.width},!0)}k(L,!e(L))}else ke("/")}function Fe(a){s.setSelectedRelay(a),k(L,!1)}function De(){s.setSelectedRelay(null),k(L,!1)}function Ge(a){s.setSelectedRelay(`followpack:${a}`),k(L,!1)}function ze(){k(L,!1)}var pe=Ht();{const a=o=>{var b=jt(),j=N(b);{var $=c=>{const v=h(()=>ee(s.selectedRelay));var w=ct(),R=N(w),x=t(R);x.__click=()=>{k(L,!1),ke(`/?relay=${encodeURIComponent(s.selectedRelay)}`)};var m=t(x);te(m,{get relayUrl(){return s.selectedRelay},size:"md"});var p=l(m,2),d=t(p),A=t(d,!0);r(d);var F=l(d,2);{var z=M=>{var P=vt(),g=t(P,!0);r(P),y(()=>H(g,e(v).info.description)),i(M,P)};_(F,M=>{e(v).info?.description&&M(z)})}r(p),de(2),r(x),r(R),de(2),y(M=>H(A,M),[()=>e(v).info?.name||s.selectedRelay.replace("wss://","").replace("ws://","")]),i(c,w)};_(j,c=>{s.selectedRelay&&!J(s.selectedRelay)&&!U?.isFavorite(s.selectedRelay)&&!Ve(s.selectedRelay)&&c($)})}var O=l(j,2);{var u=c=>{var v=ut();v.__click=De;var w=l(t(v),4);{var R=x=>{var m=ft();i(x,m)};_(w,x=>{s.selectedRelay||x(R)})}r(v),y(()=>E(v,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay?"":"bg-muted/50"}`)),i(c,v)};_(O,c=>{e(Re)&&c(u)})}var n=l(O,2);{var D=c=>{var v=ht(),w=N(v);{var R=p=>{var d=mt();i(p,d)};_(w,p=>{e(Re)&&p(R)})}var x=l(w,2),m=l(t(x),2);ve(m,17,()=>e(me),p=>p.id,(p,d)=>{const A=h(()=>e(d).tagValue("title")||"Untitled Pack"),F=h(()=>e(d).tagValue("image")),z=h(()=>e(d).tagValue("description")),M=h(()=>e(d).tags.filter(I=>I[0]==="p").length),P=h(()=>J(s.selectedRelay)&&e(X)?.id===e(d).id);var g=_t();g.__click=()=>Ge(e(d).id);var B=t(g);{var S=I=>{var K=pt();y(()=>ce(K,"src",e(F))),i(I,K)},Y=I=>{var K=xt();i(I,K)};_(B,I=>{e(F)?I(S):I(Y,!1)})}var C=l(B,2),G=t(C),ge=t(G,!0);r(G);var Be=l(G,2),Ze=t(Be,!0);r(Be),r(C);var Ue=l(C,2);{var et=I=>{var K=gt();i(I,K)};_(Ue,I=>{e(P)&&I(et)})}r(g),y(()=>{E(g,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${e(P)?"bg-muted/50":""}`),H(ge,e(A)),H(Ze,e(z)||`${e(M)} members`)}),i(p,g)}),r(x),i(c,v)};_(n,c=>{e(me).length>0&&c(D)})}var W=l(n,2);{var Z=c=>{var v=kt(),w=l(N(v),2),R=l(t(w),2);ve(R,16,()=>U.relays,x=>x,(x,m)=>{const p=h(()=>ee(m));var d=yt();d.__click=()=>{k(L,!1),ke(`/?relay=${encodeURIComponent(m)}`)};var A=t(d);te(A,{get relayUrl(){return m},size:"md"});var F=l(A,2),z=t(F),M=t(z),P=t(M,!0);r(M),de(2),r(z);var g=l(z,2);{var B=S=>{var Y=wt(),C=t(Y,!0);r(Y),y(()=>H(C,e(p).info.description)),i(S,Y)};_(g,S=>{e(p).info?.description&&S(B)})}r(F),r(d),y(S=>H(P,S),[()=>e(p).info?.name||m.replace("wss://","").replace("ws://","")]),i(x,d)}),r(w),i(c,v)};_(W,c=>{U&&U.relays.length>0&&c(Z)})}var xe=l(W,4),Ke=l(t(xe),2);ve(Ke,16,()=>at,c=>c,(c,v)=>{const w=h(()=>ee(v));var R=Mt();R.__click=()=>Fe(v);var x=t(R);te(x,{get relayUrl(){return v},size:"md"});var m=l(x,2),p=t(m),d=t(p),A=t(d,!0);r(d),de(2),r(p);var F=l(p,2);{var z=g=>{var B=bt(),S=t(B,!0);r(B),y(()=>H(S,e(w).info.description)),i(g,B)};_(F,g=>{e(w).info?.description&&g(z)})}r(m);var M=l(m,2);{var P=g=>{var B=Rt();i(g,B)};_(M,g=>{s.selectedRelay===v&&g(P)})}r(R),y(g=>{E(R,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay===v?"bg-muted/50":""}`),H(A,g)},[()=>e(w).info?.name||v.replace("wss://","").replace("ws://","")]),i(c,R)}),r(xe);var je=l(xe,2);{var Qe=c=>{var v=Lt(),w=l(N(v),2),R=l(t(w),2);ve(R,16,()=>e(be),x=>x,(x,m)=>{const p=h(()=>ee(m));var d=zt();d.__click=()=>Fe(m);var A=t(d);te(A,{get relayUrl(){return m},size:"md"});var F=l(A,2),z=t(F),M=t(z),P=t(M,!0);r(M),r(z);var g=l(z,2);{var B=C=>{var G=Ct(),ge=t(G,!0);r(G),y(()=>H(ge,e(p).info.description)),i(C,G)};_(g,C=>{e(p).info?.description&&C(B)})}r(F);var S=l(F,2);{var Y=C=>{var G=Ft();i(C,G)};_(S,C=>{s.selectedRelay===m&&C(Y)})}r(d),y(C=>{E(d,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${s.selectedRelay===m?"bg-muted/50":""}`),H(P,C)},[()=>e(p).info?.name||m.replace("wss://","").replace("ws://","")]),i(x,d)}),r(w),i(c,v)};_(je,c=>{e(be).length>0&&c(Qe)})}var Pe=l(je,2),Xe=t(Pe);Xe.__click=()=>k(L,!1),r(Pe),i(o,b)};var T=t(pe);T.__click=$e;var Le=t(T);{var Ne=o=>{var b=he(),j=N(b);{var $=u=>{var n=Pt();y(D=>{ce(n,"src",D),E(n,1,`${V()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)},[()=>e(X).tagValue("image")]),i(u,n)},O=u=>{var n=Bt(),D=t(n);r(n),y(()=>{E(n,1,`${V()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),E(D,0,`${V()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),i(u,n)};_(j,u=>{e(X)?.tagValue("image")?u($):u(O,!1)})}i(o,b)},Te=o=>{var b=he(),j=N(b);{var $=u=>{{let n=h(()=>V()?"md":"lg");te(u,{get relayUrl(){return s.selectedRelay},get size(){return e(n)}})}},O=u=>{var n=It();y(()=>E(n,0,V()?"w-5 h-5 text-muted-foreground":"w-6 h-6")),i(u,n)};_(j,u=>{s.selectedRelay?u($):u(O,!1)},!0)}i(o,b)};_(Le,o=>{J(s.selectedRelay)?o(Ne):o(Te,!1)})}var We=l(Le,2);{var Ye=o=>{var b=Vt(),j=N(b),$=t(j,!0);r(j);var O=l(j,2);y(()=>{H($,e(Ce)),E(O,0,`w-4 h-4 transition-transform ${e(L)?"rotate-180":""}`)}),i(o,b)};_(We,o=>{!ue()&&!V()&&o(Ye)})}r(T),lt(T,o=>k(se,o),()=>e(se));var qe=l(T,2);{var Je=o=>{var b=he(),j=N(b);{var $=u=>{var n=At(),D=t(n);a(D),r(n),we(n,(W,Z)=>Ae?.(W,Z),()=>ze),i(u,n)},O=u=>{var n=St(),D=t(n);a(D),r(n),we(n,W=>nt?.(W)),we(n,(W,Z)=>Ae?.(W,Z),()=>ze),y(()=>it(n,`position: fixed; top: ${e(ie).top??""}px; left: ${e(ie).left??""}px; min-width: ${e(ie).width??""}px;`)),i(u,n)};_(j,u=>{V()?u($):u(O,!1)})}i(o,b)};_(qe,o=>{e(L)&&(ae()||V())&&o(Je)})}r(pe),y(()=>{E(T,1,V()?"flex items-center justify-center w-8 h-8 rounded-full hover:bg-muted/50 transition-colors":ue()?"flex items-center justify-center p-3 rounded-lg transition-colors w-full "+(ae()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50"):"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full "+(ae()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50")),ce(T,"aria-label",s.selectedRelay?"Change filter":"Change following filter"),ce(T,"title",ue()?e(Ce):void 0)})}i(fe,pe),rt()}st(["click"]);export{tr as R,Ut as c,er as h};
