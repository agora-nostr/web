import"./DsnmJJEf.js";import{d as ze,p as je,i as P,k as t,r,j as s,e as i,h as Ve,u as xe,s as ne,b as _e,g as e,a as K,c as le,f as ee,t as te,l as d,M as H}from"./Bq750rDx.js";import{i as c}from"./BcjopvHb.js";import{a as be}from"./uSFILAY7.js";import{p as ue}from"./BL6J_geM.js";import{n as ye,d as Ue}from"./CdRP5_sk.js";import{A as Le}from"./Bt6DpIqu.js";import{U as Te}from"./DOhHcjXC.js";import{T as Ne}from"./3NtbZaKM.js";import{E as Se}from"./D2qeXkoa.js";import{E as Ce}from"./CPZq7sH0.js";import{g as Ee}from"./BgxlgyeA.js";var Ie=P('<div class="flex items-center gap-2 sm:gap-3"><div class="flex items-center gap-2 flex-1 min-w-0"><!></div> <!> <!></div>');function Me(u,a){je(a,!0);const T=ue(a,"avatarClass",3,"w-9 h-9 sm:w-12 sm:h-12"),R=ue(a,"nameClass",3,"text-base font-semibold"),G=ue(a,"variant",3,"compact");var f=Ie(),g=t(f);g.__click=n=>n.stopPropagation();var fe=t(g);{var J=n=>{Te(n,{get pubkey(){return a.event.pubkey},variant:"avatar-name-handle",get avatarSize(){return T()},get nameSize(){return R()}})},h=n=>{Te(n,{get pubkey(){return a.event.pubkey},variant:"avatar-name-meta",get avatarSize(){return T()},get nameSize(){return R()}})};c(fe,n=>{G()==="compact"?n(J):n(h,!1)})}r(g);var se=s(g,2);{var Q=n=>{Ne(n,{get timestamp(){return a.event.created_at},class:"text-muted-foreground text-sm flex-shrink-0"})};c(se,n=>{a.event.created_at&&n(Q)})}var re=s(se,2);Se(re,{get event(){return a.event}}),r(f),i(u,f),Ve()}ze(["click"]);const ve=new Map;async function Pe(u){if(ve.has(u))return ve.get(u)??null;try{const a=`https://api.allorigins.win/get?url=${encodeURIComponent(u)}`,T=await fetch(a);if(!T.ok)return ve.set(u,null),null;const G=(await T.json()).contents,f=Re(G);return ve.set(u,f),f}catch(a){return console.error("Failed to fetch URL metadata:",a),ve.set(u,null),null}}function Re(u){const a={},T=u.match(/<meta\s+property=["']og:title["']\s+content=["']([^"']+)["']/i),R=u.match(/<meta\s+property=["']og:description["']\s+content=["']([^"']+)["']/i),G=u.match(/<meta\s+property=["']og:image["']\s+content=["']([^"']+)["']/i),f=u.match(/<meta\s+property=["']og:site_name["']\s+content=["']([^"']+)["']/i),g=u.match(/<title[^>]*>([^<]+)<\/title>/i);return a.title=T?.[1]||g?.[1],a.description=R?.[1],a.image=G?.[1],a.siteName=f?.[1],a}var Oe=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),De=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),Fe=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),qe=P('<button type="button" class="absolute bottom-3 right-3 flex items-center gap-2 px-3 py-1.5 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[200px] truncate"> </span></button>'),Ke=P('<article class="p-3 sm:p-4 hover:bg-card/30 transition-colors border-b border-border"><div class="mb-3"><!></div> <div class="relative rounded-lg overflow-hidden bg-card border border-border shadow-lg mb-2 cursor-pointer"><div class="relative flex flex-col items-center justify-center py-12 sm:py-16 px-8 sm:px-12 min-h-[200px] max-h-[600px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <!></div> <!></article>'),Ge=P("<span>·</span> <!>",1),Je=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),Qe=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),We=P('<span>·</span> <span class="flex items-center gap-1"><!> </span>',1),Xe=P('<div class="block p-4 hover:bg-card/30 transition-colors rounded-lg group cursor-pointer"><div class="relative"><div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-primary/60 to-primary rounded-full"></div> <div class="pl-4"><div class="mb-3 relative"><p class="relative text-foreground text-base leading-relaxed font-serif italic"> <mark class="bg-primary/20 text-foreground font-medium not-italic"> </mark> </p></div> <div class="flex items-center gap-2 text-xs text-muted-foreground"><span> </span> <!> <!></div></div></div></div>'),Ye=H('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),Ze=H('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),$e=H('<svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),et=P('<button type="button" class="absolute bottom-2 right-2 flex items-center gap-1.5 px-2 py-1 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[100px] truncate text-[10px]"> </span></button>'),tt=P('<article class="hover:bg-card/30 transition-colors w-full"><div class="relative aspect-square rounded-lg overflow-hidden bg-card border border-border shadow-lg w-full cursor-pointer"><div class="relative flex flex-col items-center justify-center p-4 sm:p-6 min-h-[150px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <div class="absolute bottom-2 left-2"><svg class="w-4 h-4 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M18.5 1.15a2.25 2.25 0 00-3.18 0L3.78 12.69a2.25 2.25 0 000 3.18l4.35 4.35a2.25 2.25 0 003.18 0L22.85 8.68a2.25 2.25 0 000-3.18l-4.35-4.35zM9.93 18.84L5.16 14.07 15.3 3.93l4.77 4.77-10.14 10.14z"></path><path d="M2.5 22.5h10v1.5h-10z" opacity="0.5"></path></svg></div> <!></div> <div class="flex items-center gap-2 mt-2 px-1"><!> <span class="text-xs text-muted-foreground truncate"> </span></div></article>'),rt=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>'),at=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),ot=H('<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>'),nt=P('<button type="button" class="absolute bottom-3 right-3 flex items-center gap-2 px-3 py-1.5 bg-background/80 backdrop-blur-sm border border-border rounded text-xs text-muted-foreground hover:bg-background transition-colors"><!> <span class="max-w-[200px] truncate"> </span></button>'),st=P('<article class="p-3 sm:p-4 hover:bg-card/30 transition-colors border-b border-border"><div class="mb-3"><!></div> <div class="relative rounded-lg overflow-hidden bg-card border border-border shadow-lg mb-2 cursor-pointer"><div class="relative flex flex-col items-center justify-center py-12 sm:py-16 px-8 sm:px-12 min-h-[200px] max-h-[600px]"><div class="relative z-10"><p> <mark class="bg-primary/20 text-card-foreground font-medium"> </mark> </p></div></div> <!></div> <!></article>');function _t(u,a){je(a,!0);let T=ue(a,"variant",3,"default"),R=_e(null);xe(()=>{a.event.author.fetchProfile().then(o=>{ne(R,o,!0)})});const G=K(()=>e(R)?.name||e(R)?.displayName||"Anonymous"),f=K(()=>a.event.content),g=K(()=>{const o=a.event.tags.find(w=>w[0]==="a"),l=a.event.tags.find(w=>w[0]==="e"),k=a.event.tags.find(w=>w[0]==="r");return o||l||k}),fe=K(()=>a.event.tags.find(o=>o[0]==="context")),J=K(()=>e(fe)?.[1]||e(f)),h=K(()=>{if(!e(J)||e(J)===e(f))return{before:"",highlight:e(f),after:""};const o=e(J).indexOf(e(f));return o===-1?{before:"",highlight:e(f),after:""}:{before:e(J).slice(0,o),highlight:e(f),after:e(J).slice(o+e(f).length)}}),se=K(()=>{const o=e(J).length;return T()==="grid"?o<100?"text-base":o<200?"text-sm":"text-xs":o<100?"text-2xl sm:text-3xl md:text-4xl":o<200?"text-xl sm:text-2xl md:text-3xl":o<350?"text-lg sm:text-xl md:text-2xl":o<500?"text-base sm:text-lg md:text-xl":"text-sm sm:text-base md:text-lg"});let Q=_e(void 0),re=_e(null);xe(()=>{if(!e(g)||e(g)[0]!=="a"){ne(Q,void 0);return}const l=e(g)[1].split(":");if(l.length!==3){ne(Q,void 0);return}const[k,w,U]=l;ye.guardrailOff("fetch-events-usage").fetchEvent({kinds:[parseInt(k)],authors:[w],"#d":[U]}).then(y=>{y&&ne(Q,Ue.from(y),!0)})}),xe(()=>{if(!e(g)||e(g)[0]!=="r"){ne(re,null);return}const o=e(g)[1];Pe(o).then(l=>{ne(re,l,!0)}).catch(l=>{console.error("Failed to fetch URL metadata:",l),ne(re,null)})});const n=K(()=>{if(!e(g))return null;const o=e(g)[0],l=e(g)[1];if(o==="r"){const k=e(re)?.title||e(re)?.siteName;if(k)return{type:"web",displayText:k,url:l};try{return{type:"web",displayText:new URL(l).hostname.replace("www.",""),url:l}}catch{return{type:"web",displayText:l,url:l}}}else{if(o==="a")return{type:"article",displayText:e(Q)?.tags.find(U=>U[0]==="title")?.[1]||"Article",value:l};if(o==="e")return{type:"event",displayText:"Note",value:l}}return null}),ke=K(()=>a.event.created_at);function de(){const o=a.event.encode();window.location.href=`/e/${o}`}function ge(o){if(o.stopPropagation(),e(n)?.type==="web"&&e(n).url)window.open(e(n).url,"_blank","noopener,noreferrer");else if(e(n)?.type==="article"&&e(Q)){const l=Ee(e(Q));window.location.href=l}}var we=le(),Be=ee(we);{var Ae=o=>{var l=Ke(),k=t(l),w=t(k);Me(w,{get event(){return a.event},avatarClass:"w-9 h-9 sm:w-12 sm:h-12"}),r(k);var U=s(k,2);U.__click=de;var y=t(U),L=t(y),W=t(L),ae=t(W,!0),O=s(ae),j=t(O,!0);r(O);var C=s(O,1,!0);r(W),r(L),r(y);var x=s(y,2);{var D=_=>{var b=qe();b.__click=ge;var M=t(b);{var F=v=>{var p=Oe();i(v,p)},q=v=>{var p=le(),B=ee(p);{var N=m=>{var S=De();i(m,S)},z=m=>{var S=Fe();i(m,S)};c(B,m=>{e(n).type==="article"?m(N):m(z,!1)},!0)}i(v,p)};c(M,v=>{e(n).type==="web"?v(F):v(q,!1)})}var X=s(M,2),oe=t(X,!0);r(X),r(b),te(()=>d(oe,e(n).displayText)),i(_,b)};c(x,_=>{e(n)&&_(D)})}r(U);var V=s(U,2);Ce(V,{get event(){return a.event}}),r(l),te(()=>{be(W,1,`text-card-foreground ${e(se)??""} font-serif leading-relaxed text-center`),d(ae,e(h).before),d(j,e(h).highlight),d(C,e(h).after)}),i(o,l)},He=o=>{var l=le(),k=ee(l);{var w=y=>{var L=Xe();L.__click=de;var W=t(L),ae=s(t(W),2),O=t(ae),j=t(O),C=t(j),x=s(C),D=t(x,!0);r(x);var V=s(x);r(j),r(O);var _=s(O,2),b=t(_),M=t(b,!0);r(b);var F=s(b,2);{var q=v=>{var p=Ge(),B=s(ee(p),2);TimeAgo(B,{get timestamp(){return e(ke)}}),i(v,p)};c(F,v=>{e(ke)&&v(q)})}var X=s(F,2);{var oe=v=>{var p=We(),B=s(ee(p),2),N=t(B);{var z=E=>{var Y=Je();i(E,Y)},m=E=>{var Y=Qe();i(E,Y)};c(N,E=>{e(n).type==="web"?E(z):E(m,!1)})}var S=s(N);r(B),te(()=>d(S,` ${e(n).displayText??""}`)),i(v,p)};c(X,v=>{e(n)&&v(oe)})}r(_),r(ae),r(W),r(L),te(()=>{d(C,`"${e(h).before??""}`),d(D,e(h).highlight),d(V,`${e(h).after??""}"`),d(M,e(G))}),i(y,L)},U=y=>{var L=le(),W=ee(L);{var ae=j=>{var C=tt(),x=t(C);x.__click=de;var D=t(x),V=t(D),_=t(V),b=t(_,!0),M=s(b),F=t(M,!0);r(M);var q=s(M,1,!0);r(_),r(V),r(D);var X=s(D,4);{var oe=z=>{var m=et();m.__click=ge;var S=t(m);{var E=A=>{var ie=Ye();i(A,ie)},Y=A=>{var ie=le(),me=ee(ie);{var pe=I=>{var he=Ze();i(I,he)},$=I=>{var he=$e();i(I,he)};c(me,I=>{e(n).type==="article"?I(pe):I($,!1)},!0)}i(A,ie)};c(S,A=>{e(n).type==="web"?A(E):A(Y,!1)})}var ce=s(S,2),Z=t(ce,!0);r(ce),r(m),te(()=>d(Z,e(n).displayText)),i(z,m)};c(X,z=>{e(n)&&z(oe)})}r(x);var v=s(x,2),p=t(v);Le(p,{get ndk(){return ye},get pubkey(){return a.event.pubkey},class:"w-5 h-5 rounded-full"});var B=s(p,2),N=t(B,!0);r(B),r(v),r(C),te(()=>{be(_,1,`text-card-foreground ${e(se)??""} font-serif leading-relaxed text-center line-clamp-6`),d(b,e(h).before),d(F,e(h).highlight),d(q,e(h).after),d(N,e(G))}),i(j,C)},O=j=>{var C=st(),x=t(C),D=t(x);Me(D,{get event(){return a.event},avatarClass:"w-9 h-9 sm:w-12 sm:h-12"}),r(x);var V=s(x,2);V.__click=de;var _=t(V),b=t(_),M=t(b),F=t(M,!0),q=s(F),X=t(q,!0);r(q);var oe=s(q,1,!0);r(M),r(b),r(_);var v=s(_,2);{var p=N=>{var z=nt();z.__click=ge;var m=t(z);{var S=Z=>{var A=rt();i(Z,A)},E=Z=>{var A=le(),ie=ee(A);{var me=$=>{var I=at();i($,I)},pe=$=>{var I=ot();i($,I)};c(ie,$=>{e(n).type==="article"?$(me):$(pe,!1)},!0)}i(Z,A)};c(m,Z=>{e(n).type==="web"?Z(S):Z(E,!1)})}var Y=s(m,2),ce=t(Y,!0);r(Y),r(z),te(()=>d(ce,e(n).displayText)),i(N,z)};c(v,N=>{e(n)&&N(p)})}r(V);var B=s(V,2);Ce(B,{get event(){return a.event}}),r(C),te(()=>{be(M,1,`text-card-foreground ${e(se)??""} font-serif leading-relaxed text-center`),d(F,e(h).before),d(X,e(h).highlight),d(oe,e(h).after)}),i(j,C)};c(W,j=>{T()==="grid"?j(ae):j(O,!1)},!0)}i(y,L)};c(k,y=>{T()==="compact"?y(w):y(U,!1)},!0)}i(o,l)};c(Be,o=>{T()==="feed"?o(Ae):o(He,!1)})}i(u,we),Ve()}ze(["click"]);export{_t as H};
