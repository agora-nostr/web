import"./DsnmJJEf.js";import{p as S,c as V,f as L,e as d,h as B,i as N,k as m,g as r,a as n,r as b,j as H,L as ue,t as j,l as P,M as Ne,aP as ce,b as de,K as Ce,bg as ze,N as Pe,P as I,s as X,bn as re,d as Te}from"./Bq750rDx.js";import{i as T}from"./BcjopvHb.js";import{c as fe}from"./BRAzWB6r.js";import{d as ae,a as M,b as q,c as R}from"./uSFILAY7.js";import{p,b as Ae}from"./BL6J_geM.js";import{H as Y}from"./CdRP5_sk.js";import{c as te}from"./DRdfZ70c.js";const D=Symbol("user-profile");var Fe=N('<img alt="Banner" class="user-profile-hover-card-banner-image svelte-1orw1ij"/>'),He=N('<img class="user-profile-hover-card-avatar svelte-1orw1ij"/>'),Me=N('<div class="user-profile-hover-card-avatar user-profile-hover-card-avatar-fallback svelte-1orw1ij"> </div>'),Ee=Ne('<svg class="user-profile-hover-card-verified svelte-1orw1ij" fill="currentColor" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),Le=N('<div class="user-profile-hover-card-bio svelte-1orw1ij"> </div>'),Re=N('<div><div class="user-profile-hover-card svelte-1orw1ij"><div class="user-profile-hover-card-banner svelte-1orw1ij"><!></div> <div class="user-profile-hover-card-content svelte-1orw1ij"><div class="user-profile-hover-card-avatar-wrapper svelte-1orw1ij"><!></div> <div class="user-profile-hover-card-info svelte-1orw1ij"><h3 class="user-profile-hover-card-name svelte-1orw1ij"><span class="user-profile-hover-card-name-text svelte-1orw1ij"> </span> <!></h3> <p class="user-profile-hover-card-handle svelte-1orw1ij"><!></p></div> <!> <div class="user-profile-hover-card-stats svelte-1orw1ij"><div class="user-profile-hover-card-stat svelte-1orw1ij"><span class="user-profile-hover-card-stat-value svelte-1orw1ij"> </span> <span class="user-profile-hover-card-stat-label svelte-1orw1ij">notes</span></div> <div class="user-profile-hover-card-stat svelte-1orw1ij"><span class="user-profile-hover-card-stat-value svelte-1orw1ij"> </span> <span class="user-profile-hover-card-stat-label svelte-1orw1ij">following</span></div></div></div></div></div>');function Ve(z,e){S(e,!0);let o=p(e,"class",3,"");const y=n(()=>e.ndk.getUser({pubkey:e.pubkey})),_=n(()=>r(y)&&e.isVisible?Y({ndk:e.ndk,user:()=>r(y)}):null),i=n(()=>r(_)?.profile),w=e.ndk.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[1],authors:[e.pubkey],limit:100}],bufferMs:100}:void 0),h=e.ndk.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[3],authors:[e.pubkey],limit:1}],bufferMs:100}:void 0),k=n(()=>w.events.filter(a=>!a.tags.some(f=>f[0]==="e")).length),t=n(()=>{const a=h.events[0];return a?a.tags.filter(f=>f[0]==="p").length:0}),v=n(()=>r(i)?.displayName||r(i)?.name||"Anonymous"),u=n(()=>r(i)?.picture||r(i)?.image),U=n(()=>r(i)?.about);var x=V(),g=L(x);{var l=a=>{var f=Re(),A=m(f),E=m(A),G=m(E);{var J=s=>{var c=Fe();j(()=>R(c,"src",r(i).banner)),d(s,c)};T(G,s=>{r(i)?.banner&&s(J)})}b(E);var F=H(E,2),C=m(F),K=m(C);{var Q=s=>{var c=He();j(()=>{R(c,"src",r(u)),R(c,"alt",r(v))}),d(s,c)},be=s=>{var c=Me(),O=m(c,!0);b(c),j(je=>P(O,je),[()=>r(v)[0]?.toUpperCase()||"?"]),d(s,c)};T(K,s=>{r(u)?s(Q):s(be,!1)})}b(C);var W=H(C,2),Z=m(W),$=m(Z),he=m($,!0);b($);var ke=H($,2);{var _e=s=>{var c=Ee();d(s,c)};T(ke,s=>{r(i)?.nip05&&s(_e)})}b(Z);var se=H(Z,2),ge=m(se);{var ye=s=>{var c=ce();j(()=>P(c,r(i).nip05)),d(s,c)},xe=s=>{var c=ce();j(O=>P(c,`${O??""}...`),[()=>e.pubkey.slice(0,16)]),d(s,c)};T(ge,s=>{r(i)?.nip05?s(ye):s(xe,!1)})}b(se),b(W);var ie=H(W,2);{var pe=s=>{var c=Le(),O=m(c,!0);b(c),j(()=>P(O,r(U))),d(s,c)};T(ie,s=>{r(U)&&s(pe)})}var ne=H(ie,2),ee=m(ne),le=m(ee),we=m(le,!0);b(le),ue(2),b(ee);var oe=H(ee,2),ve=m(oe),Ue=m(ve,!0);b(ve),ue(2),b(oe),b(ne),b(F),b(A),b(f),j(s=>{M(f,1,s,"svelte-1orw1ij"),q(f,`left: ${e.position.x??""}px; top: ${e.position.y??""}px;`),P(he,r(v)),P(we,r(k)),P(Ue,r(t))},[()=>ae(te("user-profile-hover-card-container",o()))]),d(a,f)};T(g,a=>{e.isVisible&&a(l)})}d(z,x),B()}var Se=N("<div><!></div>"),Be=N("<div><!></div> <!>",1);function Ke(z,e){S(e,!0);let o=p(e,"showHoverCard",3,!1),y=p(e,"class",3,"");const _=n(()=>e.user||(e.pubkey?e.ndk.getUser({pubkey:e.pubkey}):null)),i=n(()=>e.pubkey||r(_)?.pubkey||""),w=n(()=>r(_)?Y({ndk:e.ndk,user:()=>r(_)}):null);let h=de(!1),k=de(Ce({x:0,y:0})),t=null,v=null;function u(F){!o()||!r(i)||(t&&clearTimeout(t),t=setTimeout(()=>{if(v){const C=v.getBoundingClientRect(),K=C.left,Q=C.top;X(k,{x:K,y:Q},!0),X(h,!0)}},500))}function U(){o()&&(t&&clearTimeout(t),t=setTimeout(()=>{X(h,!1)},100))}function x(){t&&clearTimeout(t)}function g(){X(h,!1)}ze(D,{get ndk(){return e.ndk},get user(){return e.user},get pubkey(){return e.pubkey},get ndkUser(){return r(_)},get profileFetcher(){return r(w)},get showHoverCard(){return o()},get onclick(){return e.onclick}});var a=Be(),f=L(a);let A;var E=m(f);Pe(E,()=>e.children),b(f),Ae(f,F=>v=F,()=>v);var G=H(f,2);{var J=F=>{var C=Se(),K=m(C);Ve(K,{get ndk(){return e.ndk},get pubkey(){return r(i)},get isVisible(){return r(h)},get position(){return r(k)}}),b(C),I("mouseenter",C,x),I("mouseleave",C,g),d(F,C)};T(G,F=>{o()&&r(i)&&F(J)})}j(()=>A=M(f,1,`user-profile-root ${y()??""}`,"svelte-1pffaxq",A,{"has-hover-card":o()})),I("mouseenter",f,u),I("mouseleave",f,U),d(z,a),B()}var Oe=N("<img/>"),qe=N("<div> </div>");function Ie(z,e){S(e,!0);let o=p(e,"size",3,48),y=p(e,"class",3,"");const _=re(D),i=n(()=>e.ndk||_?.ndk),w=n(()=>e.user||_?.ndkUser||(r(i)&&e.pubkey?r(i).getUser({pubkey:e.pubkey}):null)),h=n(()=>e.profile!==void 0?null:r(w)&&r(i)?Y({ndk:r(i),user:()=>r(w)}):null),k=n(()=>e.profile!==void 0?e.profile:r(h)?.profile),t=n(()=>r(k)?.picture||e.fallback),v=n(()=>e.alt||r(k)?.displayName||r(k)?.name||"Anon");var u=V(),U=L(u);{var x=l=>{var a=Oe();j(()=>{R(a,"src",r(t)),R(a,"alt",r(v)),M(a,1,`user-profile-avatar ${y()??""}`,"svelte-19cfaft"),q(a,`width: ${o()??""}px; height: ${o()??""}px;`)}),d(l,a)},g=l=>{var a=qe(),f=m(a,!0);b(a),j(A=>{M(a,1,`user-profile-avatar user-profile-avatar-fallback ${y()??""}`,"svelte-19cfaft"),q(a,`width: ${o()??""}px; height: ${o()??""}px;`),P(f,A)},[()=>r(v).slice(0,2).toUpperCase()]),d(l,a)};T(U,l=>{r(t)?l(x):l(g,!1)})}d(z,u),B()}Te(["click"]);var Xe=N("<span> </span>");function Ye(z,e){S(e,!0);let o=p(e,"field",3,"displayName"),y=p(e,"size",3,"text-base"),_=p(e,"class",3,""),i=p(e,"truncate",3,!0);const w=re(D),h=n(()=>e.ndk||w?.ndk),k=n(()=>e.user||w?.ndkUser||(r(h)&&e.pubkey?r(h).getUser({pubkey:e.pubkey}):null)),t=n(()=>e.pubkey||w?.pubkey||r(k)?.pubkey),v=n(()=>e.profile!==void 0?null:r(k)&&r(h)?Y({ndk:r(h),user:()=>r(k)}):null),u=n(()=>e.profile!==void 0?e.profile:r(v)?.profile),U=n(()=>{if(!r(u))return r(t)?.slice(0,8)+"..."||"Unknown";if(o()==="name")return r(u).name||r(t)?.slice(0,8)+"...";if(o()==="displayName")return r(u).displayName||r(u).name||r(t)?.slice(0,8)+"...";if(o()==="both"){const l=r(u).displayName||r(u).name,a=r(u).name&&r(u).name!==r(u).displayName?r(u).name:null;return a?`${l} (@${a})`:l||r(t)?.slice(0,8)+"..."}return r(t)?.slice(0,8)+"..."||"Unknown"});var x=Xe(),g=m(x,!0);b(x),j(l=>{M(x,1,l,"svelte-6sy8x7"),P(g,r(U))},[()=>ae(te("user-profile-name",y(),i()&&"user-profile-name-truncate",_()))]),d(z,x),B()}var De=N("<span> </span>");function Ge(z,e){S(e,!0);let o=p(e,"size",3,"text-sm"),y=p(e,"class",3,""),_=p(e,"showAt",3,!0),i=p(e,"truncate",3,!0);const{pubkey:w,profileFetcher:h}=re(D),k=n(()=>h?.profile?.name||w?.slice(0,8)||"unknown"),t=n(()=>_()?`@${r(k)}`:r(k));var v=De(),u=m(v,!0);b(v),j(U=>{M(v,1,U,"svelte-y2ub40"),P(u,r(t))},[()=>ae(te("user-profile-handle",o(),i()&&"user-profile-handle-truncate",y()))]),d(z,v),B()}const me={Root:Ke,Avatar:Ie,Name:Ye,Handle:Ge};var Je=N("<img/>"),Qe=N("<div>?</div>");function ir(z,e){S(e,!0);let o=p(e,"size",3,48),y=p(e,"class",3,"");const _=n(()=>e.pubkey||e.user?.pubkey);var i=V(),w=L(i);{var h=t=>{var v=V(),u=L(v);fe(u,()=>me.Root,(U,x)=>{x(U,{get ndk(){return e.ndk},get pubkey(){return r(_)},children:(g,l)=>{var a=V(),f=L(a);fe(f,()=>me.Avatar,(A,E)=>{E(A,{get size(){return o()},get class(){return y()}})}),d(g,a)},$$slots:{default:!0}})}),d(t,v)},k=t=>{var v=V(),u=L(v);{var U=g=>{var l=Je();j(()=>{R(l,"src",e.fallback),R(l,"alt",e.alt||"Avatar"),M(l,1,`avatar ${y()??""}`,"svelte-1robf2b"),q(l,`width: ${o()??""}px; height: ${o()??""}px; border-radius: 50%; object-fit: cover;`)}),d(g,l)},x=g=>{var l=Qe();j(()=>{M(l,1,`avatar avatar-fallback ${y()??""}`,"svelte-1robf2b"),q(l,`width: ${o()??""}px; height: ${o()??""}px;`)}),d(g,l)};T(u,g=>{e.fallback?g(U):g(x,!1)},!0)}d(t,v)};T(w,t=>{e.ndk&&r(_)?t(h):t(k,!1)})}d(z,i),B()}export{ir as A,me as U};
