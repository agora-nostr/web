import{i as Q,a as r,d as nt,c as j,f as T,s as E}from"./rzUyzf2y.js";import{g as K,a as W,t as B,p as lt,B as it,f as w,c as ct,e as b,r as k,d as I}from"./AsQG98fS.js";import{i as C}from"./DZKExFZC.js";import{c as Z}from"./Dt3q2Svx.js";import{c as F,a as X,e as Y}from"./CS0aOiUg.js";import{p as M}from"./w-gpJwMz.js";import{q as G}from"./tv6-RHC_.js";import{r as ft}from"./CnuptT3n.js";import{c as dt,U as J}from"./C-S0GgRw.js";function gt(x,t){const e=ft(t);e.$sessions&&e.$sessions.addMonitor([G]);const h=W(()=>{const{target:o}=x();if(!o)return!1;if(typeof o=="string"){const s=e.$sessionEvent(G,{create:!0});return s?s.hasInterest(o.toLowerCase()):!1}try{const s=o.pubkey;return e.$follows.has(s)}catch{return!1}});async function f(){const{target:o}=x();if(!o)return;if(typeof o=="string"){const a=e.$sessionEvent(G,{create:!0});if(!a)return;const n=o.toLowerCase();K(h)?a.removeInterest(n):a.addInterest(n),await a.publishReplaceable();return}let s;try{s=o.pubkey}catch{throw new Error("User not loaded yet")}K(h)?await e.$follows.remove(s):await e.$follows.add(s)}return{get isFollowing(){return K(h)},follow:f}}var ut=Q('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" color="currentColor" fill="none"><path d="M13.5 16.0001V14.0623C15.2808 12.6685 16.5 11 16.5 7.41681C16.5 5.09719 16.0769 3 13.5385 3C13.5385 3 12.6433 2 10.4923 2C7.45474 2 5.5 3.82696 5.5 7.41681C5.5 11 6.71916 12.6686 8.5 14.0623V16.0001L4.78401 17.1179C3.39659 17.5424 2.36593 18.6554 2.02375 20.0101C1.88845 20.5457 2.35107 21.0001 2.90639 21.0001H13.0936" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M18.5 22L18.5 15M15 18.5H22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function vt(x,t){let e=M(t,"size",3,24),h=M(t,"class",3,"");var f=ut();B(()=>{F(f,"width",e()),F(f,"height",e()),X(f,0,Y(h()))}),r(x,f)}var wt=T('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M10 3L8 21M16 3L14 21M3 8H21M2 16H20"></path></svg> <span class="text-sm inline-flex items-baseline gap-1"><span class="font-bold"> </span> <span class="font-normal"> </span></span>',1),ht=T('<!> <span class="text-sm inline-flex items-baseline gap-1"><span class="font-bold"> </span> <!></span>',1),pt=Q('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M10 3L8 21M16 3L14 21M3 8H21M2 16H20"></path></svg>'),mt=Q('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" class="flex-shrink-0"><path d="M12 15C15.866 15 19 11.866 19 8C19 4.13401 15.866 1 12 1C8.13401 1 5 4.13401 5 8C5 11.866 8.13401 15 12 15Z"></path><path d="M2 23C2 18.5817 6.47715 15 12 15C17.5228 15 22 18.5817 22 23" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 9L10.5 11.5L16 6" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),_t=T('<!> <span class="text-sm font-medium"> </span>',1),bt=T('<button data-follow-button="" type="button"><!></button>');function Nt(x,t){lt(t,!0);let e=M(t,"variant",3,"ghost"),h=M(t,"showIcon",3,!0),f=M(t,"showTarget",3,!1),o=M(t,"class",3,"");const s=it("ndk"),a=t.ndk||s,n=typeof t.target=="string",$=W(()=>{if(n||!a?.$currentPubkey)return!1;try{return a.$currentPubkey===t.target.pubkey}catch{return!1}}),d=gt(()=>({target:t.target}),a);async function tt(){if(a?.$currentPubkey)try{await d.follow()}catch(L){console.error("Failed to toggle follow:",L)}}var S=j(),et=w(S);{var rt=L=>{var l=bt();l.__click=tt;var ot=b(l);{var at=g=>{var U=j(),P=w(U);{var R=u=>{var i=wt(),p=I(w(i),2),m=b(p),H=b(m,!0);k(m);var y=I(m,2),c=b(y);k(y),k(p),B(()=>{E(H,d.isFollowing?"Unfollow":"Follow"),E(c,`#${t.target??""}`)}),r(u,i)},z=u=>{var i=j(),p=w(i);Z(p,()=>J.Root,(m,H)=>{H(m,{get ndk(){return a},get user(){return t.target},class:"flex items-center gap-2",children:(y,c)=>{var _=ht(),A=w(_);Z(A,()=>J.Avatar,(q,O)=>{O(q,{class:"w-5 h-5"})});var D=I(A,2),N=b(D),v=b(N,!0);k(N);var V=I(N,2);Z(V,()=>J.Name,(q,O)=>{O(q,{field:"displayName",class:"font-normal text-sm"})}),k(D),B(()=>E(v,d.isFollowing?"Unfollow":"Follow")),r(y,_)},$$slots:{default:!0}})}),r(u,i)};C(P,u=>{n?u(R):u(z,!1)})}r(g,U)},st=g=>{var U=_t(),P=w(U);{var R=i=>{var p=j(),m=w(p);{var H=c=>{var _=pt();r(c,_)},y=c=>{var _=j(),A=w(_);{var D=v=>{var V=mt();r(v,V)},N=v=>{vt(v,{size:16,class:"flex-shrink-0"})};C(A,v=>{d.isFollowing?v(D):v(N,!1)},!0)}r(c,_)};C(m,c=>{n?c(H):c(y,!1)})}r(i,p)};C(P,i=>{h()&&i(R)})}var z=I(P,2),u=b(z,!0);k(z),B(()=>E(u,d.isFollowing?"Unfollow":"Follow")),r(g,U)};C(ot,g=>{f()?g(at):g(st,!1)})}k(l),B(g=>{F(l,"data-following",d.isFollowing?"":void 0),F(l,"data-target-type",n?"hashtag":"user"),F(l,"data-variant",e()),X(l,1,g),F(l,"aria-label",d.isFollowing?n?`Unfollow #${t.target}`:"Unfollow user":n?`Follow #${t.target}`:"Follow user")},[()=>Y(dt("inline-flex items-center gap-2 cursor-pointer transition-all",e()==="ghost"&&"p-2 bg-transparent border-none hover:bg-accent",e()==="outline"&&"px-3 py-2 bg-transparent border border-border rounded-md hover:bg-accent",e()==="pill"&&"px-4 py-2 bg-transparent border border-border rounded-full hover:bg-accent",e()==="solid"&&"px-4 py-2 bg-muted border border-border rounded-md hover:bg-accent",d.isFollowing?"text-muted-foreground hover:text-foreground":"text-primary",o()))]),r(L,l)};C(et,L=>{!K($)&&a?.$currentUser&&L(rt)})}r(x,S),ct()}nt(["click"]);export{Nt as F};
