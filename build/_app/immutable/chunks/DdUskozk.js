import{c as R,a as i,f as F,s as N,i as Le,t as Ae,d as Ne,j as A}from"./rzUyzf2y.js";import{p as Re,u as He,s as M,b as ue,f as g,c as Ie,e as r,g as n,r as a,d as c,y as Pe,a as pe,t as j,x as Ve}from"./AsQG98fS.js";import{i as w}from"./DZKExFZC.js";import{s as We}from"./DNVUPZsi.js";import{c as H}from"./Dt3q2Svx.js";import{b as Me,c as je,a as L}from"./CS0aOiUg.js";import{b as be}from"./CkKAtl6l.js";import{p as ae}from"./w-gpJwMz.js";import{n as C}from"./tv6-RHC_.js";import{U as I}from"./C-S0GgRw.js";import{E as Fe}from"./cqXEgdME.js";import{F as Ge}from"./Cp2_visM.js";function Oe(z){if(!z||z.length<8)return"linear-gradient(135deg, hsl(220, 70%, 50%), hsl(280, 70%, 50%))";const e=z.slice(0,4),l=z.slice(4,8),G=parseInt(e,16)%360,Q=parseInt(l,16)%360,de=60+parseInt(z.slice(8,10)||"00",16)%20,ce=60+parseInt(z.slice(10,12)||"00",16)%20,fe=45+parseInt(z.slice(12,14)||"00",16)%10,V=45+parseInt(z.slice(14,16)||"00",16)%10;return`linear-gradient(135deg, hsl(${G}, ${de}%, ${fe}%), hsl(${Q}, ${ce}%, ${V}%))`}var qe=F('<img alt="Banner" class="w-full h-full object-cover opacity-80"/> <div class="absolute inset-0 bg-gradient-to-b from-transparent to-neutral-900"></div>',1),De=Le('<svg class="w-3.5 h-3.5 text-blue-500 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),Je=F('<div class="mb-4"><div class="text-sm text-muted-foreground line-clamp-3 leading-relaxed svelte-5mo7x1"><!></div></div>'),Ke=F('<div class="fixed z-50 pointer-events-none animate-in fade-in duration-200 svelte-5mo7x1"><div class="relative pointer-events-auto"><div class="relative w-80 bg-card border border-border rounded-xl shadow-2xl overflow-hidden"><div class="relative h-20"><!></div> <div class="relative px-5 pb-5 -mt-10"><div class="relative inline-block mb-3"><!></div> <div class="mb-3"><h3 class="text-base font-semibold text-foreground flex items-center gap-1.5 mb-0.5"><span class="truncate"> </span> <!></h3> <p class="text-sm text-muted-foreground truncate"><!></p></div> <!> <div class="flex items-center gap-4 mb-4 text-sm border-t border-border pt-3"><div class="flex items-center gap-1.5"><span class="font-medium text-foreground"> </span> <span class="text-muted-foreground">notes</span></div> <div class="flex items-center gap-1.5"><span class="font-medium text-foreground"> </span> <span class="text-muted-foreground">following</span></div></div> <!></div></div></div></div>');function Qe(z,e){Re(e,!0);let l=ue(null);He(()=>{C.fetchUser(e.pubkey).then(f=>{f?.fetchProfile().then(h=>{M(l,h,!0)})})});const G=pe(()=>C.$currentUser?.pubkey===e.pubkey),Q=C.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[1],authors:[e.pubkey],limit:100}],bufferMs:100}:void 0),de=C.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[3],authors:[e.pubkey],limit:1}],bufferMs:100}:void 0),ce=pe(()=>Q.events.filter(f=>!f.tags.some(h=>h[0]==="e")).length),fe=pe(()=>{const f=de.events[0];return f?f.tags.filter(h=>h[0]==="p").length:0});var V=R(),ge=g(V);{var X=f=>{var h=Ke(),x=r(h),m=r(x),T=r(m),ee=r(T);{var te=t=>{var o=qe(),s=g(o);Pe(2),j(()=>je(s,"src",n(l).banner)),i(t,o)};w(ee,t=>{n(l)?.banner&&t(te)})}a(T);var he=c(T,2),me=r(he),ne=r(me);H(ne,()=>I.Root,(t,o)=>{o(t,{get ndk(){return C},get pubkey(){return e.pubkey},children:(s,E)=>{var B=R(),S=g(B);H(S,()=>I.Avatar,(k,D)=>{D(k,{class:"w-20 h-20 rounded-full border-4 border-foreground shadow-xl"})}),i(s,B)},$$slots:{default:!0}})}),a(me);var _e=c(me,2),oe=r(_e),se=r(oe),ye=r(se,!0);a(se);var we=c(se,2);{var ie=t=>{var o=De();i(t,o)};w(we,t=>{n(l)?.nip05&&t(ie)})}a(oe);var xe=c(oe,2),v=r(xe);{var u=t=>{var o=Ae();j(()=>N(o,n(l).nip05)),i(t,o)},Y=t=>{var o=Ae();j(s=>N(o,`${s??""}...`),[()=>e.pubkey.slice(0,16)]),i(t,o)};w(v,t=>{n(l)?.nip05?t(u):t(Y,!1)})}a(xe),a(_e);var P=c(_e,2);{var O=t=>{var o=Je(),s=r(o),E=r(s);Fe(E,{get ndk(){return C},get content(){return n(l).about},class:"text-muted-foreground"}),a(s),a(o),i(t,o)};w(P,t=>{n(l)?.about&&t(O)})}var p=c(P,2),d=r(p),W=r(d),q=r(W,!0);a(W),Pe(2),a(d);var Z=c(d,2),_=r(Z),b=r(_,!0);a(_),Pe(2),a(Z),a(p);var $=c(p,2);{var re=t=>{Ge(t,{get ndk(){return C},get target(){return e.pubkey}})};w($,t=>{n(G)||t(re)})}a(he),a(m),a(x),a(h),j(t=>{Me(h,`left: ${e.position.x??""}px; top: ${e.position.y??""}px;`),Me(T,t),N(ye,n(l)?.displayName||n(l)?.name||"Anonymous"),N(q,n(ce)),N(b,n(fe))},[()=>`background: ${n(l)?.banner?"transparent":Oe(e.pubkey)}`]),i(f,h)};w(ge,f=>{e.isVisible&&f(X)})}i(z,V),Ie()}var Xe=F('<button type="button"><!></button>'),Ye=F('<button type="button"><!> <p> </p></button>'),Ze=F('<button type="button"><!> <div class="flex-1 min-w-0 flex flex-col"><p> </p> <p> </p></div></button>'),$e=F("<p> </p>"),et=F('<button type="button"><!> <div class="flex-1 min-w-0"><p> </p> <!></div></button>'),tt=F('<div><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 min-w-0"><button type="button" class="text-left w-full min-w-0"><p> </p></button> <!></div></div>'),rt=F("<!> <div><!></div>",1);function bt(z,e){Re(e,!0);const l=ae(e,"variant",3,"avatar"),G=ae(e,"avatarSize",3,"w-10 h-10"),Q=ae(e,"nameSize",3,"text-base font-semibold"),de=ae(e,"handleSize",3,"text-sm text-muted-foreground"),ce=ae(e,"bioSize",3,"text-sm text-muted-foreground"),fe=ae(e,"showHoverCard",3,!0),V=ae(e,"class",3,"");let ge=ue(void 0),X=ue(null);He(()=>{C.fetchUser(e.pubkey).then(v=>{M(ge,v,!0),v?.fetchProfile().then(u=>{M(X,u,!0)})})});let f=ue(!1),h=ue(Ve({x:0,y:0})),x=null,m=ue(null);function T(v){e.onclick?e.onclick(v):window.location.href=`/p/${n(ge)?.npub}`}function ee(){fe()&&(x&&clearTimeout(x),x=setTimeout(()=>{if(n(m)){const v=n(m).getBoundingClientRect(),u=window.innerWidth,Y=320,P=16;let O=v.right+P;O+Y>u-P&&(O=v.left-Y-P);const p=v.top;M(h,{x:O,y:p},!0),M(f,!0)}},500))}function te(){x&&(clearTimeout(x),x=null),x=setTimeout(()=>{M(f,!1)},100)}function he(){x&&(clearTimeout(x),x=null)}function me(){M(f,!1)}const ne=pe(()=>n(X)?.displayName||n(X)?.name||`${e.pubkey?.slice(0,8)}...`),_e=pe(()=>n(X)?.name||e.pubkey?.slice(0,8));var oe=rt(),se=g(oe);{var ye=v=>{var u=Xe();u.__click=T;var Y=r(u);H(Y,()=>I.Root,(P,O)=>{O(P,{get ndk(){return C},get pubkey(){return e.pubkey},children:(p,d)=>{var W=R(),q=g(W);H(q,()=>I.Avatar,(Z,_)=>{_(Z,{get class(){return`${G()??""} cursor-pointer hover:opacity-80 transition-opacity`}})}),i(p,W)},$$slots:{default:!0}})}),a(u),be(u,P=>M(m,P),()=>n(m)),j(()=>L(u,1,`flex-shrink-0 ${V()??""}`,"svelte-8apr3t")),A("mouseenter",u,ee),A("mouseleave",u,te),i(v,u)},we=v=>{var u=R(),Y=g(u);{var P=p=>{var d=Ye();d.__click=T;var W=r(d);H(W,()=>I.Root,(_,b)=>{b(_,{get ndk(){return C},get pubkey(){return e.pubkey},children:($,re)=>{var t=R(),o=g(t);H(o,()=>I.Avatar,(s,E)=>{E(s,{get class(){return`${G()??""} hover:opacity-80 transition-opacity`}})}),i($,t)},$$slots:{default:!0}})});var q=c(W,2),Z=r(q,!0);a(q),a(d),be(d,_=>M(m,_),()=>n(m)),j(()=>{L(d,1,`flex items-center gap-3 cursor-pointer ${V()??""}`,"svelte-8apr3t"),L(q,1,`${Q()??""} text-foreground truncate hover:underline flex-1 min-w-0 text-left`,"svelte-8apr3t"),N(Z,n(ne))}),A("mouseenter",d,ee),A("mouseleave",d,te),i(p,d)},O=p=>{var d=R(),W=g(d);{var q=_=>{var b=Ze();b.__click=T;var $=r(b);H($,()=>I.Root,(B,S)=>{S(B,{get ndk(){return C},get pubkey(){return e.pubkey},children:(k,D)=>{var le=R(),U=g(le);H(U,()=>I.Avatar,(y,J)=>{J(y,{get class(){return`${G()??""} hover:opacity-80 transition-opacity flex-shrink-0`}})}),i(k,le)},$$slots:{default:!0}})});var re=c($,2),t=r(re),o=r(t,!0);a(t);var s=c(t,2),E=r(s);a(s),a(re),a(b),be(b,B=>M(m,B),()=>n(m)),j(()=>{L(b,1,`flex items-center gap-3 cursor-pointer text-left w-full ${V()??""}`,"svelte-8apr3t"),L(t,1,`${Q()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),N(o,n(ne)),L(s,1,`${de()??""} truncate`,"svelte-8apr3t"),N(E,`@${n(_e)??""}`)}),A("mouseenter",b,ee),A("mouseleave",b,te),i(_,b)},Z=_=>{var b=R(),$=g(b);{var re=o=>{var s=et();s.__click=T;var E=r(s);H(E,()=>I.Root,(U,y)=>{y(U,{get ndk(){return C},get pubkey(){return e.pubkey},children:(J,Se)=>{var ke=R(),Ce=g(ke);H(Ce,()=>I.Avatar,(K,ve)=>{ve(K,{get class(){return`${G()??""} hover:opacity-80 transition-opacity flex-shrink-0`}})}),i(J,ke)},$$slots:{default:!0}})});var B=c(E,2),S=r(B),k=r(S,!0);a(S);var D=c(S,2);{var le=U=>{var y=$e(),J=r(y,!0);a(y),j(()=>{L(y,1,`${ce()??""} truncate line-clamp-2`,"svelte-8apr3t"),N(J,n(X).about)}),i(U,y)};w(D,U=>{n(X)?.about&&U(le)})}a(B),a(s),be(s,U=>M(m,U),()=>n(m)),j(()=>{L(s,1,`flex items-center gap-3 cursor-pointer text-left w-full ${V()??""}`,"svelte-8apr3t"),L(S,1,`${Q()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),N(k,n(ne))}),A("mouseenter",s,ee),A("mouseleave",s,te),i(o,s)},t=o=>{var s=R(),E=g(s);{var B=S=>{var k=tt(),D=r(k);D.__click=T;var le=r(D);H(le,()=>I.Root,(K,ve)=>{ve(K,{get ndk(){return C},get pubkey(){return e.pubkey},children:(ze,at)=>{var Ue=R(),Te=g(Ue);H(Te,()=>I.Avatar,(Ee,Be)=>{Be(Ee,{get class(){return`${G()??""} cursor-pointer hover:opacity-80 transition-opacity`}})}),i(ze,Ue)},$$slots:{default:!0}})}),a(D);var U=c(D,2),y=r(U);y.__click=T;var J=r(y),Se=r(J,!0);a(J),a(y);var ke=c(y,2);{var Ce=K=>{var ve=R(),ze=g(ve);We(ze,()=>e.meta),i(K,ve)};w(ke,K=>{e.meta&&K(Ce)})}a(U),a(k),be(k,K=>M(m,K),()=>n(m)),j(()=>{L(k,1,`flex items-center gap-3 ${V()??""}`,"svelte-8apr3t"),L(J,1,`${Q()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),N(Se,n(ne))}),A("mouseenter",k,ee),A("mouseleave",k,te),i(S,k)};w(E,S=>{l()==="avatar-name-meta"&&S(B)},!0)}i(o,s)};w($,o=>{l()==="avatar-name-bio"?o(re):o(t,!1)},!0)}i(_,b)};w(W,_=>{l()==="avatar-name-handle"?_(q):_(Z,!1)},!0)}i(p,d)};w(Y,p=>{l()==="avatar-name"?p(P):p(O,!1)},!0)}i(v,u)};w(se,v=>{l()==="avatar"?v(ye):v(we,!1)})}var ie=c(se,2),xe=r(ie);Qe(xe,{get pubkey(){return e.pubkey},get isVisible(){return n(f)},get position(){return n(h)}}),a(ie),A("mouseenter",ie,he),A("mouseleave",ie,me),i(z,oe),Ie()}Ne(["click"]);export{bt as U,Oe as g};
