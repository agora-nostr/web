import{c as ve,a as o,f as k,d as Le,s as re,i as Ke,j as qe,t as Ae}from"./rzUyzf2y.js";import{u as Fe,s as u,b as ue,g as e,a as K,B as et,p as ze,aO as Ut,f as B,c as Te,e as a,r,az as It,d as l,t as W,y as Ce,x as Oe,aJ as vt,z as Lt,aY as Dt}from"./AsQG98fS.js";import{i as A}from"./DZKExFZC.js";import{c as pe}from"./Dt3q2Svx.js";import{d as ft,e as $e,c as Be,a as Re,r as Bt,b as Pt}from"./CS0aOiUg.js";import{p as se,r as Ft}from"./w-gpJwMz.js";import{t as Kt,N as Ct,D as Zt,n as ge,b as Wt,s as rt,f as pt,h as Qt,S as Ht,T as qt}from"./tv6-RHC_.js";import{s as ot}from"./DNVUPZsi.js";import{c as Ye,U as je}from"./C-S0GgRw.js";import{ab as Ot,M as Rt,D as Et,a as Mt,R as St,b as At,d as zt,e as Tt}from"./CVV5LOp_.js";import{b as at}from"./CkKAtl6l.js";import{C as Vt,E as Yt}from"./cqXEgdME.js";import{e as Xe,i as nt}from"./Cztbr3Ea.js";import{a as Ge}from"./CO-nanZk.js";import{S as st}from"./D2z4-Wxa.js";import{t as Ee}from"./D7cSTCXZ.js";import{c as lt}from"./a7XEC-kH.js";import{u as gt}from"./DHRuQT7d.js";import{p as it}from"./DkZQAMY8.js";import{B as De,I as mt}from"./DMKx7da8.js";import{b as jt}from"./DF8Bk5Sh.js";import{N as Xt,c as Jt}from"./BpHW1rOk.js";import{R as ht}from"./DnC2iOoX.js";import{I as We}from"./DjOI8lew.js";import{D as Gt,a as $t}from"./BlLlwFDc.js";import{D as er}from"./D1QSAoU9.js";import{L as bt}from"./Cqd1tifG.js";import{D as tr}from"./Dw5jWGaA.js";import{r as rr}from"./CnuptT3n.js";function or(Y,t){const d=Kt(t);let p=ue(null);const f=new st;Fe(()=>{const{event:m}=Y();if(!m?.id){u(p,null);return}u(p,d.$subscribe(()=>({filters:[{kinds:[Ct.Reaction],...m.filter()}],subId:"reactions"})),!0)});const s=K(()=>{const h=e(p)?.events||[],g=new st;for(const b of h){const i=b.content,n=g.get(i)||{count:0,hasReacted:!1,pubkeys:[]};n.count++;const v=b.tags.find(x=>x[0]==="emoji");v&&v[1]&&v[2]&&(n.shortcode=v[1],n.url=v[2]),n.pubkeys.includes(b.pubkey)||n.pubkeys.push(b.pubkey),b.pubkey===d.$currentPubkey&&(n.hasReacted=!0,n.userReaction=b),g.set(i,n)}for(const[b,{event:i}]of f.entries()){const n=g.get(b)||{count:0,hasReacted:!1,pubkeys:[]},v=i.tags.find(x=>x[0]==="emoji");v&&v[1]&&v[2]&&(n.shortcode=v[1],n.url=v[2]),n.hasReacted||(n.count++,n.hasReacted=!0,n.pubkeys.includes(d.$currentPubkey)||n.pubkeys.push(d.$currentPubkey),n.userReaction=i),g.set(b,n)}return Array.from(g.entries()).map(([b,i])=>({emoji:b,...i})).sort((b,i)=>i.count-b.count)});async function y(m){const{event:h,delayed:g}=Y();if(!h?.id)throw new Error("No event to react to");if(!d.$currentPubkey)throw new Error("User must be logged in to react");const b=typeof m=="string"?m:m.emoji,i=f.get(b);if(i){clearTimeout(i.timer),f.delete(b);return}const n=e(s).find(x=>x.emoji===b);if(n?.hasReacted&&n.userReaction){await n.userReaction.delete();return}const v=await h.react(b,!1);if(typeof m!="string"&&m.shortcode&&m.url&&v.tags.push(["emoji",m.shortcode,m.url]),g&&g>0){const x=setTimeout(async()=>{await v.publish(),f.delete(b)},g*1e3);f.set(b,{timer:x,event:v})}else await v.publish()}function w(m){return e(s).find(h=>h.emoji===m)}return{get all(){return e(s)},get:w,react:y}}const dt=Symbol.for("event-card"),ar="ndk";function nr(Y){if(Y)return Y;const t=et(ar);if(!t)throw new Error("NDK not found. Either provide an `ndk` prop or ensure NDK is set in context via setContext('ndk', ndk) in a parent component.");return t}var sr=k("<button><!></button>"),lr=k("<article><!></article>");function ir(Y,t){ze(t,!0);let d=se(t,"class",3,""),p=Ft(t,["$$slots","$$events","$$legacy","ndk","event","onclick","class","children"]);const f=nr(t.ndk);Ut(dt,{get ndk(){return f},get event(){return t.event},get interactive(){return!!t.onclick}});const y=K(()=>!!t.onclick);var w=ve(),m=B(w);{var h=b=>{var i=sr();ft(i,x=>({"data-event-card-root":"","data-interactive":"",class:x,onclick:t.onclick,type:"button",...p}),[()=>Ye("relative flex flex-col gap-2 cursor-pointer w-full text-left bg-transparent border-none p-0",d())]);var n=a(i);{var v=x=>{var T=ve(),R=B(T);ot(R,()=>t.children),o(x,T)};A(n,x=>{t.children&&x(v)})}r(i),o(b,i)},g=b=>{var i=lr();ft(i,x=>({"data-event-card-root":"",class:x,...p}),[()=>Ye("relative flex flex-col gap-2",d())]);var n=a(i);{var v=x=>{var T=ve(),R=B(T);ot(R,()=>t.children),o(x,T)};A(n,x=>{t.children&&x(v)})}r(i),o(b,i)};A(m,b=>{e(y)?b(h):b(g,!1)})}o(Y,w),Te()}function dr(Y){let t=ue(0);const d=K(()=>{if(e(t),!Y)return"";const p=new Date(Y*1e3),s=new Date().getTime()-p.getTime(),y=Math.floor(s/(1e3*60*60));if(y<1){const w=Math.floor(s/6e4);return w<1?"now":`${w}m`}else return y<24?`${y}h`:y<168?`${Math.floor(y/24)}d`:p.toLocaleDateString()});return Fe(()=>{const p=setInterval(()=>{It(t)},6e4);return()=>clearInterval(p)}),e(d)}var cr=k('<div class="flex flex-col"><!> <!></div>'),ur=k('<div class="flex items-center gap-2 min-w-0"><!></div>'),vr=k('<div class="flex items-center gap-3 flex-1 min-w-0" role="presentation"><!> <div class="flex-1 min-w-0"><!></div></div>'),fr=k('<time class="text-sm text-muted-foreground/70"> </time>'),pr=k('<header data-event-card-header=""><!> <div class="flex items-center gap-3"><!> <!></div></header>');function gr(Y,t){ze(t,!0);let d=se(t,"variant",3,"full"),p=se(t,"showAvatar",3,!0),f=se(t,"showTimestamp",3,!0),s=se(t,"avatarSize",3,"md"),y=se(t,"class",3,"");const w=et(dt);if(!w)throw new Error("EventCard.Header must be used within EventCard.Root");const m=Zt(()=>({user:w.event.author}),w.ndk),h=dr(w.event.created_at);function g(P){P.stopPropagation()}var b=pr(),i=a(b);{let P=K(()=>m.profile??void 0);pe(i,()=>je.Root,(Z,ne)=>{ne(Z,{get ndk(){return w.ndk},get user(){return w.event.author},get profile(){return e(P)},children:(_,I)=>{var q=vr();q.__click=g,q.__keydown=D=>D.stopPropagation();var F=a(q);{var L=D=>{var S=ve(),U=B(S);{let O=K(()=>Ye("flex-shrink-0",s()==="sm"?"w-6 h-6":s()==="md"?"w-10 h-10":"w-12 h-12"));pe(U,()=>je.Avatar,(G,z)=>{z(G,{get class(){return e(O)}})})}o(D,S)};A(F,D=>{p()&&D(L)})}var E=l(F,2),j=a(E);{var me=D=>{var S=cr(),U=a(S);pe(U,()=>je.Name,(G,z)=>{z(G,{field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"})});var O=l(U,2);pe(O,()=>je.Nip05,(G,z)=>{z(G,{class:"text-sm text-muted-foreground truncate"})}),r(S),o(D,S)},le=D=>{var S=ve(),U=B(S);{var O=z=>{var N=ur(),$=a(N);pe($,()=>je.Name,(ie,X)=>{X(ie,{field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"})}),r(N),o(z,N)},G=z=>{var N=ve(),$=B(N);pe($,()=>je.Name,(ie,X)=>{X(ie,{field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"})}),o(z,N)};A(U,z=>{d()==="compact"?z(O):z(G,!1)},!0)}o(D,S)};A(j,D=>{d()==="full"?D(me):D(le,!1)})}r(E),r(q),o(_,q)},$$slots:{default:!0}})})}var n=l(i,2),v=a(n);{var x=P=>{var Z=fr(),ne=a(Z,!0);r(Z),W(_=>{Be(Z,"datetime",_),re(ne,h)},[()=>new Date(w.event.created_at*1e3).toISOString()]),o(P,Z)};A(v,P=>{f()&&w.event.created_at&&P(x)})}var T=l(v,2);{var R=P=>{var Z=ve(),ne=B(Z);ot(ne,()=>t.children),o(P,Z)};A(T,P=>{t.children&&P(R)})}r(n),r(b),W(P=>{Be(b,"data-variant",d()),Re(b,1,P)},[()=>$e(Ye("flex items-center gap-3",y()))]),o(Y,b),Te()}Le(["click","keydown"]);var mr=k('<button class="mt-2 text-sm cursor-pointer bg-transparent border-none p-0" type="button"> </button>'),hr=k('<div data-event-card-content="" class="relative"><div><!></div> <!></div>');function br(Y,t){ze(t,!0),se(t,"showMedia",3,!0),se(t,"showLinkPreview",3,!0),se(t,"highlightMentions",3,!0);let d=se(t,"class",3,"");const p=et(dt);if(!p)throw new Error("EventCard.Content must be used within EventCard.Root");et(Vt);let f=ue(void 0),s=ue(!1),y=ue(!1);Fe(()=>{if(!t.truncate||!e(f)){u(y,!1);return}const n=()=>{e(f)&&!e(s)&&u(y,e(f).scrollHeight>e(f).clientHeight+1)};return requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})}),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)});const w=()=>{u(s,!e(s))};var m=hr(),h=a(m),g=a(h);Ot(g,()=>p.event.id,n=>{Yt(n,{get ndk(){return p.ndk},get event(){return p.event}})}),r(h),at(h,n=>u(f,n),()=>e(f));var b=l(h,2);{var i=n=>{var v=mr();v.__click=w;var x=a(v,!0);r(v),W(()=>re(x,e(s)?"Show less":"Read more")),o(n,v)};A(b,n=>{t.truncate&&(e(y)||e(s))&&n(i)})}r(m),W(n=>Re(h,1,n),[()=>$e(Ye("whitespace-pre-wrap wrap-break-words",t.truncate&&!e(s)?`line-clamp-${t.truncate}`:void 0,d()))]),o(Y,m),Te()}Le(["click"]);var xr=k('<div data-event-card-actions="" role="presentation"><!></div>');function _r(Y,t){ze(t,!0);let d=se(t,"variant",3,"default"),p=se(t,"class",3,"");function f(m){m.stopPropagation()}var s=xr();s.__click=f,s.__keydown=m=>m.stopPropagation();var y=a(s);{var w=m=>{var h=ve(),g=B(h);ot(g,()=>t.children),o(m,h)};A(y,m=>{t.children&&m(w)})}r(s),W(m=>{Be(s,"data-variant",d()),Re(s,1,m)},[()=>$e(Ye("flex items-center gap-12 select-none",d()==="vertical"&&"flex-col gap-4",p()))]),o(Y,s),Te()}Le(["click","keydown"]);var yr=Ke('<path d="M11 5L6 9H2v6h4l5 4V5z"></path><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>',1),wr=Ke('<path d="M11 5L6 9H2v6h4l5 4V5z"></path><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>',1),kr=k('<div class="my-1 border-t border-border"></div> <div class="px-3 py-2 text-xs text-muted-foreground break-all"> </div>',1),Pr=k('<div class="text-xs bg-muted px-2 py-1 rounded break-all"> </div>'),Cr=k('<div class="my-1 border-t border-border"></div> <div class="px-3 py-2"><div class="text-xs text-muted-foreground mb-2"> </div> <div class="flex flex-col gap-1"></div></div>',1),Rr=k('<div class="absolute right-0 mt-2 w-64 bg-popover border border-border rounded-lg shadow-lg z-50 py-1" role="menu" tabindex="-1"><button class="w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-accent transition-colors text-destructive" type="button"><svg class="w-4 h-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><!></svg> <span class="text-sm"> </span></button> <button class="w-full flex items-center gap-3 px-3 py-2 text-left hover:bg-accent transition-colors text-yellow-600" type="button"><svg class="w-4 h-4 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg> <span class="text-sm">Report</span></button> <div class="my-1 border-t border-border"></div> <button class="w-full px-3 py-2 text-left text-sm hover:bg-accent transition-colors text-foreground" type="button">Copy author (nprofile)</button> <button class="w-full px-3 py-2 text-left text-sm hover:bg-accent transition-colors text-foreground" type="button">Copy ID (nevent)</button> <button class="w-full px-3 py-2 text-left text-sm hover:bg-accent transition-colors text-foreground" type="button">View raw event</button> <!></div>'),Er=k('<div class="fixed inset-0 z-[9999] flex items-center justify-center p-4" role="dialog" aria-modal="true"><div class="absolute inset-0 bg-black/50 backdrop-blur-sm" role="button" tabindex="-1"></div> <div class="relative bg-card border border-border rounded-lg shadow-2xl max-w-3xl w-full max-h-[80vh] flex flex-col"><div class="flex items-center justify-between px-6 py-4 border-b border-border"><h3 class="text-lg font-semibold text-foreground m-0">Raw Event</h3> <button class="p-1 hover:bg-accent rounded transition-colors text-muted-foreground hover:text-foreground"><svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div> <div class="flex-1 overflow-auto px-6 py-4"><pre class="text-sm bg-muted p-4 rounded overflow-x-auto text-foreground font-mono"> </pre></div> <div class="flex items-center justify-end gap-2 px-6 py-4 border-t border-border"><button class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors text-sm font-medium">Copy to Clipboard</button> <button class="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm font-medium">Close</button></div></div></div>'),Mr=k('<div data-event-card-dropdown=""><button class="p-1 hover:bg-accent rounded-full transition-colors text-muted-foreground hover:text-foreground" type="button"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button> <!></div> <!>',1);function Sr(Y,t){ze(t,!0);let d=se(t,"class",3,""),p=se(t,"showRelayInfo",3,!0);const f=et(dt);if(!f)throw new Error("EventCard.Dropdown must be used within EventCard.Root");let s=ue(!1),y=ue(!1);const w=K(()=>f.event.author?f.ndk.$mutes?.has(f.event.author.pubkey)??!1:!1);async function m(_,I){try{await navigator.clipboard.writeText(_),console.log(`Copied ${I}`)}catch(q){console.error("Failed to copy:",q)}u(s,!1)}function h(){const _=f.event.author.nprofile;m(_,"author nprofile")}function g(){const _=f.event.encode();m(_,"event ID")}function b(){u(s,!1),u(y,!0)}async function i(){if(!(!f.ndk.$currentUser?.pubkey||!f.event.author))try{await f.ndk.$mutes?.toggle(f.event.author.pubkey),console.log(e(w)?"User muted":"User unmuted"),u(s,!1)}catch(_){console.error("Failed to toggle mute:",_)}}function n(){console.log("Report event:",f.event.id),u(s,!1)}Fe(()=>{if(!e(s))return;const _=()=>{u(s,!1)};return document.addEventListener("click",_),()=>document.removeEventListener("click",_)});var v=Mr(),x=B(v),T=a(x);T.__click=_=>{_.stopPropagation(),u(s,!e(s))};var R=l(T,2);{var P=_=>{var I=Rr();I.__click=N=>N.stopPropagation(),I.__keydown=N=>N.stopPropagation();var q=a(I);q.__click=i;var F=a(q),L=a(F);{var E=N=>{var $=yr();Ce(2),o(N,$)},j=N=>{var $=wr();Ce(2),o(N,$)};A(L,N=>{e(w)?N(E):N(j,!1)})}r(F);var me=l(F,2),le=a(me,!0);r(me),r(q);var D=l(q,2);D.__click=n;var S=l(D,4);S.__click=h;var U=l(S,2);U.__click=g;var O=l(U,2);O.__click=b;var G=l(O,2);{var z=N=>{var $=ve(),ie=B($);{var X=oe=>{var be=kr(),xe=l(B(be),2),H=a(xe,!0);r(xe),W(()=>re(H,f.event.relay.url)),o(oe,be)},J=oe=>{var be=ve(),xe=B(be);{var H=Q=>{var de=Cr(),_e=l(B(de),2),ae=a(_e),V=a(ae);r(ae);var te=l(ae,2);Xe(te,21,()=>f.event.onRelays,c=>c.url,(c,C)=>{var M=Pr(),ee=a(M,!0);r(M),W(()=>re(ee,e(C).url)),o(c,M)}),r(te),r(_e),W(()=>re(V,`Seen on ${f.event.onRelays.length??""} relay${f.event.onRelays.length===1?"":"s"}`)),o(Q,de)};A(xe,Q=>{f.event.onRelays&&f.event.onRelays.length>0&&Q(H)},!0)}o(oe,be)};A(ie,oe=>{f.event.relay?.url?oe(X):oe(J,!1)})}o(N,$)};A(G,N=>{p()&&N(z)})}r(I),W(()=>re(le,e(w)?"Unmute":"Mute")),o(_,I)};A(R,_=>{e(s)&&_(P)})}r(x);var Z=l(x,2);{var ne=_=>{var I=Er(),q=a(I);q.__click=()=>u(y,!1),q.__keydown=O=>O.key==="Escape"&&u(y,!1);var F=l(q,2),L=a(F),E=l(a(L),2);E.__click=()=>u(y,!1),r(L);var j=l(L,2),me=a(j),le=a(me,!0);r(me),r(j);var D=l(j,2),S=a(D);S.__click=()=>m(f.event.inspect,"raw event");var U=l(S,2);U.__click=()=>u(y,!1),r(D),r(F),r(I),W(()=>re(le,f.event.inspect)),o(_,I)};A(Z,_=>{e(y)&&_(ne)})}W(_=>{Be(x,"data-menu-open",e(s)?"":void 0),Re(x,1,_)},[()=>$e(Ye("relative flex-shrink-0",d()))]),o(Y,v),Te()}Le(["click","keydown"]);Le(["click","keydown"]);const ut={Root:ir,Header:gr,Content:br,Actions:_r,Dropdown:Sr};var Ar=k('<button type="button" class="inline-flex items-center gap-1 px-2 py-1 bg-primary/20 hover:bg-primary/30 text-foreground rounded-full text-xs transition-colors"><!> <span class="max-w-[100px] truncate"> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>');function zr(Y,t){ze(t,!0);let d=ue(null);Fe(()=>{ge.fetchUser(t.pubkey).then(m=>{m?.fetchProfile().then(h=>{u(d,h,!0)})})});const p=K(()=>e(d)?.displayName||e(d)?.name||`${t.pubkey.slice(0,8)}...`);var f=Ar();f.__click=()=>t.onRemove(t.pubkey);var s=a(f);pe(s,()=>je.Root,(m,h)=>{h(m,{get ndk(){return ge},get pubkey(){return t.pubkey},children:(g,b)=>{var i=ve(),n=B(i);pe(n,()=>je.Avatar,(v,x)=>{x(v,{class:"w-3.5 h-3.5 flex-shrink-0"})}),o(g,i)},$$slots:{default:!0}})});var y=l(s,2),w=a(y,!0);r(y),Ce(2),r(f),W(()=>re(w,e(p))),o(Y,f),Te()}Le(["click"]);var Tr=k('<div class="text-xs text-muted-foreground truncate"> </div>'),jr=Ke('<svg class="w-3 h-3 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>'),Nr=k("<div><!></div>"),Ur=k('<button type="button"><!> <div class="flex-1 min-w-0 text-left"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <!></button>');function Ir(Y,t){ze(t,!0);let d=ue(null);Fe(()=>{ge.fetchUser(t.pubkey).then(n=>{n?.fetchProfile().then(v=>{u(d,v,!0)})})});const p=K(()=>e(d)?.displayName||e(d)?.name||`${t.pubkey.slice(0,8)}...`);var f=Ur();f.__click=()=>t.onToggle(t.pubkey);var s=a(f);pe(s,()=>je.Root,(n,v)=>{v(n,{get ndk(){return ge},get pubkey(){return t.pubkey},children:(x,T)=>{var R=ve(),P=B(R);pe(P,()=>je.Avatar,(Z,ne)=>{ne(Z,{class:"flex-shrink-0"})}),o(x,R)},$$slots:{default:!0}})});var y=l(s,2),w=a(y),m=a(w,!0);r(w);var h=l(w,2);{var g=n=>{var v=Tr(),x=a(v,!0);r(v),W(()=>re(x,e(d).nip05)),o(n,v)};A(h,n=>{e(d)?.nip05&&n(g)})}r(y);var b=l(y,2);{var i=n=>{var v=Nr(),x=a(v);{var T=R=>{var P=jr();o(R,P)};A(x,R=>{t.isSelected&&R(T)})}r(v),W(()=>Re(v,1,`w-4 h-4 rounded border flex items-center justify-center flex-shrink-0 ${t.isSelected?"bg-primary border-primary":"border-border"}`)),o(n,v)};A(b,n=>{t.showCheckbox&&n(i)})}r(f),W(()=>{Re(f,1,`w-full flex items-center gap-2 p-2 rounded-md transition-colors ${t.isSelected?"bg-primary/20":"hover:bg-muted"}`),re(m,e(p))}),o(Y,f),Te()}Le(["click"]);var Lr=k('<button type="button" class="absolute right-1 top-1/2 -translate-y-1/2 px-2 py-1 bg-primary hover:bg-primary/90 text-primary-foreground rounded text-xs font-medium transition-colors">Add</button>'),Dr=k('<p class="text-xs text-muted-foreground mt-1.5">Search follows or paste npub/hex/NIP-05</p>'),Br=k('<div class="px-3 py-2 border-b border-border bg-muted/30"><div class="text-xs font-medium text-muted-foreground mb-2"> </div> <div class="flex flex-wrap gap-1.5"></div></div>'),Fr=k('<div class="text-center py-8 px-3 text-muted-foreground text-sm"> </div>'),Kr=k('<div class="p-2 space-y-1"></div>'),Zr=k('<div class="flex flex-col max-h-[400px]"><div class="p-3 border-b border-border"><h3 class="font-semibold text-sm mb-2">Tag people</h3> <div class="relative"><svg class="absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <input type="text" placeholder="Search or paste npub/identifier..." class="w-full pl-8 pr-16 py-2 bg-muted border border-border rounded-lg text-foreground text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"/> <!></div> <!></div> <!> <div class="overflow-y-auto flex-1"><!></div></div>');function xt(Y,t){ze(t,!0);let d=se(t,"searchQuery",15);var p=Zr(),f=a(p),s=l(a(f),2),y=l(a(s),2);Bt(y),y.__keydown=R=>{R.key==="Enter"&&t.isIdentifierInput&&t.onAddByIdentifier()};var w=l(y,2);{var m=R=>{var P=Lr();P.__click=function(...Z){t.onAddByIdentifier?.apply(this,Z)},o(R,P)};A(w,R=>{t.isIdentifierInput&&R(m)})}r(s);var h=l(s,2);{var g=R=>{var P=Dr();o(R,P)};A(h,R=>{d()||R(g)})}r(f);var b=l(f,2);{var i=R=>{var P=Br(),Z=a(P),ne=a(Z);r(Z);var _=l(Z,2);Xe(_,20,()=>t.selectedPubkeys,I=>I,(I,q)=>{zr(I,{get pubkey(){return q},get onRemove(){return t.onRemoveUser}})}),r(_),r(P),W(()=>re(ne,`Selected (${t.selectedPubkeys.length??""})`)),o(R,P)};A(b,R=>{t.selectedPubkeys.length>0&&R(i)})}var n=l(b,2),v=a(n);{var x=R=>{var P=Fr(),Z=a(P,!0);r(P),W(()=>re(Z,d()?"No matches found":"You don't follow anyone yet")),o(R,P)},T=R=>{var P=Kr();Xe(P,20,()=>t.filteredFollows,Z=>Z,(Z,ne)=>{{let _=K(()=>t.selectedPubkeys.includes(ne));Ir(Z,{get pubkey(){return ne},get isSelected(){return e(_)},get showCheckbox(){return t.multiple},get onToggle(){return t.onToggleUser}})}}),r(P),o(R,P)};A(v,R=>{t.filteredFollows.length===0?R(x):R(T,!1)})}r(n),r(p),jt(y,d),o(Y,p),Te()}Le(["keydown","click"]);var Wr=k('<span class="ml-auto text-xs bg-primary/20 text-primary rounded-full px-2 py-0.5"> </span>'),Qr=k('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <span> </span> <!>',1),Hr=k('<span class="absolute -top-1 -right-1 text-[10px] bg-primary text-primary-foreground rounded-full w-4 h-4 flex items-center justify-center"> </span>'),qr=Ke('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg><!>',1),Or=k('<div role="presentation" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center"><div role="dialog" tabindex="-1" style="width: 380px;" class="bg-card border border-border rounded-lg shadow-xl overflow-hidden"><!></div></div>'),Vr=k('<div class="bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Yr=k('<div class="relative"><!> <!></div>');function Xr(Y,t){ze(t,!0);let d=se(t,"selectedPubkeys",31,()=>Oe([])),p=se(t,"multiple",3,!0),f=se(t,"buttonClass",3,""),s=se(t,"disabled",3,!1),y=se(t,"iconOnly",3,!0),w=se(t,"open",15,!1),m=ue(""),h=null,g=ue(Oe({top:0,left:0,width:0}));const b=ge.$subscribe(()=>ge.$currentUser?.pubkey?{filters:[{kinds:[3],authors:[ge.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),i=K(()=>{const E=b.events[0];return E?new Set(E.tags.filter(j=>j[0]==="p").map(j=>j[1])):new Set});let n=ue(Oe(new Map));const v=K(()=>e(m)?Array.from(e(n).entries()).filter(([j])=>e(i).has(j)).map(([j])=>j).slice(0,50):Array.from(e(i)).slice(0,50));Fe(()=>{if(!e(m).trim()||!ge.cacheAdapter?.getProfiles){u(n,new Map,!0);return}const E=e(m).toLowerCase();ge.cacheAdapter.getProfiles({fields:["name","displayName","nip05"],contains:E}).then(j=>{u(n,j??new Map,!0)}).catch(j=>{console.error("Failed to search profiles:",j),u(n,new Map,!0)})});function x(){if(!w()&&h){const E=h.getBoundingClientRect();u(g,{top:E.bottom+4,left:E.left,width:Math.max(E.width,380)},!0)}w(!w())}const T=K(()=>f().includes("hidden"));Fe(()=>{if(w()&&e(T)){const E=window.innerWidth,j=window.innerHeight,me=380;u(g,{top:(j-400)/2,left:(E-me)/2,width:me},!0)}});function R(E){p()?d().includes(E)?d(d().filter(j=>j!==E)):d([...d(),E]):(d([E]),w(!1)),t.onSelect?.(d())}function P(E){d(d().filter(j=>j!==E)),t.onSelect?.(d())}async function Z(){if(e(m).trim())try{const E=e(m).trim(),j=await ge.fetchUser(E);j?.pubkey?(p()?d().includes(j.pubkey)||(d([...d(),j.pubkey]),t.onSelect?.(d()),Ee.success("User added")):(d([j.pubkey]),t.onSelect?.(d()),w(!1)),u(m,"")):Ee.error("User not found")}catch(E){console.error("Failed to fetch user:",E),Ee.error("Failed to fetch user")}}function ne(){w(!1)}const _=K(()=>{const E=e(m).trim();return E.length>0&&(E.startsWith("npub1")||E.startsWith("nprofile1")||E.includes("@")||E.length===64&&/^[0-9a-f]+$/i.test(E))});var I=Yr(),q=a(I);{let E=K(()=>y()?"icon":"default"),j=K(()=>y()?"h-8 w-8":"w-full justify-start"),me=K(f),le=K(()=>t.buttonLabel||"Tag people");De(q,{type:"button",variant:"ghost",get size(){return e(E)},get class(){return`${e(j)??""} ${e(me)??""}`},get disabled(){return s()},onclick:x,get title(){return e(le)},get ref(){return h},set ref(D){h=D},children:(D,S)=>{var U=ve(),O=B(U);{var G=N=>{var $=Qr(),ie=l(B($),2),X=a(ie,!0);r(ie);var J=l(ie,2);{var oe=be=>{var xe=Wr(),H=a(xe,!0);r(xe),W(()=>re(H,d().length)),o(be,xe)};A(J,be=>{d().length>0&&be(oe)})}W(()=>re(X,t.buttonLabel)),o(N,$)},z=N=>{var $=qr(),ie=l(B($));{var X=J=>{var oe=Hr(),be=a(oe,!0);r(oe),W(()=>re(be,d().length)),o(J,oe)};A(ie,J=>{d().length>0&&J(X)})}o(N,$)};A(O,N=>{!y()&&t.buttonLabel?N(G):N(z,!1)})}o(D,U)},$$slots:{default:!0}})}var F=l(q,2);{var L=E=>{var j=ve(),me=B(j);{var le=S=>{var U=Or();U.__click=ne,U.__keydown=z=>z.key==="Escape"&&ne();var O=a(U);O.__click=z=>z.stopPropagation(),O.__keydown=z=>z.stopPropagation();var G=a(O);xt(G,{get isIdentifierInput(){return e(_)},get selectedPubkeys(){return d()},get filteredFollows(){return e(v)},get multiple(){return p()},onSearchQueryChange:z=>u(m,z,!0),onAddByIdentifier:Z,onRemoveUser:P,onToggleUser:R,get searchQuery(){return e(m)},set searchQuery(z){u(m,z,!0)}}),r(O),r(U),Ge(U,z=>it?.(z)),o(S,U)},D=S=>{var U=Vr(),O=a(U);xt(O,{get isIdentifierInput(){return e(_)},get selectedPubkeys(){return d()},get filteredFollows(){return e(v)},get multiple(){return p()},onSearchQueryChange:G=>u(m,G,!0),onAddByIdentifier:Z,onRemoveUser:P,onToggleUser:R,get searchQuery(){return e(m)},set searchQuery(G){u(m,G,!0)}}),r(U),Ge(U,G=>it?.(G)),Ge(U,(G,z)=>lt?.(G,z),()=>ne),W(()=>Pt(U,`position: fixed; top: ${e(g).top??""}px; left: ${e(g).left??""}px; width: 380px;`)),o(S,U)};A(me,S=>{e(T)?S(le):S(D,!1)})}o(E,j)};A(F,E=>{w()&&E(L)})}r(I),o(Y,I),Te()}Le(["click","keydown"]);var Jr=k('<div class="text-xs text-muted-foreground truncate"> </div>'),Gr=k('<button type="button"><!> <div class="flex-1 min-w-0 text-left"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div></button>');function $r(Y,t){ze(t,!0);let d=ue(null);Fe(()=>{ge.fetchUser(t.pubkey).then(g=>{g?.fetchProfile().then(b=>{u(d,b,!0)})})});var p=Gr();p.__click=g=>{g.preventDefault(),g.stopPropagation(),t.onSelect(t.pubkey)};var f=a(p);pe(f,()=>je.Root,(g,b)=>{b(g,{get ndk(){return ge},get pubkey(){return t.pubkey},children:(i,n)=>{var v=ve(),x=B(v);pe(x,()=>je.Avatar,(T,R)=>{R(T,{class:"flex-shrink-0"})}),o(i,v)},$$slots:{default:!0}})});var s=l(f,2),y=a(s),w=a(y,!0);r(y);var m=l(y,2);{var h=g=>{var b=Jr(),i=a(b,!0);r(b),W(()=>re(i,e(d).nip05)),o(g,b)};A(m,g=>{e(d)?.nip05&&g(h)})}r(s),r(p),W(()=>{Re(p,1,`w-full flex items-center gap-2 p-2 transition-colors ${t.isSelected?"bg-primary/20":"hover:bg-muted"}`),re(w,e(d)?.displayName||e(d)?.name||"Anonymous")}),qe("mouseenter",p,function(...g){t.onMouseEnter?.apply(this,g)}),o(Y,p),Te()}Le(["click"]);var eo=k('<div class="bg-card border border-border rounded-lg shadow-xl z-[1003] overflow-hidden"><div class="max-h-[300px] overflow-y-auto"></div></div>');function to(Y,t){ze(t,!0);let d=ue(0);const p=ge.$subscribe(()=>ge.$currentUser?.pubkey?{filters:[{kinds:[3],authors:[ge.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),f=K(()=>{const i=p.events[0];return i?new Set(i.tags.filter(n=>n[0]==="p").map(n=>n[1])):new Set});let s=ue(Oe(new Map));const y=K(()=>t.searchQuery?Array.from(e(s).entries()).filter(([n])=>e(f).has(n)).map(([n])=>n).slice(0,10):Array.from(e(f)).slice(0,10));Fe(()=>{if(!t.searchQuery.trim()||!ge.cacheAdapter?.getProfiles){u(s,new Map,!0);return}const i=t.searchQuery.toLowerCase();ge.cacheAdapter.getProfiles({fields:["name","displayName","nip05"],contains:i}).then(n=>{u(s,n??new Map,!0)}).catch(n=>{console.error("Failed to search profiles:",n),u(s,new Map,!0)})}),Fe(()=>{e(d)>=e(y).length&&u(d,Math.max(0,e(y).length-1),!0)});function w(i){const n=ge.getUser({pubkey:i}),v=Array.from(n.relayUrls||[]),x=Wt.nprofileEncode({pubkey:i,relays:v.slice(0,3)});t.onSelect(`nostr:${x}`)}function m(i){switch(i.key){case"ArrowDown":i.preventDefault(),u(d,(e(d)+1)%e(y).length);break;case"ArrowUp":i.preventDefault(),u(d,e(d)===0?e(y).length-1:e(d)-1,!0);break;case"Enter":i.preventDefault(),e(y).length>0&&w(e(y)[e(d)]);break;case"Escape":i.preventDefault(),t.onClose();break}}var h=ve();qe("keydown",vt,m);var g=B(h);{var b=i=>{var n=eo(),v=a(n);Xe(v,22,()=>e(y),x=>x,(x,T,R)=>{{let P=K(()=>e(R)===e(d));$r(x,{get pubkey(){return T},get isSelected(){return e(P)},onSelect:w,onMouseEnter:()=>u(d,e(R),!0)})}}),r(v),r(n),Ge(n,x=>it?.(x)),W(()=>Pt(n,`position: fixed; top: ${t.position.top??""}px; left: ${t.position.left??""}px; max-width: 320px;`)),o(i,n)};A(g,i=>{e(y).length>0&&i(b)})}o(Y,h),Te()}var ro=k('<div class="absolute inset-0 flex items-center justify-center"><div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div></div>'),oo=k('<button type="button" class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center hover:bg-red-600" aria-label="Remove image"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),ao=k('<div class="relative group"><img alt="Upload preview"/> <!></div>'),no=k('<div class="flex flex-wrap gap-2 mt-2"></div>'),so=Ke('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),lo=k('<div><input type="file" accept="image/*" multiple class="hidden"/> <div><textarea class="w-full min-h-[120px] max-md:flex-1 max-md:min-h-0 bg-transparent text-foreground placeholder-neutral-500 resize-none focus:outline-none focus:ring-0 text-lg"></textarea> <!></div> <div class="flex items-center gap-2 mt-2 pt-2 border-t border-border"><!> <!> <!></div></div> <!>',1);function _t(Y,t){ze(t,!0);let d=se(t,"value",15,""),p=se(t,"placeholder",3,"What's on your mind?"),f=se(t,"autofocus",3,!1),s=se(t,"disabled",3,!1),y=se(t,"class",3,""),w=se(t,"selectedMentions",31,()=>Oe([]));const m=new Xt(ge),h=Jt(m);let g,b,i=ue(!1),n=ue(Oe([])),v=ue(!1),x=ue(!1),T=ue(""),R=ue(0),P=ue(Oe({top:0,left:0})),Z=Oe(new Map);async function ne(c){if(!c.type.startsWith("image/")){Ee.error("Please select an image file");return}const C=URL.createObjectURL(c),M=e(n).length;u(n,[...e(n),{url:"",preview:C}],!0),u(v,!0);try{await h.upload(c,{fallbackServer:"https://blossom.primal.net"}),h.result?.url&&(e(n)[M]={url:h.result.url,preview:C},_(h.result.url),Ee.success("Image uploaded"))}catch(ee){console.error("Upload failed:",ee),Ee.error("Failed to upload image"),u(n,e(n).filter((ce,fe)=>fe!==M),!0)}finally{u(v,!1)}}function _(c){const C=g;if(!C)return;const M=C.selectionStart,ee=C.selectionEnd,ce=`
${c}
`;d(d().slice(0,M)+ce+d().slice(ee)),setTimeout(()=>{C.selectionStart=C.selectionEnd=M+ce.length,C.focus()},0)}function I(c){const C=e(n)[c];C.url&&d(d().replace(`
${C.url}
`,"").replace(C.url,"")),URL.revokeObjectURL(C.preview),u(n,e(n).filter((M,ee)=>ee!==c),!0)}function q(c){const C=c.target,M=C.files?.[0];M&&ne(M),C.value=""}function F(c){c.preventDefault(),u(i,!0)}function L(c){c.preventDefault(),u(i,!1)}async function E(c){c.preventDefault(),u(i,!1);const C=c.dataTransfer?.files;if(C&&C.length>0)for(const M of Array.from(C))M.type.startsWith("image/")&&await ne(M)}async function j(c){const C=c.clipboardData?.items;if(C){for(const M of Array.from(C))if(M.type.startsWith("image/")){c.preventDefault();const ee=M.getAsFile();ee&&await ne(ee)}}}function me(){b?.click()}function le(){if(!g)return{top:0,left:0};const c=g,C=c.selectionStart,M=document.createElement("div"),ee=window.getComputedStyle(c);["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"].forEach(ke=>{M.style[ke]=ee[ke]}),M.style.position="absolute",M.style.visibility="hidden",M.style.whiteSpace="pre-wrap",M.style.wordWrap="break-word",document.body.appendChild(M);const fe=c.value.substring(0,C);M.textContent=fe;const he=document.createElement("span");he.textContent=c.value.substring(C)||".",M.appendChild(he);const ye=c.getBoundingClientRect(),Me={top:ye.top+he.offsetTop+parseInt(ee.borderTopWidth)-c.scrollTop+20,left:ye.left+he.offsetLeft+parseInt(ee.borderLeftWidth)};return document.body.removeChild(M),Me}function D(c){const C=c.target,M=C.selectionStart,ee=C.value.substring(0,M),ce=ee.lastIndexOf("@");if(ce!==-1){const fe=ee.substring(ce+1),he=ce>0?ee[ce-1]:" ",ye=fe.includes(" ")||fe.includes(`
`);if((he===" "||he===`
`||ce===0)&&!ye){u(R,ce,!0),u(T,fe,!0),u(P,le(),!0),u(x,!0);return}}u(x,!1)}async function S(c){const C=g;if(!C)return;const M=C.selectionStart;if(!c.match(/nostr:nprofile1([a-z0-9]+)/))return;const ce=ge.getUser({nprofile:c.replace("nostr:","")});await ce.fetchProfile();const fe=ce.profile?.nip05?`@${ce.profile.nip05}`:`@${ce.profile?.displayName||ce.profile?.name||ce.npub.slice(0,12)}`;Z.set(fe,c);const he=d().substring(0,e(R)),ye=d().substring(M);d(he+fe+" "+ye);const Me=e(R)+fe.length+1;setTimeout(()=>{C.selectionStart=C.selectionEnd=Me,C.focus()},0),u(x,!1),u(T,"")}function U(){u(x,!1),u(T,"")}function O(){let c=d();for(const[C,M]of Z)for(;c.includes(C);)c=c.replace(C,M);return c}function G(){d(""),Z.clear(),u(n,[],!0),u(x,!1),u(T,"")}function z(c){e(x)||c.key==="Enter"&&c.stopPropagation()}var N={getContentWithNostrEntities:O,reset:G},$=lo(),ie=B($),X=a(ie);X.__change=q,at(X,c=>b=c,()=>b);var J=l(X,2),oe=a(J);Lt(oe),Dt(oe,f()),oe.__input=D,oe.__keydown=z,at(oe,c=>g=c,()=>g);var be=l(oe,2);{var xe=c=>{var C=no();Xe(C,23,()=>e(n),M=>M.preview,(M,ee,ce)=>{var fe=ao(),he=a(fe),ye=l(he,2);{var Me=Pe=>{var we=ro();o(Pe,we)},ke=Pe=>{var we=oo();we.__click=()=>I(e(ce)),o(Pe,we)};A(ye,Pe=>{e(ee).url?Pe(ke,!1):Pe(Me)})}r(fe),W(()=>{Be(he,"src",e(ee).preview),Re(he,1,`w-20 h-20 object-cover rounded-lg border border ${e(ee).url?"":"opacity-50 animate-pulse"}`)}),o(M,fe)}),r(C),o(c,C)};A(be,c=>{e(n).length>0&&c(xe)})}r(J);var H=l(J,2),Q=a(H);{var de=c=>{var C=ve(),M=B(C);ot(M,()=>t.relayButton),o(c,C)};A(Q,c=>{t.relayButton&&c(de)})}var _e=l(Q,2);{let c=K(()=>s()||e(v));De(_e,{type:"button",variant:"ghost",size:"icon",onclick:me,get disabled(){return e(c)},class:"h-8 w-8",title:"Add image",children:(C,M)=>{var ee=so();o(C,ee)},$$slots:{default:!0}})}var ae=l(_e,2);Xr(ae,{get onSelect(){return t.onMentionsChange},get disabled(){return s()},get selectedPubkeys(){return w()},set selectedPubkeys(c){w(c)}}),r(H),r(ie);var V=l(ie,2);{var te=c=>{to(c,{get position(){return e(P)},get searchQuery(){return e(T)},onSelect:S,onClose:U})};A(V,c=>{e(x)&&c(te)})}return W(()=>{Re(ie,1,`relative flex-1 flex flex-col ${y()??""}`),Re(J,1,`flex-1 flex flex-col ${e(i)?"ring-2 ring-primary ring-offset-2 rounded-lg":""}`),Be(oe,"placeholder",p()),oe.disabled=s()}),qe("dragover",J,F),qe("dragleave",J,L),qe("drop",J,E),qe("paste",oe,j),jt(oe,d),o(Y,$),Te(N)}Le(["change","input","keydown","click"]);function io(Y){const t=Oe({selectedRelayUrls:[]}),d=K(()=>rt.relays.filter(p=>p.enabled));return Fe(()=>{Y()&&(rt.selectedRelay?t.selectedRelayUrls=[rt.selectedRelay]:t.selectedRelayUrls.length===0&&(t.selectedRelayUrls=e(d).filter(p=>p.write).map(p=>p.url)))}),{get selectedRelayUrls(){return t.selectedRelayUrls},set selectedRelayUrls(p){t.selectedRelayUrls=p},get allRelays(){return e(d)}}}var co=k('<div class="-mx-6 px-4 py-3 mb-4 border-b border-border bg-card/50"><div class="flex gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1"><span class="font-semibold text-foreground text-sm"> </span> <span class="text-muted-foreground text-xs"> </span></div> <p class="text-muted-foreground text-sm line-clamp-3"> </p></div></div></div>'),uo=k('<img alt="" class="w-5 h-5 rounded border border-background"/>'),vo=k('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><!></div>'),fo=k('<div class="flex items-center -space-x-1"></div>'),po=k('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),go=k('<div class="relative"><!> <!></div>'),mo=k('<div class="absolute top-full left-0 mt-2 bg-popover border border-border rounded-lg shadow-xl z-[100] w-80 max-h-[400px] overflow-y-auto transition-all duration-200"><!></div>'),ho=k('<div class="relative"><!> <!></div>'),bo=k('<div class="-mx-6 px-4 py-3 mb-4 border-y border-border bg-muted/30"><div class="text-xs text-muted-foreground mb-2">Quoting</div> <div class="border border-border rounded-lg overflow-hidden bg-card"><!></div></div>'),xo=k('<div class="flex items-center justify-between -mx-6 -mt-6 px-4 py-3 mb-4 border-b border-border"><!> <!> <!></div> <!> <div class="relative mb-4"><!></div> <!> <div class="-mx-6 px-4 py-3 border-t border-border"><p class="text-xs text-muted-foreground">Press <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">Esc</kbd> to cancel, <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">⌘</kbd> + <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">Enter</kbd> to post</p></div>',1),_o=k('<div class="px-4 py-3 mb-4 border-b border-border bg-card/50 shrink-0"><div class="flex gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1"><span class="font-semibold text-foreground text-sm"> </span> <span class="text-muted-foreground text-xs"> </span></div> <p class="text-muted-foreground text-sm line-clamp-3"> </p></div></div></div>'),yo=k('<img alt="" class="w-5 h-5 rounded border border-background"/>'),wo=k('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><!></div>'),ko=k('<div class="flex items-center -space-x-1"></div>'),Po=k('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),Co=k('<div class="relative"><!> <!></div>'),Ro=k('<div role="presentation" class="fixed inset-0 bg-black/50 z-[1002] flex items-center justify-center transition-opacity"><div role="dialog" tabindex="-1" class="bg-popover border border-border rounded-lg shadow-xl w-80 max-h-[400px] overflow-y-auto"><!></div></div>'),Eo=k('<div class="relative"><!> <!></div>'),Mo=k('<div class="px-4 py-3 mb-4 border-y border-border bg-muted/30 shrink-0"><div class="text-xs text-muted-foreground mb-2">Quoting</div> <div class="border border-border rounded-lg overflow-hidden bg-card"><!></div></div>'),So=k('<div class="flex items-center justify-between px-4 py-3 mb-4 border-b border-border shrink-0"><!> <!> <!></div> <!> <div class="relative mb-4 flex-1 flex flex-col overflow-hidden px-4"><div class="flex-1 overflow-hidden"><!></div></div> <!> <div class="px-4 py-3 border-t border-border shrink-0"><p class="text-xs text-muted-foreground">Press <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">Esc</kbd> to cancel, <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">⌘</kbd> + <kbd class="px-1.5 py-0.5 bg-muted rounded text-muted-foreground">Enter</kbd> to post</p></div>',1);function yt(Y,t){ze(t,!0);const d=new Rt("(min-width: 768px)");let p=se(t,"open",15,!1),f=ue(""),s=ue(!1),y=ue(!1),w=ue(!1),m=ue(Oe([])),h,g=ue(null);Fe(()=>{if(!t.replyTo){u(g,null);return}t.replyTo.author.fetchProfile().then(F=>{u(g,F,!0)})});const b=io(()=>p()),i=K(()=>b.selectedRelayUrls),n=K(()=>b.allRelays);async function v(){if(!(!e(f).trim()||e(s)||e(i).length===0))try{u(s,!0);const F=h?.getContentWithNostrEntities()??e(f);let L;t.replyTo?L=t.replyTo.reply():t.quotedEvent?(L=new pt(ge),L.kind=1,L.tag(t.quotedEvent,void 0,!1,"q")):(L=new pt(ge),L.kind=1),L.content=t.quotedEvent?`${F}
nostr:${t.quotedEvent.encode()}`:F,t.replyTo||(L.isProtected=e(w)),e(m).forEach(j=>{L.tags.push(["p",j])}),await L.sign();const E=Qt.fromRelayUrls(e(i),ge);if(await L.publish(E),L.publishStatus==="error"){const j=L.publishError;console.error("Publish error object:",j),console.error("Relay errors:",j?.relayErrors);const me=j?.relayErrors||{},le=Object.entries(me);if(le.length>0){const D=le.map(([S,U])=>`• ${S.replace("wss://","")}: ${U}`).join(`
`);Ee.error(`Failed to publish to relays:

${D}`)}else Ee.error(`Failed to publish: ${j?.message||"Not enough relays received the event"}`);return}h?.reset(),u(f,""),u(m,[],!0),p(!1),Ee.success(t.replyTo?"Reply published":t.quotedEvent?"Quote published":"Note published"),t.onPublished?.(),t.onClose?.()}catch(F){console.error("Failed to publish note:",F),Ee.error(`Failed to publish: ${F instanceof Error?F.message:"Unknown error"}`)}finally{u(s,!1)}}function x(F){b.selectedRelayUrls.includes(F)?b.selectedRelayUrls=b.selectedRelayUrls.filter(L=>L!==F):b.selectedRelayUrls=[...b.selectedRelayUrls,F]}function T(F){b.selectedRelayUrls=[F],u(y,!1)}function R(){u(y,!1)}function P(){e(s)||(p(!1),u(f,""),u(m,[],!0),t.onClose?.())}function Z(F){(F.metaKey||F.ctrlKey)&&F.key==="Enter"&&v()}var ne=ve();qe("keydown",vt,Z);var _=B(ne);{var I=F=>{var L=ve(),E=B(L);pe(E,()=>St,(j,me)=>{me(j,{get open(){return p()},onOpenChange:le=>{le?p(!0):P()},children:(le,D)=>{var S=ve(),U=B(S);pe(U,()=>Et,(O,G)=>{G(O,{class:"md:max-w-2xl !overflow-visible",children:(z,N)=>{var $=xo(),ie=B($),X=a(ie);De(X,{variant:"ghost",size:"icon",onclick:P,get disabled(){return e(s)},class:"h-10 w-10",children:(ae,V)=>{We(ae,{name:"close",size:"lg"})},$$slots:{default:!0}});var J=l(X,2);pe(J,()=>Mt,(ae,V)=>{V(ae,{class:"text-lg",children:(te,c)=>{Ce();var C=Ae();W(()=>re(C,t.replyTo?"Reply":t.quotedEvent?"Quote":"Compose")),o(te,C)},$$slots:{default:!0}})});var oe=l(J,2);{let ae=K(()=>!e(f).trim()||e(s)||e(i).length===0);De(oe,{onclick:v,get disabled(){return e(ae)},class:"rounded-full",size:"sm",children:(V,te)=>{Ce();var c=Ae();W(()=>re(c,e(s)?"Publishing...":"Post")),o(V,c)},$$slots:{default:!0}})}r(ie);var be=l(ie,2);{var xe=ae=>{var V=co(),te=a(V),c=a(te);pe(c,()=>je.Root,(ke,Pe)=>{Pe(ke,{get ndk(){return ge},get pubkey(){return t.replyTo.pubkey},children:(we,Ne)=>{var Qe=ve(),Ze=B(Qe);pe(Ze,()=>je.Avatar,(Ue,Se)=>{Se(Ue,{class:"w-10 h-10"})}),o(we,Qe)},$$slots:{default:!0}})});var C=l(c,2),M=a(C),ee=a(M),ce=a(ee,!0);r(ee);var fe=l(ee,2),he=a(fe);r(fe),r(M);var ye=l(M,2),Me=a(ye,!0);r(ye),r(C),r(te),r(V),W((ke,Pe)=>{re(ce,ke),re(he,`@${Pe??""}`),re(Me,t.replyTo.content)},[()=>e(g).displayName||e(g).name||`${t.replyTo.pubkey.slice(0,8)}...`,()=>e(g).name||t.replyTo.pubkey.slice(0,8)]),o(ae,V)};A(be,ae=>{t.replyTo&&e(g)&&ae(xe)})}var H=l(be,2),Q=a(H);{const ae=te=>{var c=ho(),C=a(c);De(C,{type:"button",variant:"ghost",size:"icon",onclick:()=>u(y,!e(y)),get disabled(){return e(s)},class:"h-8 w-8",title:"Select relays",children:(ce,fe)=>{var he=ve(),ye=B(he);{var Me=Pe=>{var we=fo();Xe(we,21,()=>e(i),nt,(Ne,Qe)=>{const Ze=K(()=>e(n).find(Ve=>Ve.url===e(Qe))),Ue=K(()=>e(Ze)?gt(e(Ze).url):null);var Se=ve(),He=B(Se);{var tt=Ve=>{var Ie=uo();W(()=>Be(Ie,"src",e(Ue).info.icon)),o(Ve,Ie)},ct=Ve=>{var Ie=vo(),Je=a(Ie);We(Je,{name:"relay",size:"xs",class:"text-muted-foreground"}),r(Ie),o(Ve,Ie)};A(He,Ve=>{e(Ue)?.info?.icon?Ve(tt):Ve(ct,!1)})}o(Ne,Se)}),r(we),o(Pe,we)},ke=Pe=>{var we=go(),Ne=a(we);We(Ne,{name:"relay",size:"md"});var Qe=l(Ne,2);{var Ze=Ue=>{var Se=po(),He=a(Se,!0);r(Se),W(()=>re(He,e(i).length)),o(Ue,Se)};A(Qe,Ue=>{e(i).length>2&&Ue(Ze)})}r(we),o(Pe,we)};A(ye,Pe=>{e(i).length<=2&&e(i).length>0?Pe(Me):Pe(ke,!1)})}o(ce,he)},$$slots:{default:!0}});var M=l(C,2);{var ee=ce=>{var fe=mo(),he=a(fe);ht(he,{get selectedRelayUrls(){return e(i)},onToggleRelay:x,onSelectOnly:T,get isProtected(){return e(w)},set isProtected(ye){u(w,ye,!0)}}),r(fe),Ge(fe,(ye,Me)=>lt?.(ye,Me),()=>R),o(ce,fe)};A(M,ce=>{e(y)&&ce(ee)})}r(c),o(te,c)};let V=K(()=>t.replyTo?"Write your reply...":t.quotedEvent?"Add your thoughts...":"What's on your mind?");at(_t(Q,{get placeholder(){return e(V)},autofocus:!0,get disabled(){return e(s)},get value(){return e(f)},set value(te){u(f,te,!0)},get selectedMentions(){return e(m)},set selectedMentions(te){u(m,te,!0)},relayButton:ae,$$slots:{relayButton:!0}}),te=>h=te,()=>h)}r(H);var de=l(H,2);{var _e=ae=>{var V=bo(),te=l(a(V),2),c=a(te);kt(c,{get event(){return t.quotedEvent},showActions:!1}),r(te),r(V),o(ae,V)};A(de,ae=>{t.quotedEvent&&ae(_e)})}Ce(2),o(z,$)},$$slots:{default:!0}})}),o(le,S)},$$slots:{default:!0}})}),o(F,L)},q=F=>{var L=ve(),E=B(L);pe(E,()=>Tt,(j,me)=>{me(j,{get open(){return p()},onOpenChange:le=>{le?p(!0):P()},children:(le,D)=>{var S=ve(),U=B(S);pe(U,()=>At,(O,G)=>{G(O,{class:"h-[95vh] flex flex-col !overflow-visible",children:(z,N)=>{var $=So(),ie=B($),X=a(ie);De(X,{variant:"ghost",size:"icon",onclick:P,get disabled(){return e(s)},class:"h-10 w-10",children:(V,te)=>{We(V,{name:"close",size:"lg"})},$$slots:{default:!0}});var J=l(X,2);pe(J,()=>zt,(V,te)=>{te(V,{class:"text-lg",children:(c,C)=>{Ce();var M=Ae();W(()=>re(M,t.replyTo?"Reply":t.quotedEvent?"Quote":"Compose")),o(c,M)},$$slots:{default:!0}})});var oe=l(J,2);{let V=K(()=>!e(f).trim()||e(s)||e(i).length===0);De(oe,{onclick:v,get disabled(){return e(V)},class:"rounded-full",size:"sm",children:(te,c)=>{Ce();var C=Ae();W(()=>re(C,e(s)?"Publishing...":"Post")),o(te,C)},$$slots:{default:!0}})}r(ie);var be=l(ie,2);{var xe=V=>{var te=_o(),c=a(te),C=a(c);pe(C,()=>je.Root,(Pe,we)=>{we(Pe,{get ndk(){return ge},get pubkey(){return t.replyTo.pubkey},children:(Ne,Qe)=>{var Ze=ve(),Ue=B(Ze);pe(Ue,()=>je.Avatar,(Se,He)=>{He(Se,{class:"w-10 h-10"})}),o(Ne,Ze)},$$slots:{default:!0}})});var M=l(C,2),ee=a(M),ce=a(ee),fe=a(ce,!0);r(ce);var he=l(ce,2),ye=a(he);r(he),r(ee);var Me=l(ee,2),ke=a(Me,!0);r(Me),r(M),r(c),r(te),W((Pe,we)=>{re(fe,Pe),re(ye,`@${we??""}`),re(ke,t.replyTo.content)},[()=>e(g).displayName||e(g).name||`${t.replyTo.pubkey.slice(0,8)}...`,()=>e(g).name||t.replyTo.pubkey.slice(0,8)]),o(V,te)};A(be,V=>{t.replyTo&&e(g)&&V(xe)})}var H=l(be,2),Q=a(H),de=a(Q);{const V=c=>{var C=Eo(),M=a(C);De(M,{type:"button",variant:"ghost",size:"icon",onclick:()=>u(y,!e(y)),get disabled(){return e(s)},class:"h-8 w-8",title:"Select relays",children:(fe,he)=>{var ye=ve(),Me=B(ye);{var ke=we=>{var Ne=ko();Xe(Ne,21,()=>e(i),nt,(Qe,Ze)=>{const Ue=K(()=>e(n).find(Ie=>Ie.url===e(Ze))),Se=K(()=>e(Ue)?gt(e(Ue).url):null);var He=ve(),tt=B(He);{var ct=Ie=>{var Je=yo();W(()=>Be(Je,"src",e(Se).info.icon)),o(Ie,Je)},Ve=Ie=>{var Je=wo(),Nt=a(Je);We(Nt,{name:"relay",size:"xs",class:"text-muted-foreground"}),r(Je),o(Ie,Je)};A(tt,Ie=>{e(Se)?.info?.icon?Ie(ct):Ie(Ve,!1)})}o(Qe,He)}),r(Ne),o(we,Ne)},Pe=we=>{var Ne=Co(),Qe=a(Ne);We(Qe,{name:"relay",size:"md"});var Ze=l(Qe,2);{var Ue=Se=>{var He=Po(),tt=a(He,!0);r(He),W(()=>re(tt,e(i).length)),o(Se,He)};A(Ze,Se=>{e(i).length>2&&Se(Ue)})}r(Ne),o(we,Ne)};A(Me,we=>{e(i).length<=2&&e(i).length>0?we(ke):we(Pe,!1)})}o(fe,ye)},$$slots:{default:!0}});var ee=l(M,2);{var ce=fe=>{var he=Ro();he.__click=R,he.__keydown=ke=>ke.key==="Escape"&&R();var ye=a(he);ye.__click=ke=>ke.stopPropagation(),ye.__keydown=ke=>ke.stopPropagation();var Me=a(ye);ht(Me,{get selectedRelayUrls(){return e(i)},onToggleRelay:x,onSelectOnly:T,get isProtected(){return e(w)},set isProtected(ke){u(w,ke,!0)}}),r(ye),r(he),Ge(he,ke=>it?.(ke)),o(fe,he)};A(ee,fe=>{e(y)&&fe(ce)})}r(C),o(c,C)};let te=K(()=>t.replyTo?"Write your reply...":t.quotedEvent?"Add your thoughts...":"What's on your mind?");at(_t(de,{get placeholder(){return e(te)},autofocus:!0,get disabled(){return e(s)},class:"flex-1 overflow-hidden",get value(){return e(f)},set value(c){u(f,c,!0)},get selectedMentions(){return e(m)},set selectedMentions(c){u(m,c,!0)},relayButton:V,$$slots:{relayButton:!0}}),c=>h=c,()=>h)}r(Q),r(H);var _e=l(H,2);{var ae=V=>{var te=Mo(),c=l(a(te),2),C=a(c);kt(C,{get event(){return t.quotedEvent},showActions:!1}),r(c),r(te),o(V,te)};A(_e,V=>{t.quotedEvent&&V(ae)})}Ce(2),o(z,$)},$$slots:{default:!0}})}),o(le,S)},$$slots:{default:!0}})}),o(F,L)};A(_,F=>{d.current?F(I):F(q,!1)})}o(Y,ne),Te()}Le(["click","keydown"]);var Ao=k('<div class="absolute inset-0 bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity"></div> <div class="relative flex flex-col items-center gap-2"><span class="text-2xl"> </span> <span> </span></div>',1),zo=k('<div class="p-4 rounded-2xl bg-primary/20 border-2 border-primary/30"><div class="flex items-center justify-between"><span class="text-sm text-foreground/70">Selected Amount:</span> <span class="text-2xl font-bold text-foreground"> </span></div></div>'),To=k('<span class="text-xl mr-2">⚡</span> ',1),jo=k("<!> <!>",1),No=k('<div class="relative -mx-6 -mt-6 px-6 py-6 mb-6 border-b border-border bg-primary/10"><div class="absolute inset-0 bg-primary/5 blur-xl"></div> <div class="relative flex items-center gap-3"><div class="w-12 h-12 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-primary/50"><span class="text-2xl">⚡</span></div> <div><!> <!></div></div></div> <div class="space-y-6"><div class="grid grid-cols-4 gap-3"></div> <div class="space-y-2"><!> <div class="relative"><!> <div class="absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold">sats</div></div></div> <!> <!></div>',1),Uo=k('<div class="absolute inset-0 bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity"></div> <div class="relative flex flex-col items-center gap-2"><span class="text-2xl"> </span> <span> </span></div>',1),Io=k('<div class="p-4 rounded-2xl bg-primary/20 border-2 border-primary/30"><div class="flex items-center justify-between"><span class="text-sm text-foreground/70">Selected Amount:</span> <span class="text-2xl font-bold text-foreground"> </span></div></div>'),Lo=k('<span class="text-xl mr-2">⚡</span> ',1),Do=k('<div class="flex gap-3"><!> <!></div>'),Bo=k('<div class="relative px-6 py-6 mb-6 border-b border-border bg-primary/10"><div class="absolute inset-0 bg-primary/5 blur-xl"></div> <div class="relative flex items-center gap-3"><div class="w-12 h-12 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-primary/50"><span class="text-2xl">⚡</span></div> <div><!> <!></div></div></div> <div class="space-y-6 px-4"><div class="grid grid-cols-4 gap-3"></div> <div class="space-y-2"><!> <div class="relative"><!> <div class="absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold">sats</div></div></div> <!></div> <!>',1);function Fo(Y,t){ze(t,!0);const d=new Rt("(min-width: 768px)");let p=se(t,"open",15,!1);const f=[{value:10,label:"10",emoji:"☕"},{value:21,label:"21",emoji:"⚡"},{value:50,label:"50",emoji:"🤙"},{value:100,label:"100",emoji:"💯"},{value:500,label:"500",emoji:"🔥"},{value:1e3,label:"1K",emoji:"💎"},{value:2100,label:"2.1K",emoji:"🚀"},{value:5e3,label:"5K",emoji:"👑"}];let s=ue(Oe(rt.zap.defaultAmount)),y=ue(""),w=ue(!1);function m(T){u(s,T,!0),u(w,!1),u(y,"")}function h(){u(w,!0);const T=Number.parseInt(e(y));!Number.isNaN(T)&&T>0&&u(s,T,!0)}function g(){e(s)>0&&t.onZap(e(s))}function b(T){T.key==="Enter"&&e(s)>0&&g()}var i=ve();qe("keydown",vt,b);var n=B(i);{var v=T=>{var R=ve(),P=B(R);pe(P,()=>St,(Z,ne)=>{ne(Z,{get open(){return p()},onOpenChange:_=>{_?p(!0):t.onCancel()},children:(_,I)=>{var q=ve(),F=B(q);pe(F,()=>Et,(L,E)=>{E(L,{class:"max-w-md bg-background border-2 border-primary/30 shadow-2xl shadow-primary/50",children:(j,me)=>{var le=No(),D=B(le),S=l(a(D),2),U=l(a(S),2),O=a(U);pe(O,()=>Mt,(H,Q)=>{Q(H,{class:"text-xl text-foreground",children:(de,_e)=>{Ce();var ae=Ae("Zap Amount");o(de,ae)},$$slots:{default:!0}})});var G=l(O,2);pe(G,()=>Gt,(H,Q)=>{Q(H,{class:"text-sm text-muted-foreground",children:(de,_e)=>{Ce();var ae=Ae("Choose your zap amount");o(de,ae)},$$slots:{default:!0}})}),r(U),r(S),r(D);var z=l(D,2),N=a(z);Xe(N,21,()=>f,nt,(H,Q)=>{{let de=K(()=>e(s)===e(Q).value&&!e(w)?"bg-primary shadow-lg shadow-primary/50 scale-105":"bg-muted hover:bg-muted/80 hover:scale-105");De(H,{variant:"ghost",onclick:()=>m(e(Q).value),get class(){return`group relative overflow-hidden rounded-2xl p-4 h-auto transition-all duration-200 ${e(de)??""}`},children:(_e,ae)=>{var V=Ao(),te=l(B(V),2),c=a(te),C=a(c,!0);r(c);var M=l(c,2),ee=a(M,!0);r(M),r(te),W(()=>{re(C,e(Q).emoji),Re(M,1,`text-xs font-bold ${e(s)===e(Q).value&&!e(w)?"text-primary-foreground":"text-foreground"}`),re(ee,e(Q).label)}),o(_e,V)},$$slots:{default:!0}})}}),r(N);var $=l(N,2),ie=a($);bt(ie,{for:"custom-amount",class:"text-sm font-semibold text-muted-foreground",children:(H,Q)=>{Ce();var de=Ae("Custom Amount");o(H,de)},$$slots:{default:!0}});var X=l(ie,2),J=a(X);{let H=K(()=>e(w)?"border-primary":"border-border");mt(J,{id:"custom-amount",type:"number",oninput:h,placeholder:"Enter custom amount...",get class(){return`w-full px-4 py-4 bg-muted border-2 ${e(H)??""} rounded-2xl text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-primary transition-colors text-lg font-semibold pr-16`},get value(){return e(y)},set value(Q){u(y,Q,!0)}})}Ce(2),r(X),r($);var oe=l($,2);{var be=H=>{var Q=zo(),de=a(Q),_e=l(a(de),2),ae=a(_e);r(_e),r(de),r(Q),W(V=>re(ae,`${V??""} sats`),[()=>e(s).toLocaleString()]),o(H,Q)};A(oe,H=>{e(s)>0&&H(be)})}var xe=l(oe,2);pe(xe,()=>tr,(H,Q)=>{Q(H,{class:"flex gap-3 sm:space-x-0",children:(de,_e)=>{var ae=jo(),V=B(ae);De(V,{variant:"outline",get onclick(){return t.onCancel},class:"flex-1 px-6 py-4 rounded-2xl",children:(c,C)=>{Ce();var M=Ae("Cancel");o(c,M)},$$slots:{default:!0}});var te=l(V,2);{let c=K(()=>e(s)<=0);De(te,{onclick:g,get disabled(){return e(c)},class:"flex-1 px-6 py-4 rounded-2xl bg-primary hover:opacity-90 shadow-lg shadow-primary/50 hover:shadow-primary/70 disabled:opacity-50 disabled:shadow-none",children:(C,M)=>{var ee=To(),ce=l(B(ee));W(fe=>re(ce,` Zap ${fe??""}`),[()=>e(s)>0?e(s).toLocaleString():""]),o(C,ee)},$$slots:{default:!0}})}o(de,ae)},$$slots:{default:!0}})}),r(z),o(j,le)},$$slots:{default:!0}})}),o(_,q)},$$slots:{default:!0}})}),o(T,R)},x=T=>{var R=ve(),P=B(R);pe(P,()=>Tt,(Z,ne)=>{ne(Z,{get open(){return p()},onOpenChange:_=>{_?p(!0):t.onCancel()},children:(_,I)=>{var q=ve(),F=B(q);pe(F,()=>At,(L,E)=>{E(L,{children:(j,me)=>{var le=Bo(),D=B(le),S=l(a(D),2),U=l(a(S),2),O=a(U);pe(O,()=>zt,(H,Q)=>{Q(H,{class:"text-xl text-foreground",children:(de,_e)=>{Ce();var ae=Ae("Zap Amount");o(de,ae)},$$slots:{default:!0}})});var G=l(O,2);pe(G,()=>$t,(H,Q)=>{Q(H,{class:"text-sm text-muted-foreground",children:(de,_e)=>{Ce();var ae=Ae("Choose your zap amount");o(de,ae)},$$slots:{default:!0}})}),r(U),r(S),r(D);var z=l(D,2),N=a(z);Xe(N,21,()=>f,nt,(H,Q)=>{{let de=K(()=>e(s)===e(Q).value&&!e(w)?"bg-primary shadow-lg shadow-primary/50 scale-105":"bg-muted hover:bg-muted/80 hover:scale-105");De(H,{variant:"ghost",onclick:()=>m(e(Q).value),get class(){return`group relative overflow-hidden rounded-2xl p-4 h-auto transition-all duration-200 ${e(de)??""}`},children:(_e,ae)=>{var V=Uo(),te=l(B(V),2),c=a(te),C=a(c,!0);r(c);var M=l(c,2),ee=a(M,!0);r(M),r(te),W(()=>{re(C,e(Q).emoji),Re(M,1,`text-xs font-bold ${e(s)===e(Q).value&&!e(w)?"text-primary-foreground":"text-foreground"}`),re(ee,e(Q).label)}),o(_e,V)},$$slots:{default:!0}})}}),r(N);var $=l(N,2),ie=a($);bt(ie,{for:"custom-amount",class:"text-sm font-semibold text-muted-foreground",children:(H,Q)=>{Ce();var de=Ae("Custom Amount");o(H,de)},$$slots:{default:!0}});var X=l(ie,2),J=a(X);{let H=K(()=>e(w)?"border-primary":"border-border");mt(J,{id:"custom-amount",type:"number",oninput:h,placeholder:"Enter custom amount...",get class(){return`w-full px-4 py-4 bg-muted border-2 ${e(H)??""} rounded-2xl text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-primary transition-colors text-lg font-semibold pr-16`},get value(){return e(y)},set value(Q){u(y,Q,!0)}})}Ce(2),r(X),r($);var oe=l($,2);{var be=H=>{var Q=Io(),de=a(Q),_e=l(a(de),2),ae=a(_e);r(_e),r(de),r(Q),W(V=>re(ae,`${V??""} sats`),[()=>e(s).toLocaleString()]),o(H,Q)};A(oe,H=>{e(s)>0&&H(be)})}r(z);var xe=l(z,2);pe(xe,()=>er,(H,Q)=>{Q(H,{class:"pt-2",children:(de,_e)=>{var ae=Do(),V=a(ae);De(V,{variant:"outline",get onclick(){return t.onCancel},class:"flex-1 px-6 py-4 rounded-2xl",children:(c,C)=>{Ce();var M=Ae("Cancel");o(c,M)},$$slots:{default:!0}});var te=l(V,2);{let c=K(()=>e(s)<=0);De(te,{onclick:g,get disabled(){return e(c)},class:"flex-1 px-6 py-4 rounded-2xl bg-primary hover:opacity-90 shadow-lg shadow-primary/50 hover:shadow-primary/70 disabled:opacity-50 disabled:shadow-none",children:(C,M)=>{var ee=Lo(),ce=l(B(ee));W(fe=>re(ce,` Zap ${fe??""}`),[()=>e(s)>0?e(s).toLocaleString():""]),o(C,ee)},$$slots:{default:!0}})}r(ae),o(de,ae)},$$slots:{default:!0}})}),o(j,le)},$$slots:{default:!0}})}),o(_,q)},$$slots:{default:!0}})}),o(T,R)};A(n,T=>{d.current?T(v):T(x,!1)})}o(Y,i),Te()}var Ko=Ke('<svg class="w-6 h-6 animate-spin text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>'),Zo=Ke('<path d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Wo=Ke('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Qo=Ke('<svg stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),Ho=k('<button type="button"><div><!></div> <span class="text-xs font-semibold text-white"><!></span></button>'),qo=Ke('<svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>'),Oo=Ke('<svg class="w-5 h-5 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>'),Vo=Ke('<path d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Yo=Ke('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Xo=Ke('<svg class="w-5 h-5" stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),Jo=k('<span class="text-xs opacity-70"> </span>'),Go=k(" <!>",1),$o=k('<button type="button"><!> <span class="text-sm group-hover:underline"><!></span></button>'),ea=k("<!> <!>",1);function wt(Y,t){ze(t,!0);const d=se(t,"variant",3,"default"),p=ge.$zaps(()=>({target:t.event,validated:!0})),f=K(()=>{const _=ge.$currentPubkey;return _?qt(p.events,_):!1}),s=K(()=>{const _=p.totalAmount;return _>=1e6?`${(_/1e6).toFixed(1)}M`:_>=1e3?`${(_/1e3).toFixed(1)}K`:_.toString()});let y=ue(!1),w=ue(!1),m=ue(!1),h=null;async function g(_){if(!ge.signer){Ee.error("Please login to zap");return}u(w,!0);try{await new Ht(t.event,_*1e3,"msat").zap(),u(m,!0),setTimeout(()=>u(m,!1),2e3),Ee.success(`Zapped ${_} sats!`)}catch(I){console.error("Failed to zap:",I);const q=I instanceof Error?I.message:"Failed to send zap";q.includes("wallet")||q.includes("NWC")?Ee.error("Lightning wallet error. Please check your wallet connection in settings."):q.includes("invoice")?Ee.error("Failed to create invoice. The recipient may not have a Lightning address configured."):Ee.error("Failed to send zap. Please try again.")}finally{u(w,!1)}}async function b(_){_.stopPropagation(),!(e(w)||!ge.signer)&&await g(rt.zap.defaultAmount)}function i(_){u(y,!1),g(_)}function n(_){_.preventDefault(),_.stopPropagation(),h=setTimeout(()=>{u(y,!0),h=null},500)}function v(_){h&&(clearTimeout(h),h=null,(_.type==="mouseup"||_.type==="touchend")&&b(_))}function x(){h&&(clearTimeout(h),h=null)}var T=ea(),R=B(T);{var P=_=>{var I=Ho();I.__mousedown=n,I.__mouseup=v,I.__touchstart=n,I.__touchend=v;var q=a(I),F=a(q);{var L=S=>{var U=Ko();o(S,U)},E=S=>{var U=Qo(),O=a(U);{var G=N=>{var $=Zo();o(N,$)},z=N=>{var $=Wo();o(N,$)};A(O,N=>{e(f)?N(G):N(z,!1)})}r(U),W(()=>{Re(U,0,`w-6 h-6 transition-colors ${e(f)?"text-yellow-400":"text-white"}`),Be(U,"fill",e(f)?"currentColor":"none")}),o(S,U)};A(F,S=>{e(w)?S(L):S(E,!1)})}r(q);var j=l(q,2),me=a(j);{var le=S=>{var U=Ae();W(()=>re(U,e(s))),o(S,U)},D=S=>{var U=Ae("Zap");o(S,U)};A(me,S=>{p.totalAmount>0?S(le):S(D,!1)})}r(j),r(I),W(()=>{I.disabled=e(w),Re(I,1,`flex flex-col items-center gap-1 hover:scale-110 transition-transform group ${e(w)?"opacity-50 cursor-wait":""}`),Re(q,1,`w-12 h-12 rounded-full backdrop-blur-sm flex items-center justify-center transition-colors ${e(m)?"bg-yellow-400/30":e(f)?"bg-yellow-400/20":"bg-white/20"}`)}),qe("mouseleave",I,x),qe("touchcancel",I,x),o(_,I)},Z=_=>{var I=$o();I.__mousedown=n,I.__mouseup=v,I.__touchstart=n,I.__touchend=v;var q=a(I);{var F=D=>{var S=qo();o(D,S)},L=D=>{var S=ve(),U=B(S);{var O=z=>{var N=Oo();o(z,N)},G=z=>{var N=Xo(),$=a(N);{var ie=J=>{var oe=Vo();o(J,oe)},X=J=>{var oe=Yo();o(J,oe)};A($,J=>{e(f)?J(ie):J(X,!1)})}r(N),W(()=>Be(N,"fill",e(f)?"currentColor":"none")),o(z,N)};A(U,z=>{e(m)?z(O):z(G,!1)},!0)}o(D,S)};A(q,D=>{e(w)?D(F):D(L,!1)})}var E=l(q,2),j=a(E);{var me=D=>{var S=Ae("Zapped!");o(D,S)},le=D=>{var S=ve(),U=B(S);{var O=z=>{var N=Ae("Zapping...");o(z,N)},G=z=>{var N=ve(),$=B(N);{var ie=J=>{var oe=Go(),be=B(oe),xe=l(be);{var H=Q=>{var de=Jo(),_e=a(de);r(de),W(()=>re(_e,`(${p.count??""})`)),o(Q,de)};A(xe,Q=>{p.count>0&&Q(H)})}W(()=>re(be,`${e(s)??""} `)),o(J,oe)},X=J=>{var oe=Ae("Zap");o(J,oe)};A($,J=>{p.totalAmount>0?J(ie):J(X,!1)},!0)}o(z,N)};A(U,z=>{e(w)?z(O):z(G,!1)},!0)}o(D,S)};A(j,D=>{e(m)?D(me):D(le,!1)})}r(E),r(I),W(()=>{I.disabled=e(w),Re(I,1,`relative flex items-center gap-2 transition-colors group ${e(m)||e(f)?"text-yellow-400":"text-muted-foreground hover:text-yellow-400"} ${e(w)?"opacity-50 cursor-wait":""}`)}),qe("mouseleave",I,x),qe("touchcancel",I,x),o(_,I)};A(R,_=>{d()==="tiktok"?_(P):_(Z,!1)})}var ne=l(R,2);Fo(ne,{get event(){return t.event},onZap:i,onCancel:()=>u(y,!1),get open(){return e(y)},set open(_){u(y,_,!0)}}),o(Y,T),Te()}Le(["mousedown","mouseup","touchstart","touchend"]);function ta(Y,t){const d=rr(t);let p=ue(null);const f=new st;Fe(()=>{const{event:h}=Y();if(!h?.id){u(p,null);return}u(p,d.$subscribe(()=>({filters:[{kinds:[Ct.Reaction],...h.filter()}],subId:"reactions"})),!0)});const s=K(()=>{const g=e(p)?.events||[],b=new st;for(const i of g){const n=i.content,v=b.get(n)||{count:0,hasReacted:!1,pubkeys:[]};v.count++;const x=i.tags.find(T=>T[0]==="emoji");x&&x[1]&&x[2]&&(v.shortcode=x[1],v.url=x[2]),v.pubkeys.includes(i.pubkey)||v.pubkeys.push(i.pubkey),i.pubkey===d.$currentPubkey&&(v.hasReacted=!0,v.userReaction=i),b.set(n,v)}for(const[i,{event:n}]of f.entries()){const v=b.get(i)||{count:0,hasReacted:!1,pubkeys:[]},x=n.tags.find(T=>T[0]==="emoji");x&&x[1]&&x[2]&&(v.shortcode=x[1],v.url=x[2]),v.hasReacted||(v.count++,v.hasReacted=!0,v.pubkeys.includes(d.$currentPubkey)||v.pubkeys.push(d.$currentPubkey),v.userReaction=n),b.set(i,v)}return Array.from(b.entries()).map(([i,n])=>({emoji:i,...n})).sort((i,n)=>n.count-i.count)});async function y(h){const{event:g,delayed:b}=Y();if(!g?.id)throw new Error("No event to react to");if(!d.$currentPubkey)throw new Error("User must be logged in to react");const i=typeof h=="string"?h:h.emoji,n=f.get(i);if(n){clearTimeout(n.timer),f.delete(i);return}const v=e(s).find(T=>T.emoji===i);if(v?.hasReacted&&v.userReaction){await v.userReaction.delete();return}const x=await g.react(i,!1);if(typeof h!="string"&&h.shortcode&&h.url&&x.tags.push(["emoji",h.shortcode,h.url]),b&&b>0){const T=setTimeout(async()=>{await x.publish(),f.delete(i)},b*1e3);f.set(i,{timer:T,event:x})}else await x.publish()}function w(h){return e(s).find(g=>g.emoji===h)}const m=K(()=>e(s).reduce((h,g)=>h+g.count,0));return{get all(){return e(s)},get totalCount(){return e(m)},get:w,react:y}}var ra=k('<span class="text-sm font-medium"> </span>'),oa=k('<button data-reaction-button=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" color="currentColor"><path d="M10.4107 19.9677C7.58942 17.858 2 13.0348 2 8.69444C2 5.82563 4.10526 3.5 7 3.5C8.5 3.5 10 4 12 6C14 4 15.5 3.5 17 3.5C19.8947 3.5 22 5.82563 22 8.69444C22 13.0348 16.4106 17.858 13.5893 19.9677C12.6399 20.6776 11.3601 20.6776 10.4107 19.9677Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg> <!></button>');function aa(Y,t){ze(t,!0);let d=se(t,"variant",3,"ghost"),p=se(t,"emoji",3,"❤️"),f=se(t,"showCount",3,!0),s=se(t,"countMode",3,"total"),y=se(t,"class",3,"");const w=et("ndk"),m=t.ndk||w,h=ta(()=>({event:t.event}),m),g=K(()=>h?.get(p())??{count:0,hasReacted:!1,pubkeys:[],emoji:p()}),b=K(()=>s()==="total"?h.totalCount:e(g).count);function i(){h.react(p()),t.onclick?.()}var n=oa();n.__click=i;var v=a(n),x=l(v,2);{var T=R=>{var P=ra(),Z=a(P,!0);r(P),W(()=>re(Z,e(b))),o(R,P)};A(x,R=>{f()&&e(b)>0&&R(T)})}r(n),W((R,P)=>{Be(n,"data-reacted",e(g).hasReacted?"":void 0),Be(n,"data-variant",d()),Re(n,1,R),Be(n,"aria-label",`React (${e(b)})`),Re(v,0,P),Be(v,"fill",e(g).hasReacted?"currentColor":"none")},[()=>$e(Ye("inline-flex items-center gap-2 cursor-pointer transition-all",d()==="ghost"&&"p-2 bg-transparent border-none hover:bg-accent",d()==="outline"&&"px-3 py-2 bg-transparent border border-border rounded-md hover:bg-accent",d()==="pill"&&"px-4 py-2 bg-transparent border border-border rounded-full hover:bg-accent",d()==="solid"&&"px-4 py-2 bg-muted border border-border rounded-md hover:bg-accent",e(g).hasReacted&&"text-primary",y())),()=>$e(Ye("flex-shrink-0",e(g).hasReacted&&"animate-[heartbeat_0.3s_ease-in-out]"))]),o(Y,n),Te()}Le(["click"]);var na=k('<div class="absolute bottom-full mb-2 right-0 bg-popover border border-border rounded-lg shadow-xl z-50 min-w-[180px] overflow-hidden"><button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <div><div class="font-medium">Repost</div> <div class="text-xs text-muted-foreground">Share instantly</div></div></button> <button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3 border-t border-border"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <div><div class="font-medium">Quote</div> <div class="text-xs text-muted-foreground">Add your thoughts</div></div></button></div>'),sa=k('<div class="flex flex-col items-center gap-6 text-white"><button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div class="w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center"><!></div> <span class="text-xs font-semibold"> </span></button> <div class="relative"><button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div class="w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center"><!></div> <span class="text-xs font-semibold"> </span></button> <!></div> <button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div><!></div> <span class="text-xs font-semibold"> </span></button> <!></div>'),la=k('<div class="absolute bottom-full mb-2 left-0 bg-popover border border-border rounded-lg shadow-xl z-50 min-w-[180px] overflow-hidden"><button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3"><!> <div><div class="font-medium">Repost</div> <div class="text-xs text-muted-foreground">Share instantly</div></div></button> <button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3 border-t border-border"><!> <div><div class="font-medium">Quote</div> <div class="text-xs text-muted-foreground">Add your thoughts</div></div></button></div>'),ia=k('<div><button type="button" class="flex items-center gap-2 hover:text-primary transition-colors group"><!> <span class="text-sm group-hover:underline"> </span></button> <div class="relative"><button type="button" class="flex items-center gap-2 hover:text-green-400 transition-colors group"><!> <span class="text-sm group-hover:underline"> </span></button> <!></div> <!> <!></div>'),da=k("<!> <!> <!>",1);function ca(Y,t){ze(t,!0);const d=se(t,"variant",3,"default");let p=ue(!1),f=ue(!1),s=ue(!1);const y=ge.$subscribe(()=>({filters:[{kinds:[1,1111,6,16],...t.event.filter()}],subId:"interactions"})),w=K(()=>Array.from(y.events??[]).filter(P=>P.kind===1||P.kind===1111).length),m=K(()=>Array.from(y.events??[]).filter(P=>P.kind===6||P.kind===16).length),h=K(()=>d()!=="tiktok"?null:or(()=>({event:t.event}),ge)),g=K(()=>e(h)?e(h).get("❤️")??{count:0,hasReacted:!1,pubkeys:[],emoji:"❤️"}:{count:0,hasReacted:!1});async function b(){if(!ge.signer){Ee.error("Please login to repost");return}try{await t.event.repost(),Ee.success("Note reposted")}catch(P){console.error("Failed to repost:",P),Ee.error("Failed to repost")}}var i=da(),n=B(i);{var v=P=>{var Z=sa(),ne=a(Z);ne.__click=X=>{X.stopPropagation(),u(p,!0)};var _=a(ne),I=a(_);We(I,{name:"message",size:"lg"}),r(_);var q=l(_,2),F=a(q,!0);r(q),r(ne);var L=l(ne,2),E=a(L);E.__click=X=>{X.stopPropagation(),u(s,!e(s))};var j=a(E),me=a(j);We(me,{name:"repost",size:"lg"}),r(j);var le=l(j,2),D=a(le,!0);r(le),r(E);var S=l(E,2);{var U=X=>{var J=na();J.__click=xe=>xe.stopPropagation();var oe=a(J);oe.__click=xe=>{xe.stopPropagation(),u(s,!1),b()};var be=l(oe,2);be.__click=xe=>{xe.stopPropagation(),u(s,!1),u(f,!0)},r(J),Ge(J,(xe,H)=>lt?.(xe,H),()=>()=>u(s,!1)),o(X,J)};A(S,X=>{e(s)&&X(U)})}r(L);var O=l(L,2);O.__click=X=>{X.stopPropagation(),e(h)&&e(h).react("❤️").catch(J=>{console.error("Failed to react:",J),Ee.error("Failed to add reaction")})};var G=a(O),z=a(G);{let X=K(()=>e(g).hasReacted?"animate-[heartbeat_0.3s_ease-in-out]":"");We(z,{name:"heart-filled",size:"lg",get class(){return e(X)}})}r(G);var N=l(G,2),$=a(N,!0);r(N),r(O);var ie=l(O,2);wt(ie,{get event(){return t.event},variant:"tiktok"}),r(Z),W(()=>{re(F,e(w)),re(D,e(m)),Re(G,1,`w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-red-400 transition-colors ${e(g).hasReacted?"bg-red-400/30":""}`),re($,e(g).count)}),o(P,Z)},x=P=>{var Z=ia(),ne=a(Z);ne.__click=O=>{O.stopPropagation(),u(p,!0)};var _=a(ne);We(_,{name:"message",size:"md"});var I=l(_,2),q=a(I,!0);r(I),r(ne);var F=l(ne,2),L=a(F);L.__click=O=>{O.stopPropagation(),u(s,!e(s))};var E=a(L);We(E,{name:"repost",size:"md"});var j=l(E,2),me=a(j,!0);r(j),r(L);var le=l(L,2);{var D=O=>{var G=la();G.__click=X=>X.stopPropagation();var z=a(G);z.__click=X=>{X.stopPropagation(),u(s,!1),b()};var N=a(z);We(N,{name:"repost",size:"md"}),Ce(2),r(z);var $=l(z,2);$.__click=X=>{X.stopPropagation(),u(s,!1),u(f,!0)};var ie=a($);We(ie,{name:"message",size:"md"}),Ce(2),r($),r(G),Ge(G,(X,J)=>lt?.(X,J),()=>()=>u(s,!1)),o(O,G)};A(le,O=>{e(s)&&O(D)})}r(F);var S=l(F,2);aa(S,{get event(){return t.event},emoji:"❤️",class:"hover:text-red-400 transition-colors group [&>span]:text-sm [&>span]:group-hover:underline"});var U=l(S,2);wt(U,{get event(){return t.event}}),r(Z),W(()=>{Re(Z,1,`flex items-center gap-3 sm:gap-6 ${d()==="thread-main"?"border-t border-border pt-3":""} text-muted-foreground`),re(q,e(w)),re(me,e(m))}),o(P,Z)};A(n,P=>{d()==="tiktok"?P(v):P(x,!1)})}var T=l(n,2);yt(T,{get replyTo(){return t.event},get open(){return e(p)},set open(P){u(p,P,!0)}});var R=l(T,2);yt(R,{get quotedEvent(){return t.event},get open(){return e(f)},set open(P){u(f,P,!0)}}),o(Y,i),Te()}Le(["click"]);var ua=k('<div><!></div> <!> <div class="mb-2"><!></div> <!>',1);function kt(Y,t){const d=se(t,"showActions",3,!0),p=se(t,"variant",3,"default");se(t,"showThreadLine",3,!1);const f=K(()=>p()==="thread-main"?"lg":p()==="thread-reply"?"md":"sm"),s=K(()=>p()==="thread-main"?"text-lg leading-relaxed":"text-base"),y=K(()=>p()==="thread-main"?"bg-card/50":(p()==="default","hover:bg-card/30")),w=K(()=>p()==="default"||t.onNavigate!==void 0),m=K(()=>p()==="thread-main"?"full":"compact"),h=K(()=>p()==="thread-main"?"mb-2":"mb-1.5");var g=ve(),b=B(g);pe(b,()=>ut.Root,(i,n)=>{n(i,{get ndk(){return ge},get event(){return t.event},get interactive(){return e(w)},get onclick(){return t.onNavigate},get class(){return`p-3 sm:p-4 flex flex-col max-sm:max-w-screen ${e(y)??""} transition-colors min-w-0`},children:(v,x)=>{var T=ua(),R=B(T),P=a(R);pe(P,()=>ut.Header,(L,E)=>{E(L,{get variant(){return e(m)},get avatarSize(){return e(f)}})}),r(R);var Z=l(R,2);{var ne=L=>{};A(Z,L=>{p()==="default"&&L(ne)})}var _=l(Z,2),I=a(_);pe(I,()=>ut.Content,(L,E)=>{E(L,{get class(){return e(s)}})}),r(_);var q=l(_,2);{var F=L=>{ca(L,{get event(){return t.event},get variant(){return p()}})};A(q,L=>{d()&&L(F)})}W(()=>Re(R,1,$e(e(h)))),o(v,T)},$$slots:{default:!0}})}),o(Y,g)}export{yt as C,ca as E,kt as N,aa as R,Xr as U,ut as a,_t as b,dr as c,nr as g,io as u};
