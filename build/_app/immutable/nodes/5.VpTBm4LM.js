import"../chunks/DsnmJJEf.js";import{d as Mt,p as st,b as me,K as jt,u as et,g as e,s as u,i,j as o,k as a,r as t,e as r,h as nt,f as k,a as H,t as E,l as M,c as fe,L as p,aP as ue,M as Be}from"../chunks/Bq750rDx.js";import{i as b}from"../chunks/BcjopvHb.js";import{e as Qe,i as zt}from"../chunks/Cjcfrngr.js";import{n as ke,s as Ve,k as _t,f as Rt,h as Dt,e as bt}from"../chunks/CdRP5_sk.js";import{h as pt}from"../chunks/jsJqZDHS.js";import{c as gt,N as Nt}from"../chunks/C_GCMw-M.js";import{c as yt,b as wt,a as ht,r as rt,h as kt}from"../chunks/uSFILAY7.js";import{A as xt}from"../chunks/Bt6DpIqu.js";import{g as $t}from"../chunks/DAOE6Nme.js";import{f as Bt}from"../chunks/KSN4Ur19.js";import{c as we}from"../chunks/BRAzWB6r.js";import{a as At}from"../chunks/BKrWP4DR.js";import{a as Pt}from"../chunks/BTSVJW8r.js";import{p as Lt}from"../chunks/BL6J_geM.js";import{u as at}from"../chunks/BKSKCJuW.js";import{c as It}from"../chunks/a7XEC-kH.js";import{g as St,a as Tt,b as Ut,e as Et}from"../chunks/BSM2-0iS.js";import{M as Ot,b as Wt,c as Yt,d as Gt,R as Ht,e as Kt,f as Ft,g as Jt,h as Vt}from"../chunks/Dw4s2o4Z.js";import{D as Qt,a as qt}from"../chunks/C7FVrkeR.js";import{D as Xt}from"../chunks/DtjL0N-6.js";import{I as Ye,B as Ne}from"../chunks/DMhdcQZj.js";import{L as Ge,T as Ct}from"../chunks/BoTf7nuy.js";import{R as ot}from"../chunks/DoEkGPLs.js";import{D as Zt}from"../chunks/CHVQ8-IN.js";import{P as er}from"../chunks/BzopvNlH.js";var tr=i('<p class="text-muted-foreground text-center py-8">No invites yet in this Agora</p>'),rr=i('<p class="text-xs text-muted-foreground truncate"> </p>'),ar=i('<a class="relative bg-gradient-to-b from-primary/5 to-transparent border border-border rounded-xl p-6 hover:border-primary/50 transition-all hover:shadow-lg group"><div class="absolute -top-3 left-1/2 -translate-x-1/2"><div class="w-12 h-12 rounded-full bg-card border-2 border-border flex items-center justify-center text-2xl group-hover:border-primary transition-colors"> </div></div> <div class="flex justify-center mt-6 mb-4"><!></div> <div class="text-center mb-4"><h3 class="font-bold text-lg text-foreground truncate mb-1"> </h3> <!></div> <div class="bg-muted/50 rounded-lg p-3"><div class="text-center"><div class="text-3xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground"> </div></div></div> <div class="mt-3"><div class="h-1.5 bg-muted rounded-full overflow-hidden"><div class="h-full bg-gradient-to-r from-primary to-primary/60 transition-all duration-500"></div></div></div></a>'),or=i('<button class="w-full flex items-center justify-center gap-2 py-3 text-sm font-medium text-primary hover:text-primary/80 transition-colors"><span> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>'),sr=i('<a class="flex items-center gap-4 p-3 rounded-lg hover:bg-muted/50 transition-colors"><div class="flex items-center gap-3 flex-1"><span class="text-lg font-semibold text-muted-foreground w-8"> </span> <!> <div class="flex-1 min-w-0"><div class="font-medium text-foreground truncate"> </div> <div class="text-sm text-muted-foreground"> </div></div></div> <div class="hidden md:block w-32"><div class="h-2 bg-muted rounded-full overflow-hidden"><div class="h-full bg-gradient-to-r from-primary to-primary/60 transition-all duration-500"></div></div></div></a>'),nr=i('<div class="mt-4 space-y-2 border-t border-border pt-4"></div>'),ir=i('<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6"></div> <!> <!>',1),lr=i('<div><h2 class="text-xl font-bold text-foreground mb-6">üèÜ Top Inviters</h2> <!></div>');function dr(Le,B){st(B,!0);let K=me(!1);function Q(j){return j===1?"ü•á":j===2?"ü•à":j===3?"ü•â":""}const re=H(()=>B.stats.slice(0,3)),F=H(()=>B.stats.slice(3,10)),R=H(()=>Math.max(...B.stats.map(j=>j.successfulInvites),1));let P=me(jt(new Map));et(()=>{e(P).clear(),B.stats.forEach(j=>{ke.fetchUser(j.pubkey).then(n=>{n?.fetchProfile().then(f=>{e(P).set(j.pubkey,f||null),u(P,new Map(e(P)),!0)})})})});var J=lr(),de=o(a(J),2);{var te=j=>{var n=tr();r(j,n)},pe=j=>{var n=ir(),f=k(n);Qe(f,21,()=>e(re),h=>h.pubkey,(h,_)=>{const L=H(()=>e(P).get(e(_).pubkey));var D=ar(),ge=a(D),be=a(ge),Se=a(be,!0);t(be),t(ge);var I=o(ge,2),q=a(I);xt(q,{get ndk(){return ke},get pubkey(){return e(_).pubkey},class:"w-24 h-24 rounded-full ring-4 ring-primary/20"}),t(I);var c=o(I,2),A=a(c),ye=a(A,!0);t(A);var ze=o(A,2);{var Re=Ae=>{var Pe=rr(),Ke=a(Pe,!0);t(Pe),E(()=>M(Ke,e(L).nip05)),r(Ae,Pe)};b(ze,Ae=>{e(L)?.nip05&&Ae(Re)})}t(c);var z=o(c,2),De=a(z),ve=a(De),Te=a(ve,!0);t(ve);var $e=o(ve,2),ce=a($e,!0);t($e),t(De),t(z);var Ue=o(z,2),tt=a(Ue),He=a(tt);t(tt),t(Ue),t(D),E((Ae,Pe,Ke)=>{yt(D,"href",Ae),M(Se,Pe),M(ye,e(L)?.displayName||e(L)?.name||"Anonymous"),M(Te,e(_).successfulInvites),M(ce,e(_).successfulInvites===1?"person joined":"people joined"),wt(He,`width: ${Ke??""}%`)},[()=>$t(e(_).pubkey),()=>Q(e(_).rank),()=>Math.min(100,e(_).successfulInvites/e(R)*100)]),r(h,D)}),t(f);var $=o(f,2);{var w=h=>{var _=or();_.__click=()=>u(K,!e(K));var L=a(_),D=a(L,!0);t(L);var ge=o(L,2);t(_),E(()=>{M(D,e(K)?"Show Less":`View Top ${B.stats.length} Inviters`),ht(ge,0,`w-4 h-4 transition-transform duration-200 ${e(K)?"rotate-180":""}`)}),r(h,_)};b($,h=>{B.stats.length>3&&h(w)})}var y=o($,2);{var ae=h=>{var _=nr();Qe(_,21,()=>e(F),L=>L.pubkey,(L,D)=>{const ge=H(()=>e(P).get(e(D).pubkey));var be=sr(),Se=a(be),I=a(Se),q=a(I);t(I);var c=o(I,2);xt(c,{get ndk(){return ke},get pubkey(){return e(D).pubkey},class:"w-10 h-10 rounded-full"});var A=o(c,2),ye=a(A),ze=a(ye,!0);t(ye);var Re=o(ye,2),z=a(Re);t(Re),t(A),t(Se);var De=o(Se,2),ve=a(De),Te=a(ve);t(ve),t(De),t(be),E(($e,ce)=>{yt(be,"href",$e),M(q,`${e(D).rank??""}.`),M(ze,e(ge)?.displayName||e(ge)?.name||"Anonymous"),M(z,`${e(D).successfulInvites??""} ${e(D).successfulInvites===1?"person joined":"people joined"}`),wt(Te,`width: ${ce??""}%`)},[()=>$t(e(D).pubkey),()=>Math.min(100,e(D).successfulInvites/e(R)*100)]),r(L,be)}),t(_),r(h,_)};b(y,h=>{e(K)&&e(F).length>0&&h(ae)})}r(j,n)};b(de,j=>{B.stats.length===0?j(te):j(pe,!1)})}t(J),r(Le,J),nt()}Mt(["click"]);var vr=i('<div class="text-muted-foreground">Invited by <span class="font-medium text-primary"> </span></div>'),cr=i("<div></div>"),ur=i('<div class="border border-border rounded-lg p-4 hover:border-primary/50 transition-colors"><div class="flex items-center gap-3 mb-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-lg">üëã</span> <span class="font-semibold text-foreground"> </span></div> <div class="text-sm text-muted-foreground"> </div></div></div> <div class="mb-3 text-foreground whitespace-pre-wrap line-clamp-4"> </div> <div class="flex items-center justify-between text-sm"><!></div></div>');function fr(Le,B){st(B,!0);let K=me(null),Q=me(null);et(()=>{B.event.author.fetchProfile().then(h=>{u(K,h,!0)})}),et(()=>{if(!B.invitedBy){u(Q,null);return}ke.fetchUser(B.invitedBy).then(h=>{h?.fetchProfile().then(_=>{u(Q,_,!0)})})});var re=ur(),F=a(re),R=a(F);xt(R,{get ndk(){return ke},get pubkey(){return B.event.pubkey},class:"w-12 h-12 rounded-full"});var P=o(R,2),J=a(P),de=o(a(J),2),te=a(de,!0);t(de),t(J);var pe=o(J,2),j=a(pe,!0);t(pe),t(P),t(F);var n=o(F,2),f=a(n,!0);t(n);var $=o(n,2),w=a($);{var y=h=>{var _=vr(),L=o(a(_)),D=a(L);t(L),t(_),E(()=>M(D,`@${(e(Q).name||"anonymous")??""}`)),r(h,_)},ae=h=>{var _=cr();r(h,_)};b(w,h=>{e(Q)?h(y):h(ae,!1)})}t($),t(re),E(h=>{M(te,e(K)?.displayName||e(K)?.name||"Anonymous"),M(j,h),M(f,B.event.content)},[()=>Bt(B.event.created_at||0)]),r(Le,re),nt()}var mr=i("<!> <!>",1),pr=i('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1">Select Agora...</span>',1),gr=i('<!> <span class="text-sm text-muted-foreground flex-1"> </span>',1),_r=i('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1"> </span>',1),hr=i('<p class="text-sm text-muted-foreground text-center py-4">No Agora relays configured</p>'),xr=i('<div class="text-xs text-muted-foreground truncate"> </div>'),br=i('<button type="button" class="w-full flex items-center gap-3 px-3 py-2.5 hover:bg-muted cursor-pointer transition-colors text-left"><input type="checkbox" class="w-4 h-4 text-primary border rounded focus:ring-orange-500 pointer-events-none"/> <!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div></button>'),yr=i('<div class="absolute z-[60] mt-1 w-full bg-popover border border-border rounded-xl shadow-lg max-h-64 overflow-y-auto"><!></div>'),wr=i('<p class="mt-1 text-xs text-muted-foreground"> </p>'),kr=Be(`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Recipient's Name`,1),$r=Be('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> Include Cashu Token (sats)',1),Ar=i('<div class="space-y-4 border-l-4 border-primary pl-4"><div><!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">Add sats to help them get started on Nostr</p></div></div>'),Pr=i('<div class="animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-2"></div> Generating Invite...',1),Ir=i('<div><!> <!></div> <div class="relative"><label class="block text-sm font-medium text-muted-foreground mb-2">Invite to Agora</label> <button type="button" class="w-full px-4 py-2.5 text-left rounded-lg bg-muted/50 text-muted-foreground hover:bg-muted transition-colors flex items-center gap-3 group"><!> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">How many people can use this invite (1-500)</p></div> <div class="flex items-center space-x-3"><input type="checkbox" id="personalize" class="w-5 h-5 text-primary border rounded focus:ring-orange-500"/> <label for="personalize" class="text-sm font-medium text-muted-foreground cursor-pointer">Personalize this invite</label></div> <!> <!>',1),Cr=Be('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Copied!',1),Mr=Be('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> Copy',1),jr=Be('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg> Share',1),zr=i("<!> <!>",1),Rr=i('<div class="space-y-6"><div class="text-center py-8"><div class="w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <h3 class="text-lg font-semibold text-foreground mb-2">Invite Created!</h3> <p class="text-sm text-muted-foreground"> </p></div> <div class="bg-muted rounded-xl p-4 space-y-3"><div class="flex items-center space-x-2"><!> <!></div> <!></div> <!></div>'),Dr=i('<!> <div class="space-y-6"><!></div>',1),Nr=i("<!> <!>",1),Br=i('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1">Select Agora...</span>',1),Lr=i('<!> <span class="text-sm text-muted-foreground flex-1"> </span>',1),Sr=i('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1"> </span>',1),Tr=i('<p class="text-sm text-muted-foreground text-center py-4">No Agora relays configured</p>'),Ur=i('<div class="text-xs text-muted-foreground truncate"> </div>'),Er=i('<button type="button" class="w-full flex items-center gap-3 px-3 py-2.5 hover:bg-muted cursor-pointer transition-colors text-left"><input type="checkbox" class="w-4 h-4 text-primary border rounded focus:ring-orange-500 pointer-events-none"/> <!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div></button>'),Or=i('<div class="absolute z-[60] mt-1 w-full bg-popover border border-border rounded-xl shadow-lg max-h-64 overflow-y-auto"><!></div>'),Wr=i('<p class="mt-1 text-xs text-muted-foreground"> </p>'),Yr=Be(`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Recipient's Name`,1),Gr=Be('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> Include Cashu Token (sats)',1),Hr=i('<div class="space-y-4 border-l-4 border-primary pl-4"><div><!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">Add sats to help them get started on Nostr</p></div></div>'),Kr=i('<div class="animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-2"></div> Generating Invite...',1),Fr=i('<div><!> <!></div> <div class="relative"><label class="block text-sm font-medium text-muted-foreground mb-2">Invite to Agora</label> <button type="button" class="w-full px-4 py-2.5 text-left rounded-lg bg-muted/50 text-muted-foreground hover:bg-muted transition-colors flex items-center gap-3 group"><!> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">How many people can use this invite (1-500)</p></div> <div class="flex items-center space-x-3"><input type="checkbox" id="personalize" class="w-5 h-5 text-primary border rounded focus:ring-orange-500"/> <label for="personalize" class="text-sm font-medium text-muted-foreground cursor-pointer">Personalize this invite</label></div> <!> <!>',1),Jr=Be('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Copied!',1),Vr=Be('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> Copy',1),Qr=Be('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg> Share',1),qr=i('<div class="flex gap-3 w-full"><!> <!></div>'),Xr=i('<div class="space-y-6"><div class="text-center py-8"><div class="w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <h3 class="text-lg font-semibold text-foreground mb-2">Invite Created!</h3> <p class="text-sm text-muted-foreground"> </p></div> <div class="bg-muted rounded-xl p-4 space-y-3"><div class="flex items-center space-x-2"><!> <!></div> <!></div> <!></div>'),Zr=i('<!> <div class="space-y-6 px-4 overflow-y-auto pb-4"><!></div>',1);function ea(Le,B){st(B,!0);const K=new Ot("(min-width: 768px)");let Q=Lt(B,"isOpen",15);const re=`Welcome to Agora! üéâ

I'm inviting you to join Agora, a new kind of social network where you own your identity and content. No algorithms, no ads, just authentic connections.

Looking forward to connecting with you on the open social web!`;let F=me(re),R=me(!1),P=me(""),J=me(""),de=me(10),te=me(""),pe=me(!1),j=me(!1),n=me(jt([])),f=me(!1);const $=H(()=>Ve.relays.filter(c=>c.enabled&&c.write&&_t(c.url)));et(()=>{Q()&&Ve.selectedRelay&&e(n).length===0&&_t(Ve.selectedRelay)&&e($).some(A=>A.url===Ve.selectedRelay)&&u(n,[Ve.selectedRelay],!0)});function w(c){e(n).includes(c)?u(n,e(n).filter(A=>A!==c),!0):u(n,[...e(n),c],!0)}const y=H(()=>e(n).length===0?null:e(n).length===1?{url:e(n)[0],info:at(e(n)[0])}:null),ae=H(()=>e(n).length===0?"Select Agora...":e(n).length===1?at(e(n)[0]).info?.name||e(n)[0].replace("wss://","").replace("ws://",""):`${e(n).length} Agoras selected`);async function h(){if(!ke.$currentUser){console.error("No user logged in");return}if(e(n).length===0){alert("Please select at least one Agora to publish the invite to.");return}u(pe,!0);try{const c=St(),A=e(R)?Tt():"",ye=[];for(let ce=0;ce<e(de);ce++)ye.push(Ut());const ze={welcomeMessage:e(F),recipientName:e(R)?e(P):void 0,cashuToken:e(R)&&e(J)?`cashu:${e(J)}`:void 0,createdAt:Date.now(),inviter:ke.$currentUser.pubkey},Re=e(R)?await Et(JSON.stringify(ze),A):JSON.stringify(ze),z=new Rt(ke);z.kind=513,z.content=Re,z.tags=[["d",c],...ye.map(ce=>["code",ce])],z.isProtected=!0,await z.sign(),z.isProtected=!0,console.log("Publishing invite event to selected Agoras...",z.id,e(n));const De=new Set;for(const ce of e(n)){const Ue=ke.pool.getRelay(ce,!0);Ue&&De.add(Ue)}const ve=new Dt(De,ke);await z.publish(ve);const Te=e(R)?`${c}${A}`:c,$e=`${window.location.origin}/i/${Te}`;u(te,$e),console.log("Invite created:",$e)}catch(c){console.error("Failed to generate invite:",c),alert("Failed to generate invite. Check console for details.")}finally{u(pe,!1)}}async function _(){try{await navigator.clipboard.writeText(e(te)),u(j,!0),setTimeout(()=>u(j,!1),2e3)}catch(c){console.error("Failed to copy:",c)}}async function L(){if(!navigator.share){console.log("Web Share API not supported, falling back to copy"),await _();return}try{await navigator.share({title:"Join Agora",text:e(R)&&e(P)?`${e(P)}, you're invited to join Agora!`:"You're invited to join Agora, a new kind of social network!",url:e(te)})}catch(c){c.name!=="AbortError"&&console.error("Failed to share:",c)}}function D(){u(F,re),u(R,!1),u(P,""),u(J,""),u(de,10),u(te,""),u(n,[],!0),u(f,!1),B.onClose()}function ge(){u(f,!1)}var be=fe(),Se=k(be);{var I=c=>{var A=fe(),ye=k(A);we(ye,()=>Ht,(ze,Re)=>{Re(ze,{get open(){return Q()},onOpenChange:z=>{Q(z),z||D()},children:(z,De)=>{var ve=fe(),Te=k(ve);we(Te,()=>Wt,($e,ce)=>{ce($e,{class:"max-w-lg max-h-[90vh] overflow-y-auto",children:(Ue,tt)=>{var He=Dr(),Ae=k(He);we(Ae,()=>Yt,(X,Z)=>{Z(X,{children:(O,_e)=>{var he=mr(),S=k(he);we(S,()=>Gt,(W,oe)=>{oe(W,{children:(se,Ie)=>{p();var C=ue("Create an Invite");r(se,C)},$$slots:{default:!0}})});var T=o(S,2);we(T,()=>Qt,(W,oe)=>{oe(W,{children:(se,Ie)=>{p();var C=ue("Invite someone to join Agora with a personal message");r(se,C)},$$slots:{default:!0}})}),r(O,he)},$$slots:{default:!0}})});var Pe=o(Ae,2),Ke=a(Pe);{var it=X=>{var Z=Ir(),O=k(Z),_e=a(O);Ge(_e,{for:"welcome-message",children:(s,l)=>{p();var x=ue("Welcome Message");r(s,x)},$$slots:{default:!0}});var he=o(_e,2);Ct(he,{id:"welcome-message",rows:6,placeholder:"Write a welcome message...",class:"mt-2 resize-none",get value(){return e(F)},set value(s){u(F,s,!0)}}),t(O);var S=o(O,2),T=o(a(S),2);T.__click=()=>u(f,!e(f));var W=a(T);{var oe=s=>{var l=pr();p(2),r(s,l)},se=s=>{var l=fe(),x=k(l);{var Y=d=>{var m=gr(),g=k(m);ot(g,{get relayUrl(){return e(y).url},size:"lg"});var v=o(g,2),G=a(v,!0);t(v),E(()=>M(G,e(ae))),r(d,m)},ie=d=>{var m=_r(),g=o(k(m),2),v=a(g);t(g),E(()=>M(v,`${e(n).length??""} Agoras selected`)),r(d,m)};b(x,d=>{e(n).length===1&&e(y)?d(Y):d(ie,!1)},!0)}r(s,l)};b(W,s=>{e(n).length===0?s(oe):s(se,!1)})}var Ie=o(W,2);t(T);var C=o(T,2);{var Ce=s=>{var l=yr(),x=a(l);{var Y=d=>{var m=hr();r(d,m)},ie=d=>{var m=fe(),g=k(m);Qe(g,17,()=>e($),v=>v.url,(v,G)=>{const le=H(()=>at(e(G).url));var We=br();We.__click=()=>{w(e(G).url)};var Fe=a(We);rt(Fe);var qe=o(Fe,2);ot(qe,{get relayUrl(){return e(G).url},size:"md"});var Xe=o(qe,2),Je=a(Xe),Ze=a(Je),ct=a(Ze,!0);t(Ze),p(2),t(Je);var ut=o(Je,2);{var ft=Me=>{var je=xr(),mt=a(je,!0);t(je),E(()=>M(mt,e(le).info.description)),r(Me,je)};b(ut,Me=>{e(le).info?.description&&Me(ft)})}t(Xe),t(We),E((Me,je)=>{kt(Fe,Me),M(ct,je)},[()=>e(n).includes(e(G).url),()=>e(le).info?.name||e(G).url.replace("wss://","").replace("ws://","")]),r(v,We)}),r(d,m)};b(x,d=>{e($).length===0?d(Y):d(ie,!1)})}t(l),At(l,(d,m)=>It?.(d,m),()=>ge),r(s,l)};b(C,s=>{e(f)&&s(Ce)})}var ee=o(C,2);{var Ee=s=>{var l=wr(),x=a(l);t(l),E(()=>M(x,`${e(n).length??""} Agoras selected`)),r(s,l)};b(ee,s=>{e(n).length>1&&s(Ee)})}t(S);var V=o(S,2),ne=a(V);Ge(ne,{for:"max-uses",children:(s,l)=>{p();var x=ue("Maximum Uses");r(s,x)},$$slots:{default:!0}});var U=o(ne,2);Ye(U,{id:"max-uses",type:"number",min:"1",max:"500",class:"mt-2",get value(){return e(de)},set value(s){u(de,s,!0)}}),p(2),t(V);var N=o(V,2),Oe=a(N);rt(Oe),p(2),t(N);var xe=o(N,2);{var dt=s=>{var l=Ar(),x=a(l),Y=a(x);Ge(Y,{for:"recipient-name",class:"flex items-center gap-2",children:(v,G)=>{var le=kr();p(),r(v,le)},$$slots:{default:!0}});var ie=o(Y,2);Ye(ie,{id:"recipient-name",type:"text",placeholder:"John Doe",class:"mt-2",get value(){return e(P)},set value(v){u(P,v,!0)}}),t(x);var d=o(x,2),m=a(d);Ge(m,{for:"cashu-amount",class:"flex items-center gap-2",children:(v,G)=>{var le=$r();p(),r(v,le)},$$slots:{default:!0}});var g=o(m,2);Ye(g,{id:"cashu-amount",type:"number",placeholder:"Amount in sats (optional)",class:"mt-2",get value(){return e(J)},set value(v){u(J,v,!0)}}),p(2),t(d),t(l),r(s,l)};b(xe,s=>{e(R)&&s(dt)})}var vt=o(xe,2);{let s=H(()=>e(pe)||!e(F).trim()||e(n).length===0);Ne(vt,{onclick:h,get disabled(){return e(s)},class:"w-full",children:(l,x)=>{var Y=fe(),ie=k(Y);{var d=g=>{var v=Pr();p(),r(g,v)},m=g=>{var v=ue("Generate Invite Link");r(g,v)};b(ie,g=>{e(pe)?g(d):g(m,!1)})}r(l,Y)},$$slots:{default:!0}})}E(()=>ht(Ie,0,`w-4 h-4 text-muted-foreground transition-transform flex-shrink-0 ${e(f)?"rotate-180":""}`)),Pt(Oe,()=>e(R),s=>u(R,s)),r(X,Z)},lt=X=>{var Z=Rr(),O=a(Z),_e=o(a(O),4),he=a(_e,!0);t(_e),t(O);var S=o(O,2),T=a(S),W=a(T);Ye(W,{type:"text",get value(){return e(te)},readonly:!0,class:"flex-1 bg-transparent"});var oe=o(W,2);Ne(oe,{onclick:_,size:"sm",children:(C,Ce)=>{var ee=fe(),Ee=k(ee);{var V=U=>{var N=Cr();p(),r(U,N)},ne=U=>{var N=Mr();p(),r(U,N)};b(Ee,U=>{e(j)?U(V):U(ne,!1)})}r(C,ee)},$$slots:{default:!0}}),t(T);var se=o(T,2);Ne(se,{onclick:L,variant:"outline",class:"w-full",children:(C,Ce)=>{var ee=jr();p(),r(C,ee)},$$slots:{default:!0}}),t(S);var Ie=o(S,2);we(Ie,()=>Zt,(C,Ce)=>{Ce(C,{class:"flex gap-3 sm:space-x-0",children:(ee,Ee)=>{var V=zr(),ne=k(V);Ne(ne,{variant:"outline",onclick:()=>u(te,""),class:"flex-1",children:(N,Oe)=>{p();var xe=ue("Create Another");r(N,xe)},$$slots:{default:!0}});var U=o(ne,2);Ne(U,{onclick:D,class:"flex-1",children:(N,Oe)=>{p();var xe=ue("Done");r(N,xe)},$$slots:{default:!0}}),r(ee,V)},$$slots:{default:!0}})}),t(Z),E(()=>M(he,e(R)&&e(P)?`Your personalized invite for ${e(P)} is ready`:"Your invite link is ready to share")),r(X,Z)};b(Ke,X=>{e(te)?X(lt,!1):X(it)})}t(Pe),r(Ue,He)},$$slots:{default:!0}})}),r(z,ve)},$$slots:{default:!0}})}),r(c,A)},q=c=>{var A=fe(),ye=k(A);we(ye,()=>Vt,(ze,Re)=>{Re(ze,{get open(){return Q()},onOpenChange:z=>{Q(z),z||D()},children:(z,De)=>{var ve=fe(),Te=k(ve);we(Te,()=>Kt,($e,ce)=>{ce($e,{children:(Ue,tt)=>{var He=Zr(),Ae=k(He);we(Ae,()=>Ft,(X,Z)=>{Z(X,{class:"text-left",children:(O,_e)=>{var he=Nr(),S=k(he);we(S,()=>Jt,(W,oe)=>{oe(W,{children:(se,Ie)=>{p();var C=ue("Create an Invite");r(se,C)},$$slots:{default:!0}})});var T=o(S,2);we(T,()=>qt,(W,oe)=>{oe(W,{children:(se,Ie)=>{p();var C=ue("Invite someone to join Agora with a personal message");r(se,C)},$$slots:{default:!0}})}),r(O,he)},$$slots:{default:!0}})});var Pe=o(Ae,2),Ke=a(Pe);{var it=X=>{var Z=Fr(),O=k(Z),_e=a(O);Ge(_e,{for:"welcome-message",children:(s,l)=>{p();var x=ue("Welcome Message");r(s,x)},$$slots:{default:!0}});var he=o(_e,2);Ct(he,{id:"welcome-message",rows:6,placeholder:"Write a welcome message...",class:"mt-2 resize-none",get value(){return e(F)},set value(s){u(F,s,!0)}}),t(O);var S=o(O,2),T=o(a(S),2);T.__click=()=>u(f,!e(f));var W=a(T);{var oe=s=>{var l=Br();p(2),r(s,l)},se=s=>{var l=fe(),x=k(l);{var Y=d=>{var m=Lr(),g=k(m);ot(g,{get relayUrl(){return e(y).url},size:"lg"});var v=o(g,2),G=a(v,!0);t(v),E(()=>M(G,e(ae))),r(d,m)},ie=d=>{var m=Sr(),g=o(k(m),2),v=a(g);t(g),E(()=>M(v,`${e(n).length??""} Agoras selected`)),r(d,m)};b(x,d=>{e(n).length===1&&e(y)?d(Y):d(ie,!1)},!0)}r(s,l)};b(W,s=>{e(n).length===0?s(oe):s(se,!1)})}var Ie=o(W,2);t(T);var C=o(T,2);{var Ce=s=>{var l=Or(),x=a(l);{var Y=d=>{var m=Tr();r(d,m)},ie=d=>{var m=fe(),g=k(m);Qe(g,17,()=>e($),v=>v.url,(v,G)=>{const le=H(()=>at(e(G).url));var We=Er();We.__click=()=>{w(e(G).url)};var Fe=a(We);rt(Fe);var qe=o(Fe,2);ot(qe,{get relayUrl(){return e(G).url},size:"md"});var Xe=o(qe,2),Je=a(Xe),Ze=a(Je),ct=a(Ze,!0);t(Ze),p(2),t(Je);var ut=o(Je,2);{var ft=Me=>{var je=Ur(),mt=a(je,!0);t(je),E(()=>M(mt,e(le).info.description)),r(Me,je)};b(ut,Me=>{e(le).info?.description&&Me(ft)})}t(Xe),t(We),E((Me,je)=>{kt(Fe,Me),M(ct,je)},[()=>e(n).includes(e(G).url),()=>e(le).info?.name||e(G).url.replace("wss://","").replace("ws://","")]),r(v,We)}),r(d,m)};b(x,d=>{e($).length===0?d(Y):d(ie,!1)})}t(l),At(l,(d,m)=>It?.(d,m),()=>ge),r(s,l)};b(C,s=>{e(f)&&s(Ce)})}var ee=o(C,2);{var Ee=s=>{var l=Wr(),x=a(l);t(l),E(()=>M(x,`${e(n).length??""} Agoras selected`)),r(s,l)};b(ee,s=>{e(n).length>1&&s(Ee)})}t(S);var V=o(S,2),ne=a(V);Ge(ne,{for:"max-uses",children:(s,l)=>{p();var x=ue("Maximum Uses");r(s,x)},$$slots:{default:!0}});var U=o(ne,2);Ye(U,{id:"max-uses",type:"number",min:"1",max:"500",class:"mt-2",get value(){return e(de)},set value(s){u(de,s,!0)}}),p(2),t(V);var N=o(V,2),Oe=a(N);rt(Oe),p(2),t(N);var xe=o(N,2);{var dt=s=>{var l=Hr(),x=a(l),Y=a(x);Ge(Y,{for:"recipient-name",class:"flex items-center gap-2",children:(v,G)=>{var le=Yr();p(),r(v,le)},$$slots:{default:!0}});var ie=o(Y,2);Ye(ie,{id:"recipient-name",type:"text",placeholder:"John Doe",class:"mt-2",get value(){return e(P)},set value(v){u(P,v,!0)}}),t(x);var d=o(x,2),m=a(d);Ge(m,{for:"cashu-amount",class:"flex items-center gap-2",children:(v,G)=>{var le=Gr();p(),r(v,le)},$$slots:{default:!0}});var g=o(m,2);Ye(g,{id:"cashu-amount",type:"number",placeholder:"Amount in sats (optional)",class:"mt-2",get value(){return e(J)},set value(v){u(J,v,!0)}}),p(2),t(d),t(l),r(s,l)};b(xe,s=>{e(R)&&s(dt)})}var vt=o(xe,2);{let s=H(()=>e(pe)||!e(F).trim()||e(n).length===0);Ne(vt,{onclick:h,get disabled(){return e(s)},class:"w-full",children:(l,x)=>{var Y=fe(),ie=k(Y);{var d=g=>{var v=Kr();p(),r(g,v)},m=g=>{var v=ue("Generate Invite Link");r(g,v)};b(ie,g=>{e(pe)?g(d):g(m,!1)})}r(l,Y)},$$slots:{default:!0}})}E(()=>ht(Ie,0,`w-4 h-4 text-muted-foreground transition-transform flex-shrink-0 ${e(f)?"rotate-180":""}`)),Pt(Oe,()=>e(R),s=>u(R,s)),r(X,Z)},lt=X=>{var Z=Xr(),O=a(Z),_e=o(a(O),4),he=a(_e,!0);t(_e),t(O);var S=o(O,2),T=a(S),W=a(T);Ye(W,{type:"text",get value(){return e(te)},readonly:!0,class:"flex-1 bg-transparent"});var oe=o(W,2);Ne(oe,{onclick:_,size:"sm",children:(C,Ce)=>{var ee=fe(),Ee=k(ee);{var V=U=>{var N=Jr();p(),r(U,N)},ne=U=>{var N=Vr();p(),r(U,N)};b(Ee,U=>{e(j)?U(V):U(ne,!1)})}r(C,ee)},$$slots:{default:!0}}),t(T);var se=o(T,2);Ne(se,{onclick:L,variant:"outline",class:"w-full",children:(C,Ce)=>{var ee=Qr();p(),r(C,ee)},$$slots:{default:!0}}),t(S);var Ie=o(S,2);we(Ie,()=>Xt,(C,Ce)=>{Ce(C,{class:"pt-2",children:(ee,Ee)=>{var V=qr(),ne=a(V);Ne(ne,{variant:"outline",onclick:()=>u(te,""),class:"flex-1",children:(N,Oe)=>{p();var xe=ue("Create Another");r(N,xe)},$$slots:{default:!0}});var U=o(ne,2);Ne(U,{onclick:D,class:"flex-1",children:(N,Oe)=>{p();var xe=ue("Done");r(N,xe)},$$slots:{default:!0}}),t(V),r(ee,V)},$$slots:{default:!0}})}),t(Z),E(()=>M(he,e(R)&&e(P)?`Your personalized invite for ${e(P)} is ready`:"Your invite link is ready to share")),r(X,Z)};b(Ke,X=>{e(te)?X(lt,!1):X(it)})}t(Pe),r(Ue,He)},$$slots:{default:!0}})}),r(z,ve)},$$slots:{default:!0}})}),r(c,A)};b(Se,c=>{K.current?c(I):c(q,!1)})}r(Le,be),nt()}Mt(["click"]);const ta=Le=>{er(Le,{title:"üèÜ Agora Invites",subtitle:"Community growth and new members"})};var ra=i('<div class="min-h-screen flex items-center justify-center p-4"><div class="text-center"><svg class="w-16 h-16 mx-auto mb-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <h2 class="text-xl font-semibold text-foreground mb-2">Select an Agora</h2> <p class="text-muted-foreground">This page shows community invites for a specific Agora</p></div></div>'),aa=i('<p class="text-muted-foreground text-center py-8">No new members yet</p>'),oa=i('<div class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>'),sa=i('<p class="text-muted-foreground text-center py-8">No introductions yet</p>'),na=i('<div class="space-y-4"></div>'),ia=i('<div class="w-full lg:max-w-4xl mx-auto p-4 space-y-6"><!> <div class="bg-card rounded-xl border border-border p-6"><h2 class="text-xl font-bold text-foreground mb-4">üëã New Members</h2> <!></div> <div class="bg-card rounded-xl border border-border p-6"><h2 class="text-xl font-bold text-foreground mb-4">üí¨ Introductions</h2> <!></div></div> <!>',1);function Na(Le,B){st(B,!0);const K=H(()=>Ve.selectedRelay),Q=H(()=>e(K)?_t(e(K)):!1),re=H(()=>!e(K)||!e(Q)?null:ke.$subscribe(()=>({filters:[{kinds:[514]}],relayUrls:[e(K)],subId:"invite-redemptions",cacheUsage:bt.ONLY_RELAY,closeOnEose:!0}))),F=H(()=>!e(K)||!e(Q)?null:ke.$subscribe(()=>({filters:[{kinds:[1],"#t":["introduction"],limit:20}],relayUrls:[e(K)],cacheUsage:bt.ONLY_RELAY,exclusiveRelay:!0,closeOnEose:!0}))),R=H(()=>{if(!e(re))return[];const n=e(re).events,f=new Map;for(const w of n){const y=w.tags.find(ae=>ae[0]==="p");if(y?.[1]){const ae=y[1];f.set(ae,(f.get(ae)||0)+1)}}const $=Array.from(f.entries()).map(([w,y])=>({pubkey:w,totalInvites:y,successfulInvites:y,rank:0}));return $.sort((w,y)=>y.successfulInvites-w.successfulInvites),$.forEach((w,y)=>{w.rank=y+1}),$.slice(0,10)}),P=H(()=>{if(!e(F)||!e(re))return[];const n=e(F).events,f=e(re).events,$=new Map;for(const w of f){const y=w.tags.find(ae=>ae[0]==="p");y&&y[1]&&$.set(w.pubkey,y[1])}return n.map(w=>({event:w,invitedBy:$.get(w.pubkey)||null})).sort((w,y)=>(y.event.created_at||0)-(w.event.created_at||0)).slice(0,10)}),J=H(()=>e(re)?e(re).events.map(f=>{const $=f.tags.find(w=>w[0]==="p");return{memberPubkey:f.pubkey,inviterPubkey:$?.[1]||null,joinedAt:f.created_at||0}}).sort((f,$)=>$.joinedAt-f.joinedAt).slice(0,20):[]);et(()=>(e(Q)?pt.header=ta:pt.clear(),()=>{pt.clear()}));var de=fe(),te=k(de);{var pe=n=>{var f=ra();r(n,f)},j=n=>{var f=ia(),$=k(f),w=a($);dr(w,{get stats(){return e(R)}});var y=o(w,2),ae=o(a(y),2);{var h=I=>{var q=aa();r(I,q)},_=I=>{var q=oa();Qe(q,21,()=>e(J).slice(0,6),zt,(c,A)=>{Nt(c,{get memberPubkey(){return e(A).memberPubkey},get inviterPubkey(){return e(A).inviterPubkey},get joinedAt(){return e(A).joinedAt}})}),t(q),r(I,q)};b(ae,I=>{e(J).length===0?I(h):I(_,!1)})}t(y);var L=o(y,2),D=o(a(L),2);{var ge=I=>{var q=sa();r(I,q)},be=I=>{var q=na();Qe(q,21,()=>e(P),c=>c.event.id,(c,A)=>{fr(c,{get event(){return e(A).event},get invitedBy(){return e(A).invitedBy}})}),t(q),r(I,q)};b(D,I=>{e(P).length===0?I(ge):I(be,!1)})}t(L),t($);var Se=o($,2);ea(Se,{onClose:()=>gt.close(),get isOpen(){return gt.show},set isOpen(I){gt.show=I}}),r(n,f)};b(te,n=>{e(Q)?n(j,!1):n(pe)})}r(Le,de),nt()}export{Na as component};
