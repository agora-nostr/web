import{d as we,f as P,s as h,j as Ee,r as et,a as c,c as me,i as rt,t as ft}from"../chunks/rzUyzf2y.js";import{p as le,e as a,g as e,b as ce,y as he,r,d as n,t as U,a as b,c as de,s as Y,aO as gt,B as Ve,f as ie,bs as mt,x as bt,z as pt,u as at}from"../chunks/AsQG98fS.js";import{i as E}from"../chunks/DZKExFZC.js";import{a as te,c as xe,b as Ne,e as ot,r as Ge,s as Le}from"../chunks/CS0aOiUg.js";import{a as nt,f as it,N as xt,A as Qe,R as ht,n as be,k as st,J as kt}from"../chunks/tv6-RHC_.js";import{g as _t}from"../chunks/s53o-P2j.js";import{o as ae}from"../chunks/C3Y4KEs7.js";import{e as Ke}from"../chunks/Cztbr3Ea.js";import{c as Ce}from"../chunks/Dt3q2Svx.js";import{p as ne}from"../chunks/w-gpJwMz.js";import{s as lt}from"../chunks/DNVUPZsi.js";import{g as dt,b as wt,N as yt}from"../chunks/Cxhu68Im.js";import{U as Ze,c as Pt}from"../chunks/C-S0GgRw.js";import{a as qe,s as Xe}from"../chunks/DfBYFC16.js";import{$ as $e,a as Ct}from"../chunks/DrbR318x.js";import{b as ct}from"../chunks/CkKAtl6l.js";import{N as vt,c as ut}from"../chunks/BpHW1rOk.js";async function St(m,t){const i=new Set;try{const o=await m.signer?.user();if(!o)throw new Error("No user logged in");const u=await m.fetchEvent({kinds:[3],authors:[o.pubkey]}),l=new Set;u&&u.tags.filter(s=>s[0]==="p").forEach(s=>l.add(s[1]));for(const s of t)try{const f=await m.fetchEvent(s);f&&nt.from(f).pubkeys?.forEach(p=>{l.has(p)||i.add(p)})}catch(f){console.error(`Error processing pack ${s}:`,f)}if(i.size>0){const s=new it(m);s.kind=3,s.content=u?.content||"",u?s.tags=[...u.tags]:s.tags=[];for(const f of i)s.tags.push(["p",f]);await s.publish()}return Array.from(i)}catch(o){throw console.error("Error following pack users:",o),o}}var It=P('<img src="https://images.unsplash.com/photo-1529107386315-e1a2ed48a620?w=1200&amp;q=80" alt="Community gathering" class="absolute inset-0 w-full h-full object-cover"/>'),Nt=P('<div class="absolute inset-0 bg-gradient-to-br from-primary-600 to-primary-700"></div>'),zt=P('<button><div class="relative h-32"><img class="absolute inset-0 w-full h-full object-cover"/> <div style="display: none;"></div> <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div> <div class="absolute bottom-3 left-3 right-3"><div class="flex items-center gap-2 text-foreground"><span class="text-2xl"> </span> <span class="font-semibold"> </span></div> <div class="text-xs text-foreground/80 mt-1"> </div></div></div></button>'),Ut=P(`<div class="flex min-h-screen"><div class="hidden lg:block w-1/2 relative"><!> <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent"></div> <div class="absolute bottom-12 left-12 right-12 text-foreground"><h1 class="text-5xl font-bold mb-4">Your Voice Matters</h1> <p class="text-xl opacity-90">Join a community where every voice counts. Connect with leaders,
        share stories, and build the future together.</p></div></div> <div class="flex-1 flex items-center justify-center p-8 lg:p-12"><div class="max-w-xl w-full"><div class="mb-12 lg:hidden"><h1 class="text-4xl font-bold mb-3">Your Voice Matters</h1> <p class="text-muted-foreground">Choose your community to connect with local voices</p></div> <div class="lg:mb-8"><h2 class="text-2xl font-semibold mb-3">Choose Your Community</h2> <p class="text-muted-foreground text-sm">Select where you want to connect and contribute</p></div> <div class="grid grid-cols-2 gap-3 mb-8"></div> <button>Continue ‚Üí</button></div></div></div>`);function Dt(m,t){le(t,!0);const i=[{id:"venezuela",name:"Venezuela",flag:"üáªüá™",description:"Connect with the resilient Venezuelan community",image:"https://images.unsplash.com/photo-1520525003249-2b9cdda513bc?w=800&q=80",fallbackColor:"from-yellow-500 to-blue-600",leaders:["Mar√≠a Rodr√≠guez","Carlos Mendoza","Ana Lucia"]},{id:"cambodia",name:"Cambodia",flag:"üá∞üá≠",description:"Join voices from the Kingdom of Wonder",image:"https://images.unsplash.com/photo-1569154941061-e231b4725ef1?w=800&q=80",fallbackColor:"from-red-500 to-blue-700",leaders:["Sokha Chen","Dara Vong","Srey Mom"]},{id:"nicaragua",name:"Nicaragua",flag:"üá≥üáÆ",description:"Unite with Nicaraguan changemakers",image:"https://images.unsplash.com/photo-1503542724004-53f16c988e63?w=800&q=80",fallbackColor:"from-blue-500 to-sky-600",leaders:["Roberto Silva","Elena Martinez","Juan Carlos"]},{id:"zimbabwe",name:"Zimbabwe",flag:"üáøüáº",description:"Connect with Zimbabwe's innovators",image:"https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=800&q=80",fallbackColor:"from-green-600 to-yellow-500",leaders:["Tendai Moyo","Grace Ndlovu","David Chuma"]},{id:"afghanistan",name:"Afghanistan",flag:"üá¶üá´",description:"Support Afghan voices of hope",image:"https://images.unsplash.com/photo-1574482620811-1aa16ffe3c82?w=800&q=80",fallbackColor:"from-black to-red-700",leaders:["Ahmad Shah","Fatima Rashidi","Nasir Khan"]},{id:"iran",name:"Iran",flag:"üáÆüá∑",description:"Join the Persian community",image:"https://images.unsplash.com/photo-1608592077365-c6399182e63c?w=800&q=80",fallbackColor:"from-green-600 to-red-600",leaders:["Reza Hosseini","Maryam Azadi","Ali Karimi"]}];let o=ce(!1);var u=Ut(),l=a(u),s=a(l);{var f=N=>{var x=It();Ee("error",x,()=>Y(o,!0)),et(x),c(N,x)},I=N=>{var x=Nt();c(N,x)};E(s,N=>{e(o)?N(I,!1):N(f)})}he(4),r(l);var p=n(l,2),k=a(p),g=n(a(k),4);Ke(g,21,()=>i,N=>N.id,(N,x)=>{const _=b(()=>t.selectedCommunity===e(x).id);var D=zt();D.__click=()=>t.onSelectCommunity(e(x).id);var R=a(D),K=a(R),L=n(K,2),M=n(L,4),v=a(M),w=a(v),z=a(w,!0);r(w);var Z=n(w,2),H=a(Z,!0);r(Z),r(v);var B=n(v,2),O=a(B);r(B),r(M),r(R),r(D),U(()=>{te(D,1,`
              relative overflow-hidden rounded-lg border-2 transition-all
              ${e(_)?"border-black dark:border-white shadow-lg scale-[1.02]":"border hover:border dark:hover:border"}
            `),xe(K,"src",e(x).image),xe(K,"alt",e(x).name),te(L,1,`absolute inset-0 bg-gradient-to-br ${e(x).fallbackColor}`),h(z,e(x).flag),h(H,e(x).name),h(O,`${e(x).leaders.length??""} community leaders`)}),Ee("error",K,Q=>{const W=Q.currentTarget;W.style.display="none";const T=W.nextElementSibling;T&&(T.style.display="block")}),et(K),c(N,D)}),r(g);var y=n(g,2);y.__click=function(...N){t.onNext?.apply(this,N)},r(k),r(p),r(u),U(()=>{y.disabled=!t.selectedCommunity,te(y,1,`
          w-full py-4 px-6 rounded-lg font-medium transition-all
          ${t.selectedCommunity?"bg-background dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-200":"bg-neutral-100 dark:bg-background text-muted-foreground cursor-not-allowed"}
        `)}),c(m,u),de()}we(["click"]);const Mt={venezuela:[Qe[1]],nicaragua:[Qe[2]]},jt={venezuela:["naddr1qvzqqqyckypzp75v7yjjc7h7lzaf3gfvpck39mvcjmylz7aleup9mtutd5yrlxv7qythwumn8ghj7un9d3shjtnswf5k6ctv9ehx2ap0qythwumn8ghj7un9d3shjtnwdaehgu3wvfskuep0qqv4qmmv946xjcmp94tx2mn90f6k2mrp945kwart09hsc909n2"]},At=xt.FollowPack,tt={venezuela:{name:"Venezuela",description:"Connect with the Venezuelan community"},cambodia:{name:"Cambodia",description:"Join voices from the Kingdom of Wonder"},nicaragua:{name:"Nicaragua",description:"Unite with Nicaraguan changemakers"},zimbabwe:{name:"Zimbabwe",description:"Connect with Zimbabwe's innovators"},afghanistan:{name:"Afghanistan",description:"Support Afghan voices of hope"},iran:{name:"Iran",description:"Join the Persian community"}},Re=Symbol("follow-pack");var Ft=P("<div><!></div>");function Ot(m,t){le(t,!0);let i=ne(t,"class",3,"");const o=dt(t.ndk);gt(Re,{get ndk(){return o},get followPack(){return t.followPack},get onclick(){return t.onclick}});var l=Ft(),s=a(l);lt(s,()=>t.children),r(l),U(()=>te(l,1,`contents ${i()??""}`)),c(m,l),de()}var Et=P('<div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>'),Rt=P('<div><img class="w-full h-full object-cover"/> <!></div>'),Tt=P('<div><svg class="w-1/3 h-1/3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg></div>');function Lt(m,t){le(t,!0);let i=ne(t,"class",3,""),o=ne(t,"showGradient",3,!1);const u=Ve(Re),l=b(()=>u.followPack.image||t.fallback);var s=me(),f=ie(s);{var I=k=>{var g=Rt(),y=a(g),N=n(y,2);{var x=_=>{var D=Et();c(_,D)};E(N,_=>{o()&&_(x)})}r(g),U(()=>{te(g,1,`follow-pack-image relative overflow-hidden ${i()??""}`),xe(y,"src",e(l)),xe(y,"alt",u.followPack.title||"Follow pack")}),c(k,g)},p=k=>{var g=me(),y=ie(g);{var N=x=>{var _=Tt();U(()=>te(_,1,`follow-pack-image-fallback bg-muted flex items-center justify-center ${i()??""}`)),c(x,_)};E(y,x=>{t.fallback===void 0&&x(N)},!0)}c(k,g)};E(f,k=>{e(l)?k(I):k(p,!1)})}c(m,s),de()}var Bt=P("<span> </span>");function qt(m,t){le(t,!0);let i=ne(t,"class",3,"");const o=Ve(Re),u=b(()=>o.followPack.title||"Untitled Pack"),l=b(()=>t.lines?`line-clamp-${t.lines}`:"");var s=Bt(),f=a(s,!0);r(s),U(()=>{te(s,1,`follow-pack-title ${e(l)??""} ${i()??""}`),h(f,e(u))}),c(m,s),de()}var Vt=P("<span> </span>");function Kt(m,t){le(t,!0);let i=ne(t,"class",3,"");const o=Ve(Re),u=b(()=>o.followPack.description||""),l=b(()=>t.maxLength&&e(u).length>t.maxLength?e(u).slice(0,t.maxLength)+"...":e(u)),s=b(()=>t.lines?`line-clamp-${t.lines}`:"");var f=me(),I=ie(f);{var p=k=>{var g=Vt(),y=a(g,!0);r(g),U(()=>{te(g,1,`follow-pack-description ${e(s)??""} ${i()??""}`),h(y,e(l))}),c(k,g)};E(I,k=>{e(u)&&k(p)})}c(m,f),de()}var Ht=P("<span> </span>");function Yt(m,t){le(t,!0);let i=ne(t,"class",3,""),o=ne(t,"format",3,"short");const u=Ve(Re),l=b(()=>u.followPack.pubkeys.length),s=b(()=>o()==="long"?`${e(l)} ${e(l)===1?"person":"people"}`:e(l).toString());var f=Ht(),I=a(f,!0);r(f),U(()=>{te(f,1,`follow-pack-member-count ${i()??""}`),h(I,e(s))}),c(m,f),de()}const Oe={Root:Ot,Image:Lt,Title:qt,Description:Kt,MemberCount:Yt};function Wt(m,t){const i=b(m),o=b(()=>e(i).pubkeys),u=b(()=>mt(e(i).skipCurrentUser,!1)),l=b(()=>t?.$follows||new Set),s=b(()=>t?.$currentPubkey),f=b(()=>{if(!t)return[];let g=e(o);return e(u)&&e(s)&&(g=e(o).filter(y=>y!==e(s))),g.map(y=>t.getUser({pubkey:y}))}),I=b(()=>e(f).filter(g=>e(l).has(g.pubkey))),p=b(()=>e(f).filter(g=>!e(l).has(g.pubkey))),k=b(()=>[...e(I),...e(p)]);return{get users(){return e(k)},get followedUsers(){return e(I)},get unfollowedUsers(){return e(p)}}}var Jt=P('<button type="button" class="block p-0 border-none bg-none cursor-pointer transition-transform duration-200 hover:scale-110 hover:!z-[9999] focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2 focus-visible:rounded-full"><!></button>'),Gt=P('<div data-avatar-group="" class="avatar-wrapper"><!></div>'),Zt=P('<div data-avatar-group="" class="relative transition-transform duration-200"><!></div>'),Qt=P('<button type="button" class="p-0 border-none bg-none cursor-pointer font-semibold text-muted-foreground transition-colors hover:text-foreground focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2 focus-visible:rounded"> </button>'),Xt=P('<span class="inline-block"> </span>'),$t=P('<div data-avatar-group="" class="flex items-center font-semibold text-muted-foreground"><!></div>'),er=P('<button type="button" class="w-full h-full rounded-full border-none bg-none cursor-pointer flex items-center justify-center font-semibold text-muted-foreground transition-all duration-200 hover:bg-muted-hover hover:text-foreground hover:scale-110 focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2"> </button>'),tr=P('<div class="w-full h-full flex items-center justify-center"> </div>'),rr=P('<div data-avatar-group="" class="relative rounded-full bg-muted border-2 border-background flex items-center justify-center font-semibold text-muted-foreground flex-shrink-0"><!></div>'),ar=P('<div data-avatar-group="" role="group" aria-label="User avatars"><!> <!></div>');function or(m,t){le(t,!0);let i=ne(t,"pubkeys",19,()=>[]),o=ne(t,"skipCurrentUser",3,!1),u=ne(t,"max",3,5),l=ne(t,"size",3,40),s=ne(t,"spacing",3,"normal"),f=ne(t,"overflowVariant",3,"avatar"),I=ne(t,"direction",3,"horizontal"),p=ne(t,"class",3,"");const k=Wt(()=>({pubkeys:i(),skipCurrentUser:o()}),t.ndk),g=b(()=>k.users.slice(0,u())),y=b(()=>Math.max(0,k.users.length-u())),x={tight:-8,normal:-12,loose:-6}[s()],_=b(()=>I()==="vertical");var D=ar(),R=a(D);Ke(R,19,()=>e(g),M=>M.pubkey,(M,v,w)=>{var z=Zt();let Z;var H=a(z);Ce(H,()=>Ze.Root,(B,O)=>{O(B,{get ndk(){return t.ndk},get user(){return e(v)},children:(Q,W)=>{var T=me(),A=ie(T);{var V=J=>{var d=Jt();d.__click=()=>t.onAvatarClick?.(e(v));let C;var j=a(d);Ce(j,()=>Ze.Avatar,(ee,re)=>{re(ee,{class:"ring-2 ring-background w-full h-full"})}),r(d),U(()=>C=Ne(d,"",C,{width:`${l()??""}px`,height:`${l()??""}px`})),c(J,d)},X=J=>{var d=Gt();let C;var j=a(d);Ce(j,()=>Ze.Avatar,(ee,re)=>{re(ee,{class:"ring-2 ring-background w-full h-full"})}),r(d),U(()=>C=Ne(d,"",C,{width:`${l()??""}px`,height:`${l()??""}px`})),c(J,d)};E(A,J=>{t.onAvatarClick?J(V):J(X,!1)})}c(Q,T)},$$slots:{default:!0}})}),r(z),U(()=>Z=Ne(z,"",Z,{"margin-left":!e(_)&&e(w)!==0?`${x}px`:"0","margin-top":e(_)&&e(w)!==0?`${x}px`:"0","z-index":e(g).length-e(w)})),c(M,z)});var K=n(R,2);{var L=M=>{var v=me(),w=ie(v);{var z=H=>{var B=me(),O=ie(B);lt(O,()=>t.overflowSnippet,()=>e(y)),c(H,B)},Z=H=>{var B=me(),O=ie(B);{var Q=T=>{var A=$t();let V;var X=a(A);{var J=C=>{var j=Qt();j.__click=function(...re){t.onOverflowClick?.apply(this,re)};var ee=a(j);r(j),U(()=>h(ee,`+${e(y)??""}`)),c(C,j)},d=C=>{var j=Xt(),ee=a(j);r(j),U(()=>h(ee,`+${e(y)??""}`)),c(C,j)};E(X,C=>{t.onOverflowClick?C(J):C(d,!1)})}r(A),U(()=>V=Ne(A,"",V,{"margin-left":e(_)?"0":"8px","margin-top":e(_)?"8px":"0"})),c(T,A)},W=T=>{var A=rr();let V;var X=a(A);{var J=C=>{var j=er();j.__click=function(...re){t.onOverflowClick?.apply(this,re)};var ee=a(j);r(j),U(()=>h(ee,`+${e(y)??""}`)),c(C,j)},d=C=>{var j=tr(),ee=a(j);r(j),U(()=>h(ee,`+${e(y)??""}`)),c(C,j)};E(X,C=>{t.onOverflowClick?C(J):C(d,!1)})}r(A),U(()=>V=Ne(A,"",V,{"margin-left":e(_)?"0":`${x}px`,"margin-top":e(_)?`${x}px`:"0",width:`${l()??""}px`,height:`${l()??""}px`,"font-size":`${l()*.35}px`,"z-index":0})),c(T,A)};E(O,T=>{f()==="text"?T(Q):T(W,!1)},!0)}c(H,B)};E(w,H=>{t.overflowSnippet?H(z):H(Z,!1)})}c(M,v)};E(K,M=>{e(y)>0&&f()!=="none"&&M(L)})}r(D),U(M=>te(D,1,M),[()=>ot(Pt("relative flex",e(_)?"flex-col items-start":"items-center",p()))]),c(m,D),de()}we(["click"]);var nr=P('<button data-follow-pack-compact="" type="button"><!> <div class="flex-1 min-w-0 text-left"><!> <!> <div class="flex items-center gap-3"><!> <div class="flex items-center gap-1.5 text-xs text-muted-foreground"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <!></div></div></div></button>');function ir(m,t){le(t,!0);let i=ne(t,"class",3,"");const o=dt(t.ndk);var u=me(),l=ie(u);Ce(l,()=>Oe.Root,(s,f)=>{f(s,{get ndk(){return o},get followPack(){return t.followPack},get onclick(){return t.onclick},children:(I,p)=>{var k=nr(),g=a(k);Ce(g,()=>Oe.Image,(L,M)=>{M(L,{class:"w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden"})});var y=n(g,2),N=a(y);Ce(N,()=>Oe.Title,(L,M)=>{M(L,{class:"text-sm font-semibold mb-1",lines:1})});var x=n(N,2);Ce(x,()=>Oe.Description,(L,M)=>{M(L,{class:"text-xs text-muted-foreground mb-3",maxLength:80,lines:2})});var _=n(x,2),D=a(_);or(D,{get ndk(){return o},get pubkeys(){return t.followPack.pubkeys},max:3,size:20});var R=n(D,2),K=n(a(R),2);Ce(K,()=>Oe.MemberCount,(L,M)=>{M(L,{format:"long"})}),r(R),r(_),r(y),r(k),U(()=>te(k,1,`group flex items-center gap-4 w-full p-4 rounded-xl bg-card hover:bg-muted transition-colors ${i()??""}`)),c(I,k)},$$slots:{default:!0}})}),c(m,u),de()}var sr=P('<div class="text-center py-12"><div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div> <p class="mt-4 text-sm text-muted-foreground">Loading follow packs...</p></div>'),lr=P('<div class="text-center py-8 text-muted-foreground">No follow packs available for this community yet</div>'),dr=P('<div class="absolute top-1/2 right-4 -translate-y-1/2 bg-primary text-foreground rounded-full p-1.5 z-10 pointer-events-none"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div>'),cr=P('<div class="relative"><!> <!></div>'),vr=P('<div class="space-y-2 mb-6 lg:mb-8 max-h-[50vh] lg:max-h-[60vh] overflow-y-auto p-2 -m-2"></div>'),ur=P(`<div class="flex min-h-screen"><div class="hidden lg:block w-1/2 relative"><img src="https://images.unsplash.com/photo-1529107386315-e1a2ed48a620?w=1200&amp;q=80" alt="Community leaders" class="absolute inset-0 w-full h-full object-cover"/> <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/30 to-black/70"></div> <div class="absolute bottom-0 left-0 right-0 p-12"><div class="mb-8"><p class="text-3xl text-foreground/90 italic leading-relaxed">"We're not just surviving‚Äîwe're building the future our community deserves. One voice at a time."</p></div> <div class="flex items-center gap-4"><div class="w-12 h-12 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-foreground font-semibold">MR</div> <div class="text-foreground"><div class="font-semibold">Mar√≠a Rodr√≠guez</div> <div class="text-sm opacity-75">Community Organizer ¬∑ Caracas</div></div></div></div></div> <div class="w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-6 lg:p-12"><div class="max-w-xl w-full"><div class="mb-6 lg:mb-8"><h1 class="text-2xl lg:text-3xl font-bold mb-2 lg:mb-3">Build Your Network</h1> <p class="text-sm lg:text-base text-muted-foreground"> </p></div> <!> <button> </button></div></div></div>`);function fr(m,t){le(t,!0);const i=b(()=>t.selectedCommunity||"venezuela"),o=b(()=>jt[e(i)]),u=b(()=>{if(e(o)&&e(o).length>0){const v=e(o).map(w=>ht(w));return be.$subscribe(()=>({filters:v,subId:"followpacks",closeOnEose:!0}))}else{const v=Mt[e(i)];return!v||v.length===0?(console.warn(`No relay configured for community: ${e(i)}`),null):be.$subscribe(()=>({filters:[{kinds:[At]}],subId:"followpacks",closeOnEose:!0,relayUrls:v,exclusiveRelay:!0}))}}),l=b(()=>e(u)?Array.from(e(u).events??[]).map(w=>nt.from(w)):[]),s=b(()=>e(u)?.eoseReceived===!1),f=b(()=>tt[e(i)]||tt.venezuela);function I(v){const w=v.encode();console.log("[Step2] Pack clicked:",v.title,"packId:",w),t.selectedPacks.includes(w)?(console.log("[Step2] Deselecting pack"),t.onSelectPacks(t.selectedPacks.filter(z=>z!==w))):(console.log("[Step2] Selecting pack"),t.onSelectPacks([...t.selectedPacks,w])),console.log("[Step2] Selected packs count:",t.selectedPacks.length)}function p(){if(console.log("[Step2] handleNext called, selectedPacks:",t.selectedPacks.length),t.selectedPacks.length===0){console.log("[Step2] No packs selected, returning");return}console.log("[Step2] Calling onNext"),t.onNext()}var k=ur(),g=n(a(k),2),y=a(g),N=a(y),x=n(a(N),2),_=a(x);r(x),r(N);var D=n(N,2);{var R=v=>{var w=sr();c(v,w)},K=v=>{var w=me(),z=ie(w);{var Z=B=>{var O=lr();c(B,O)},H=B=>{var O=vr();Ke(O,21,()=>e(l).slice(0,6),Q=>Q.id,(Q,W)=>{const T=b(()=>t.selectedPacks.includes(e(W).encode()));var A=cr(),V=a(A);{let d=b(()=>e(T)?"ring-2 ring-orange-500 bg-primary-50 dark:bg-primary-950/20":"");ir(V,{get ndk(){return be},get followPack(){return e(W)},onclick:()=>I(e(W)),get class(){return e(d)}})}var X=n(V,2);{var J=d=>{var C=dr();c(d,C)};E(X,d=>{e(T)&&d(J)})}r(A),c(Q,A)}),r(O),c(B,O)};E(z,B=>{e(l).length===0?B(Z):B(H,!1)},!0)}c(v,w)};E(D,v=>{e(s)?v(R):v(K,!1)})}var L=n(D,2);L.__click=p;var M=a(L);r(L),r(y),r(g),r(k),U(()=>{h(_,`Follow curated packs from the ${e(f).name??""} community`),L.disabled=t.selectedPacks.length===0||e(s),te(L,1,`
          w-full py-3 lg:py-4 px-6 rounded-lg font-medium transition-all text-sm lg:text-base
          ${t.selectedPacks.length>0&&!e(s)?"bg-background dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-200":"bg-neutral-100 dark:bg-background text-muted-foreground cursor-not-allowed"}
        `),h(M,`Continue ${t.selectedPacks.length>0?`(${t.selectedPacks.length} selected)`:"‚Üí"}`)}),c(m,k),de()}we(["click"]);var gr=P(`<div class="min-h-screen flex items-center justify-center p-8 py-16"><div class="max-w-5xl w-full"><div class="text-center mb-12"><h2 class="text-3xl font-bold mb-3"> </h2> <p class="text-lg text-muted-foreground"> </p></div> <div class="grid md:grid-cols-3 gap-6 mb-12"><div class="bg-neutral-50 dark:bg-card rounded-xl p-6 border border"><div class="text-5xl mb-4 text-center">üõçÔ∏è</div> <h3 class="text-xl font-bold mb-2 text-center"> </h3> <p class="text-sm text-muted-foreground mb-4 text-center"> </p> <div class="bg-card rounded-lg p-4 text-left border border"><div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 bg-neutral-300 dark:bg-muted rounded-full flex items-center justify-center text-xs font-medium">MR</div> <div class="flex-1 min-w-0"><div class="font-semibold text-sm truncate">Mar√≠a's Bakery</div> <div class="text-xs text-muted-foreground">2km away</div></div></div> <div class="text-sm font-medium mb-1">Fresh Bread & Pastries</div> <div class="text-xs text-muted-foreground mb-2">Daily baked goods, accepting sats</div> <div class="text-sm font-semibold">2,500 sats / dozen</div></div></div> <div class="bg-neutral-50 dark:bg-card rounded-xl p-6 border border"><div class="text-5xl mb-4 text-center">ü§ù</div> <h3 class="text-xl font-bold mb-2 text-center"> </h3> <p class="text-sm text-muted-foreground mb-4 text-center"> </p> <div class="bg-card rounded-lg p-4 border border"><div class="space-y-2"><div class="flex items-center justify-between p-2 bg-green-50 dark:bg-green-900/20 rounded text-xs"><div class="flex items-center gap-2"><span class="text-green-600 dark:text-green-400 font-semibold">BUY</span> <span class="font-medium">100 USD</span></div> <div class="text-right"><div class="font-semibold">485k sats</div></div></div> <div class="flex items-center justify-between p-2 bg-red-50 dark:bg-red-900/20 rounded text-xs"><div class="flex items-center gap-2"><span class="text-red-600 dark:text-red-400 font-semibold">SELL</span> <span class="font-medium">50 USD</span></div> <div class="text-right"><div class="font-semibold">240k sats</div></div></div></div> <div class="flex items-center justify-center gap-1 text-xs text-muted-foreground mt-3"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> <span> </span></div></div></div> <div class="bg-neutral-50 dark:bg-card rounded-xl p-6 border border"><div class="text-5xl mb-4 text-center">üì∞</div> <h3 class="text-xl font-bold mb-2 text-center"> </h3> <p class="text-sm text-muted-foreground mb-4 text-center"> </p> <div class="bg-card rounded-lg p-4 text-left border border"><div class="flex items-center gap-2 mb-2"><div class="w-8 h-8 bg-neutral-300 dark:bg-muted rounded-full flex items-center justify-center text-xs font-medium">CM</div> <div class="flex-1 min-w-0"><div class="font-semibold text-sm truncate">Carlos Mendoza</div> <div class="text-xs text-muted-foreground">2 hours ago</div></div></div> <div class="text-sm font-medium mb-1">Alternative Supply Chain</div> <div class="text-xs text-muted-foreground mb-2">Direct farmer-to-community network reduces costs by 40%...</div> <div class="flex items-center gap-3 text-xs text-muted-foreground"><span>‚ö° 23.5k</span> <span>üí¨ 156</span> <span>üîÅ 89</span></div></div></div></div> <div class="text-center"><button class="bg-background dark:bg-white text-foreground dark:text-black px-8 py-3 rounded-lg font-medium hover:bg-muted dark:hover:bg-neutral-200 transition-colors"> </button></div></div></div>`);function mr(m,t){le(t,!0);const i=()=>qe($e,"$t",o),[o,u]=Xe();var l=gr(),s=a(l),f=a(s),I=a(f),p=a(I,!0);r(I);var k=n(I,2),g=a(k,!0);r(k),r(f);var y=n(f,2),N=a(y),x=n(a(N),2),_=a(x,!0);r(x);var D=n(x,2),R=a(D,!0);r(D),he(2),r(N);var K=n(N,2),L=n(a(K),2),M=a(L,!0);r(L);var v=n(L,2),w=a(v,!0);r(v);var z=n(v,2),Z=n(a(z),2),H=n(a(Z),2),B=a(H,!0);r(H),r(Z),r(z),r(K);var O=n(K,2),Q=n(a(O),2),W=a(Q,!0);r(Q);var T=n(Q,2),A=a(T,!0);r(T),he(2),r(O),r(y);var V=n(y,2),X=a(V);X.__click=function(...d){t.onNext?.apply(this,d)};var J=a(X);r(X),r(V),r(s),r(l),U((d,C,j,ee,re,ze,pe,Se,ke,_e)=>{h(p,d),h(g,C),h(_,j),h(R,ee),h(M,re),h(w,ze),h(B,pe),h(W,Se),h(A,ke),h(J,`${_e??""} ‚Üí`)},[()=>i()("onboarding.step3Features.title"),()=>i()("onboarding.step3Features.subtitle"),()=>i()("onboarding.step3Features.marketplace.title"),()=>i()("onboarding.step3Features.marketplace.description"),()=>i()("onboarding.step3Features.p2p.title"),()=>i()("onboarding.step3Features.p2p.description"),()=>i()("onboarding.step3Features.p2p.escrowProtected"),()=>i()("onboarding.step3Features.news.title"),()=>i()("onboarding.step3Features.news.description"),()=>i()("onboarding.step3Features.continue")]),c(m,l),de(),u()}we(["click"]);var br=P('<img alt="Profile" class="w-full h-full object-cover"/> <div class="absolute inset-0 bg-background/0 hover:bg-background/40 transition-all flex items-center justify-center opacity-0 hover:opacity-100"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg></div>',1),pr=P('<p class="text-xs mt-2 text-muted-foreground"> </p>'),xr=P('<div class="w-full h-full bg-neutral-100 dark:bg-muted flex flex-col items-center justify-center"><div class="w-12 h-12 border-4 border border-t-neutral-900 dark:border-t-white rounded-full animate-spin"></div> <!></div>'),hr=P('<span class="text-3xl font-bold group-hover:opacity-50 transition-opacity"> </span> <div class="opacity-0 group-hover:opacity-100 transition-opacity absolute inset-0 flex items-center justify-center bg-background/40"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg></div>',1),kr=rt('<svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-muted-foreground"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>'),_r=P('<div class="w-full h-full bg-card dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-100 transition-colors flex flex-col items-center justify-center gap-2 group"><!></div>'),wr=P('<p class="text-xs text-red-600 dark:text-red-400 mt-2 text-center"> </p>'),yr=P('<div class="w-full"><input type="file" accept="image/*" class="hidden"/> <div role="button" tabindex="0"><!></div> <!></div>');function Pr(m,t){le(t,!0);const i=new vt(t.ndk),o=ut(i);let u,l=ce(bt(t.currentImageUrl||null)),s=ce(!1);async function f(v){if(!v.type.startsWith("image/")){alert("Please select an image file");return}const w=new FileReader;w.onload=z=>{Y(l,z.target?.result,!0)},w.readAsDataURL(v);try{await o.upload(v,{fallbackServer:"https://blossom.primal.net"}),o.result?.url&&t.onUploadComplete(o.result.url)}catch(z){console.error("Upload failed:",z),Y(l,null)}}function I(v){const z=v.target.files?.[0];z&&f(z)}function p(v){v.preventDefault(),Y(s,!0)}function k(){Y(s,!1)}async function g(v){v.preventDefault(),Y(s,!1);const w=v.dataTransfer?.files[0];w&&await f(w)}function y(){u?.click()}var N=yr(),x=a(N);x.__change=I,ct(x,v=>u=v,()=>u);var _=n(x,2);_.__click=y,_.__keydown=v=>v.key==="Enter"&&y();var D=a(_);{var R=v=>{var w=br(),z=ie(w);he(2),U(()=>xe(z,"src",e(l))),c(v,w)},K=v=>{var w=me(),z=ie(w);{var Z=B=>{var O=xr(),Q=n(a(O),2);{var W=T=>{var A=pr(),V=a(A);r(A),U(()=>h(V,`${o.progress.percentage??""}%`)),c(T,A)};E(Q,T=>{o.progress&&T(W)})}r(O),c(B,O)},H=B=>{var O=_r(),Q=a(O);{var W=A=>{var V=hr(),X=ie(V),J=a(X,!0);r(X),he(2),U(()=>h(J,t.fallbackInitials)),c(A,V)},T=A=>{var V=kr();c(A,V)};E(Q,A=>{t.fallbackInitials?A(W):A(T,!1)})}r(O),c(B,O)};E(z,B=>{o.status==="uploading"?B(Z):B(H,!1)},!0)}c(v,w)};E(D,v=>{e(l)&&o.status!=="uploading"?v(R):v(K,!1)})}r(_);var L=n(_,2);{var M=v=>{var w=wr(),z=a(w,!0);r(w),U(()=>h(z,o.error?.message||"Upload failed")),c(v,w)};E(L,v=>{o.status==="error"&&v(M)})}r(N),U(()=>te(_,1,`
      relative w-32 h-32 rounded-full overflow-hidden cursor-pointer
      border-4 border-background
      transition-all duration-200
      ${e(s)?"scale-105 border-foreground":""}
      ${o.status==="uploading"?"pointer-events-none":""}
    `)),Ee("dragover",_,p),Ee("dragleave",_,k),Ee("drop",_,g),c(m,N),de()}we(["change","click","keydown"]);function Cr(m){try{return new URL(m).hostname}catch{return""}}async function Sr(m,t){if(!m||!t)return{available:!1,error:"Username and domain are required"};if(!/^[a-z0-9_-]+$/i.test(m))return{available:!1,error:"Username can only contain letters, numbers, underscore, and hyphen"};try{const o=`${t.includes("localhost")||t.includes("test")?"http":"https"}://${t}/.well-known/nostr.json?name=${encodeURIComponent(m)}`,u=await fetch(o);if(u.status===404)return{available:!0};if(u.ok){const l=await u.json();return l.names&&l.names[m]?{available:!1,error:"Username is already taken"}:{available:!0}}return{available:!1,error:"Unable to check availability. Please try again."}}catch(i){return console.error("Error checking NIP-05 availability:",i),{available:!0}}}function Ir(m,t){return`${m}@${t}`}var Nr=P('<div class="w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"></div> <span class="text-foreground text-sm font-medium"> </span>',1),zr=rt('<svg class="w-8 h-8 text-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),Ur=P('<div class="px-2 py-1 bg-red-500/10 border-t border-red-500/20"><p class="text-xs text-red-600 dark:text-red-400"> </p></div>'),Dr=P("<div> </div>"),Mr=P('<div class="space-y-1"><div class="text-xs text-muted-foreground font-medium"> </div> <div class="flex items-center gap-1"><input type="text" class="text-sm text-foreground bg-transparent border-b-2 border hover:border focus:border-primary dark:focus:border-primary outline-none transition-colors flex-1 min-w-0"/> <span class="text-sm text-muted-foreground"> </span></div> <!></div>'),jr=P('<div class="min-h-screen flex flex-col items-center justify-center p-8"><div class="text-center mb-8 max-w-2xl"><h1 class="text-4xl font-bold mb-3"> </h1> <p class="text-lg text-muted-foreground"> </p></div> <div class="relative flex items-center justify-center gap-6 mb-12"><div class="w-80 bg-card border border rounded-xl overflow-hidden transform -rotate-3 scale-95 opacity-80"><div class="h-32 bg-cover bg-center" style="background-image: url(https://m.primal.net/OQwX.jpg)"></div> <div class="relative -mt-12 px-6 pb-6"><img src="https://m.primal.net/OQwW.jpg" alt="Leopoldo L√≥pez" class="w-24 h-24 rounded-full border-4 border-background object-cover"/> <div class="mt-4"><h3 class="text-xl font-bold">Leopoldo L√≥pez</h3> <p class="text-sm text-muted-foreground mb-2">‚úì leo@primal.net</p> <p class="text-sm text-muted-foreground">Former Mayor of Caracas (2000-08). Political prisoner 2014-21. Co-founder of World Liberty Congress.</p></div></div></div> <div class="w-96 bg-card border-2 border-foreground rounded-xl overflow-hidden shadow-2xl transform scale-105 z-10"><input type="file" accept="image/*" class="hidden"/> <button type="button" class="h-36 relative w-full group bg-gradient-to-br from-primary-500 to-primary-600"><div class="absolute inset-0 bg-background/40 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2"><!></div></button> <!> <div class="relative -mt-14 px-6 pb-6"><!> <div class="space-y-3"><div><input type="text" class="text-2xl font-bold bg-transparent border-b-2 border-transparent hover:border !ring-0 outline-none transition-colors w-full text-foreground"/></div> <div><input type="text" class="text-sm text-muted-foreground bg-transparent border-b border-transparent hover:border !ring-0 focus:outline-none transition-colors w-full"/></div> <div><textarea class="text-sm text-muted-foreground bg-transparent border border-transparent hover:border !ring-0 outline-none transition-colors w-full resize-none rounded p-2"></textarea></div> <!></div></div></div> <div class="w-80 bg-card border border rounded-xl overflow-hidden transform rotate-3 scale-95 opacity-80"><div class="h-32 bg-cover bg-center" style="background-image: url(https://m.primal.net/OTue.jpg)"></div> <div class="relative -mt-12 px-6 pb-6"><img src="https://m.primal.net/OTkq.jpg" alt="Enderson Sequera" class="w-24 h-24 rounded-full border-4 border-background object-cover"/> <div class="mt-4"><h3 class="text-xl font-bold">Enderson Sequera</h3> <p class="text-sm text-muted-foreground mb-2">üáªüá™ Political Scientist</p> <p class="text-sm text-muted-foreground">Political advisor & freedom fighter. Bitcoin is freedom - in the fight against dictatorship it saves lives.</p></div></div></div></div> <button> </button></div>');function Ar(m,t){le(t,!0);const i=()=>qe($e,"$t",o),[o,u]=Xe(),l=b(()=>t.inviteRelay&&st(t.inviteRelay)),s=b(()=>t.inviteRelay?Cr(t.inviteRelay):"");let f=ce(""),I=ce(!1),p=ce(null),k=ce(!1),g=null;function y(S){if(Y(f,S,!0),!S||!e(s)){Y(p,null),Y(k,!1);return}g&&clearTimeout(g),Y(I,!0),Y(p,{type:"info",text:i()("onboarding.step4Profile.availability.checking")},!0),g=setTimeout(async()=>{const G=await Sr(S,e(s));G.available?(Y(p,{type:"success",text:i()("onboarding.step4Profile.availability.available")},!0),Y(k,!0)):(Y(p,{type:"error",text:G.error||i()("onboarding.step4Profile.availability.notAvailable")},!0),Y(k,!1)),Y(I,!1)},500)}const N=b(()=>be.$currentUser),x=b(()=>e(N)?new vt(be):null),_=b(()=>e(x)?ut(e(x)):null);let D,R=ce(null);async function K(S){const $=S.target.files?.[0];if($){if(!e(_)){Y(R,"Upload not available. Please ensure you are logged in.");return}if(!$.type.startsWith("image/")){Y(R,"Please select an image file");return}if($.size>5*1024*1024){Y(R,"Image size must be less than 5MB");return}Y(R,null);try{await e(_).upload($,{fallbackServer:"https://blossom.primal.net"}),e(_).result?.url&&t.onUpdateProfile({...t.profileData,banner:e(_).result.url})}catch(fe){console.error("Upload failed:",fe),Y(R,"Failed to upload banner. Please try again.")}}}function L(S){return S?S.split(" ").map(G=>G[0]).join("").toUpperCase().slice(0,2):"?"}function M(S,G){t.onUpdateProfile({...t.profileData,[S]:G})}async function v(){if(e(k)&&e(f)&&e(s)){const S=Ir(e(f),e(s));t.onUpdateProfile({...t.profileData,nip05:S})}t.onNext()}function w(S){t.onUpdateProfile({...t.profileData,picture:S})}var z=jr(),Z=a(z),H=a(Z),B=a(H,!0);r(H);var O=n(H,2),Q=a(O,!0);r(O),r(Z);var W=n(Z,2),T=n(a(W),2),A=a(T);A.__change=K,ct(A,S=>D=S,()=>D);var V=n(A,2);V.__click=()=>D?.click();var X=a(V),J=a(X);{var d=S=>{var G=Nr(),$=n(ie(G),2),fe=a($);r($),U(()=>h(fe,`${e(_).progress?.percentage??""}%`)),c(S,G)},C=S=>{var G=zr();c(S,G)};E(J,S=>{e(_)?.status==="uploading"?S(d):S(C,!1)})}r(X),r(V);var j=n(V,2);{var ee=S=>{var G=Ur(),$=a(G),fe=a($,!0);r($),r(G),U(()=>h(fe,e(R))),c(S,G)};E(j,S=>{e(R)&&S(ee)})}var re=n(j,2),ze=a(re);{let S=b(()=>L(t.profileData.name));Pr(ze,{get ndk(){return be},onUploadComplete:w,get currentImageUrl(){return t.profileData.picture},get fallbackInitials(){return e(S)}})}var pe=n(ze,2),Se=a(pe),ke=a(Se);Ge(ke),ke.__input=S=>M("name",S.currentTarget.value),r(Se);var _e=n(Se,2),Ue=a(_e);Ge(Ue),Ue.__input=S=>M("location",S.currentTarget.value),r(_e);var De=n(_e,2),Ie=a(De);pt(Ie),Ie.__input=S=>M("bio",S.currentTarget.value),xe(Ie,"rows",3),r(De);var He=n(De,2);{var Ye=S=>{var G=Mr(),$=a(G),fe=a($,!0);r($);var F=n($,2),q=a(F);Ge(q),q.__input=ge=>y(ge.currentTarget.value);var oe=n(q,2),se=a(oe);r(oe),r(F);var ve=n(F,2);{var Me=ge=>{var ue=Dr(),je=a(ue,!0);r(ue),U(()=>{te(ue,1,`text-xs ${e(p).type==="success"?"text-green-600 dark:text-green-400":e(p).type==="error"?"text-red-600 dark:text-red-400":"text-muted-foreground"}`),h(je,e(p).text)}),c(ge,ue)};E(ve,ge=>{e(p)&&ge(Me)})}r(G),U((ge,ue)=>{h(fe,ge),Le(q,e(f)),xe(q,"placeholder",ue),h(se,`@${e(s)??""}`)},[()=>i()("onboarding.step4Profile.usernameLabel"),()=>i()("onboarding.step4Profile.usernamePlaceholder")]),c(S,G)};E(He,S=>{e(l)&&S(Ye)})}r(pe),r(re),r(T),he(2),r(W);var ye=n(W,2);ye.__click=v;var Te=a(ye);r(ye),r(z),U((S,G,$,fe,F,q)=>{h(B,S),h(Q,G),V.disabled=e(_)?.status==="uploading",Ne(V,t.profileData.banner?`background-image: url(${t.profileData.banner}); background-size: cover; background-position: center;`:""),Le(ke,t.profileData.name),xe(ke,"placeholder",$),Le(Ue,t.profileData.location),xe(Ue,"placeholder",fe),Le(Ie,t.profileData.bio),xe(Ie,"placeholder",F),ye.disabled=!t.profileData.name,te(ye,1,`
      px-8 py-3 rounded-lg font-medium transition-all
      ${t.profileData.name?"bg-card dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-100":"bg-neutral-100 dark:bg-muted text-muted-foreground cursor-not-allowed"}
    `),h(Te,`${q??""} ‚Üí`)},[()=>i()("onboarding.step4Profile.title"),()=>i()("onboarding.step4Profile.subtitle"),()=>i()("onboarding.step4Profile.namePlaceholder"),()=>i()("onboarding.step4Profile.locationPlaceholder"),()=>i()("onboarding.step4Profile.bioPlaceholder"),()=>i()("onboarding.step4Profile.continue")]),c(m,z),de(),u()}we(["change","click","input"]);function Fr(m,t){const i=t&&st(t)?[t]:[...Qe],o=Math.floor(Date.now()/1e3)-720*60,u=m.$fetchEvents(()=>({filters:{kinds:[1],"#t":["introduction"],since:o},relayUrls:i})),l=b(()=>u?Array.from(u).map(I=>I.id):[]),s=m.$fetchEvents(()=>e(l).length>0?{filters:{"#e":e(l)},relayUrls:i}:void 0),f=b(()=>{if(!u||u.size===0)return[];const I=new Map;if(s)for(const p of s){const k=p.tags.filter(g=>g[0]==="e");for(const g of k){const y=g[1];e(l).includes(y)&&I.set(y,(I.get(y)||0)+1)}}return Array.from(u).map(p=>({event:p,engagementCount:I.get(p.id)||0})).sort((p,k)=>k.engagementCount-p.engagementCount).slice(0,10)});return{introductionPosts:e(f)}}const Be={en:"introduction",es:"bienvenidas",fa:"ŸÖÿπÿ±ŸÅ€å",km:"·ûÄ·û∂·ûö·ûé·üÇ·ûì·û∂·üÜ",sn:"kuzivisa"};function Or(m){if(!m)return Be.en;const t=m.split("-")[0];return Be[t]||Be.en}function Er(m){const t=Or(m);return t===Be.en?["introduction"]:["introduction",t]}var Rr=P('<svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"></path></svg> <span class="text-muted-foreground"> </span>',1),Tr=P('<svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path></svg> <span class="text-muted-foreground"> </span>',1),Lr=P('<div class="mt-4 p-3 bg-primary-50 dark:bg-primary-900/10 border border-primary-200 dark:border-primary-800 rounded-lg"><div class="flex items-center justify-between"><div class="flex items-center gap-2 text-sm"><!></div> <button class="text-xs px-2 py-1 rounded hover:bg-primary-100 dark:hover:bg-primary-900/20 transition-colors text-primary dark:text-primary font-medium"> </button></div></div>'),Br=P('<div class="text-center py-8 text-muted-foreground"><p> </p></div>'),qr=P('<div class="min-h-screen flex flex-col"><div class="flex-1 px-4 lg:px-8 py-6 max-w-[1400px] mx-auto w-full pb-32 lg:pb-6"><div class="text-center mb-6"><h1 class="text-2xl lg:text-3xl font-bold mb-2"> </h1> <p class="text-muted-foreground"> </p></div> <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:h-[calc(100vh-200px)]"><div class="flex flex-col order-1 lg:order-2"><div class="lg:p-6"><label class="block font-semibold mb-3"> </label> <div class="p-4 bg-card border border rounded-lg"><!></div> <div class="flex items-center justify-between mt-3"><div class="text-xs text-muted-foreground"><!></div> <div class="text-xs"><span> </span></div></div> <!> <div class="hidden lg:flex gap-3 mt-6"><button class="flex-1 py-3 px-6 border border rounded-lg font-medium hover:bg-accent transition-colors"> </button> <button> </button></div></div></div> <div class="flex flex-col order-2 lg:order-1"><h3 class="font-semibold text-sm text-muted-foreground uppercase tracking-wide mb-4"> </h3> <div class="space-y-3 overflow-y-auto flex-1 pr-2 max-h-[400px] lg:max-h-none"><!></div></div></div></div> <div class="lg:hidden fixed bottom-0 left-0 right-0 bg-card border-t border p-4 z-50"><div class="flex gap-3 max-w-[1400px] mx-auto"><button class="flex-1 py-3 px-6 border border rounded-lg font-medium hover:bg-accent transition-colors"> </button> <button> </button></div></div></div>');function Vr(m,t){le(t,!0);const i=()=>qe(Ct,"$locale",u),o=()=>qe($e,"$t",u),[u,l]=Xe();let s=ce(""),f=ce(!1),I=ce(!!t.inviterPubkey);const p=b(()=>e(s).length>10),k=b(()=>e(s).length);let g=ce(null);at(()=>{if(!t.inviterPubkey){Y(g,null);return}be.fetchUser(t.inviterPubkey).then(F=>{F?.fetchProfile().then(q=>{Y(g,q,!0)})})});const y=b(()=>e(g)?.displayName||e(g)?.name||"your inviter"),{introductionPosts:N}=Fr(be,t.inviteRelay);async function x(){if(e(p)){Y(f,!0);try{const F=Er(i());let q=e(s).trim();for(const se of F){const ve=`#${se}`;q.includes(ve)||(q=`${q} ${ve}`)}const oe={content:q,hashtags:F,mentionInviter:e(I)&&t.inviterPubkey?t.inviterPubkey:void 0};ae.setIntroductionText(JSON.stringify(oe)),t.onNext()}catch(F){console.error("Error saving introduction:",F),Y(f,!1)}}}var _=qr(),D=a(_),R=a(D),K=a(R),L=a(K,!0);r(K);var M=n(K,2),v=a(M,!0);r(M),r(R);var w=n(R,2),z=a(w),Z=a(z),H=a(Z),B=a(H,!0);r(H);var O=n(H,2),Q=a(O);{let F=b(()=>o()("onboarding.step5Introduction.placeholder"));wt(Q,{get placeholder(){return e(F)},get disabled(){return e(f)},get value(){return e(s)},set value(q){Y(s,q,!0)}})}r(O);var W=n(O,2),T=a(W),A=a(T);{var V=F=>{var q=ft();U(oe=>h(q,oe),[()=>o()("onboarding.step5Introduction.tipLocation",{values:{location:t.profileData.location}})]),c(F,q)};E(A,F=>{t.profileData.location&&F(V)})}r(T);var X=n(T,2),J=a(X),d=a(J);r(J),r(X),r(W);var C=n(W,2);{var j=F=>{var q=Lr(),oe=a(q),se=a(oe),ve=a(se);{var Me=Pe=>{var Ae=Rr(),Fe=n(ie(Ae),2),We=a(Fe,!0);r(Fe),U(Je=>h(We,Je),[()=>o()("onboarding.step5Introduction.inviterNotify",{values:{name:e(y)}})]),c(Pe,Ae)},ge=Pe=>{var Ae=Tr(),Fe=n(ie(Ae),2),We=a(Fe,!0);r(Fe),U(Je=>h(We,Je),[()=>o()("onboarding.step5Introduction.inviterNoNotify",{values:{name:e(y)}})]),c(Pe,Ae)};E(ve,Pe=>{e(I)?Pe(Me):Pe(ge,!1)})}r(se);var ue=n(se,2);ue.__click=()=>Y(I,!e(I));var je=a(ue,!0);r(ue),r(oe),r(q),U(Pe=>h(je,Pe),[()=>e(I)?o()("onboarding.step5Introduction.inviterRemove"):o()("onboarding.step5Introduction.inviterAddBack")]),c(F,q)};E(C,F=>{t.inviterPubkey&&F(j)})}var ee=n(C,2),re=a(ee);re.__click=function(...F){t.onSkip?.apply(this,F)};var ze=a(re,!0);r(re);var pe=n(re,2);pe.__click=x;var Se=a(pe,!0);r(pe),r(ee),r(Z),r(z);var ke=n(z,2),_e=a(ke),Ue=a(_e,!0);r(_e);var De=n(_e,2),Ie=a(De);{var He=F=>{var q=me(),oe=ie(q);Ke(oe,17,()=>N,se=>se.event.id,(se,ve)=>{yt(se,{get event(){return e(ve).event}})}),c(F,q)},Ye=F=>{var q=Br(),oe=a(q),se=a(oe,!0);r(oe),r(q),U(ve=>h(se,ve),[()=>o()("onboarding.step5Introduction.loadingIntroductions")]),c(F,q)};E(Ie,F=>{N.length>0?F(He):F(Ye,!1)})}r(De),r(ke),r(w),r(D);var ye=n(D,2),Te=a(ye),S=a(Te);S.__click=function(...F){t.onSkip?.apply(this,F)};var G=a(S,!0);r(S);var $=n(S,2);$.__click=x;var fe=a($,!0);r($),r(Te),r(ye),r(_),U((F,q,oe,se,ve,Me,ge,ue,je)=>{h(L,F),h(v,q),h(B,oe),te(J,1,ot(e(k)>500?"text-red-500":"text-muted-foreground")),h(d,`${e(k)??""} ${se??""}`),h(ze,ve),pe.disabled=!e(p)||e(f),te(pe,1,`
                flex-1 py-3 px-6 rounded-lg font-medium transition-all
                ${e(p)&&!e(f)?"bg-background dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-200":"bg-neutral-100 dark:bg-background text-muted-foreground cursor-not-allowed"}
              `),h(Se,Me),h(Ue,ge),h(G,ue),$.disabled=!e(p)||e(f),te($,1,`
          flex-1 py-3 px-6 rounded-lg font-medium transition-all
          ${e(p)&&!e(f)?"bg-background dark:bg-white text-foreground dark:text-black hover:bg-muted dark:hover:bg-neutral-200":"bg-neutral-100 dark:bg-background text-muted-foreground cursor-not-allowed"}
        `),h(fe,je)},[()=>o()("onboarding.step5Introduction.title"),()=>o()("onboarding.step5Introduction.subtitle"),()=>o()("onboarding.step5Introduction.writeLabel"),()=>o()("onboarding.step5Introduction.characters"),()=>o()("onboarding.step5Introduction.skipForNow"),()=>e(f)?o()("onboarding.step5Introduction.publishing"):o()("onboarding.step5Introduction.postIntroduction"),()=>o()("onboarding.step5Introduction.recentIntroductions"),()=>o()("onboarding.step5Introduction.skipForNow"),()=>e(f)?o()("onboarding.step5Introduction.publishing"):o()("onboarding.step5Introduction.postIntroduction")]),c(m,_),de(),l()}we(["click"]);var Kr=P(`<div class="min-h-screen flex items-center justify-center p-8"><div class="max-w-2xl w-full text-center"><div class="text-7xl mb-6">üéâ</div> <h1 class="text-4xl font-bold mb-4"> </h1> <p class="text-xl text-muted-foreground mb-12">Your voice matters. Your community is here.</p> <div class="grid grid-cols-3 gap-4 max-w-lg mx-auto mb-12"><div class="bg-neutral-50 dark:bg-card rounded-xl p-6"><div class="text-3xl font-bold mb-1"> </div> <div class="text-sm text-muted-foreground">People Following</div></div> <div class="bg-neutral-50 dark:bg-card rounded-xl p-6"><div class="text-3xl font-bold mb-1"> </div> <div class="text-sm text-muted-foreground">Follow Packs</div></div> <div class="bg-neutral-50 dark:bg-card rounded-xl p-6"><div class="text-3xl font-bold mb-1">1</div> <div class="text-sm text-muted-foreground">Post Published</div></div></div> <div class="bg-gradient-to-br from-neutral-50 to-neutral-100 dark:from-neutral-900 dark:to-neutral-800 rounded-xl p-8 mb-8 text-left max-w-lg mx-auto"><h3 class="font-semibold mb-4">What's Next?</h3> <ul class="space-y-3 text-sm"><li class="flex items-start gap-3"><span class="text-green-500 mt-0.5">‚úì</span> <span> </span></li> <li class="flex items-start gap-3"><span class="text-green-500 mt-0.5">‚úì</span> <span>You can start buying and selling in the marketplace</span></li> <li class="flex items-start gap-3"><span class="text-green-500 mt-0.5">‚úì</span> <span>Join P2P trades with verified community members</span></li> <li class="flex items-start gap-3"><span class="text-green-500 mt-0.5">‚úì</span> <span>Share your stories and earn sats for valuable content</span></li></ul></div> <button class="bg-background dark:bg-white text-foreground dark:text-black px-12 py-4 rounded-lg font-medium text-lg hover:bg-muted dark:hover:bg-neutral-200 transition-colors">Enter Agora ‚Üí</button></div></div>`);function Hr(m,t){le(t,!0);const i=b(()=>t.selectedPacks.length*25);var o=Kr(),u=a(o),l=n(a(u),2),s=a(l);r(l);var f=n(l,4),I=a(f),p=a(I),k=a(p,!0);r(p),he(2),r(I);var g=n(I,2),y=a(g),N=a(y,!0);r(y),he(2),r(g),he(2),r(f);var x=n(f,2),_=n(a(x),2),D=a(_),R=n(a(D),2),K=a(R);r(R),r(D),he(6),r(_),r(x);var L=n(x,2);L.__click=function(...M){t.onComplete?.apply(this,M)},r(u),r(o),U(()=>{h(s,`Welcome to Agora, ${(t.profileData.name||"Friend")??""}!`),h(k,e(i)),h(N,t.selectedPacks.length),h(K,`Your feed is ready with content from ${e(i)??""} community voices`)}),c(m,o),de()}we(["click"]);var Yr=P('<button class="fixed top-6 left-6 z-50 w-9 h-9 bg-card border border rounded-full flex items-center justify-center hover:bg-accent transition-colors"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"></path></svg></button>'),Wr=P('<div class="min-h-screen bg-card"><div class="fixed top-0 left-0 right-0 z-40 bg-card"><div class="h-1 bg-neutral-200 dark:bg-muted"><div class="h-full bg-background dark:bg-white transition-all duration-300 ease-out"></div></div></div> <!> <div class="relative pt-8"><!> <!> <!> <!> <!> <!></div></div>');function va(m,t){le(t,!0);let i=ce(null);const o=b(()=>ae.currentStep),u=b(()=>ae.totalSteps),l=b(()=>e(o)/e(u)*100),s=b(()=>ae.invite),f=b(()=>ae.hasCompletedInviteSetup),I=b(()=>ae.selectedCommunity),p=b(()=>ae.selectedPacks),k=b(()=>ae.profileData);at(()=>{e(i)||(Y(i,kt.generate(),!0),console.log("[Onboarding] ‚úì Generated new keypair, pubkey:",e(i).pubkey))});function g(d){ae.setStep(d),typeof window<"u"&&window.scrollTo(0,0)}function y(){e(o)>ae.minStep&&g(e(o)-1)}async function N(){g(3)}async function x(){g(5)}async function _(){if(!e(i)){console.error("[Onboarding] ‚úó No signer available");return}try{console.log("[Onboarding] Starting onboarding completion..."),console.log("[Onboarding] Logging in..."),await be.$sessions?.login(e(i)),console.log("[Onboarding] ‚úì Logged in with pubkey:",e(i).pubkey),e(s)&&!e(f)?(console.log("[Onboarding] Invite flow: completing invite setup"),await ae.completeInviteSetup(e(i))):(console.log("[Onboarding] Regular flow: publishing profile and setup"),await ae.publishProfileAndSetup(e(i))),e(p).length>0&&(console.log("[Onboarding] Publishing kind:3 from",e(p).length,"packs"),await St(be,e(p)));const d=ae.introductionText;if(d){console.log("[Onboarding] Publishing introduction post");try{const C=JSON.parse(d),j=new it(be);j.kind=1,j.content=C.content,j.tags=C.hashtags.map(ee=>["t",ee]),C.mentionInviter&&j.tags.push(["p",C.mentionInviter]),await j.publish(),console.log("[Onboarding] ‚úì Published introduction")}catch(C){console.error("[Onboarding] ‚úó Error publishing introduction:",C)}}console.log("[Onboarding] ‚úì Onboarding complete"),ae.clear(),_t("/")}catch(d){console.error("[Onboarding] ‚úó Error during onboarding completion:",d)}}var D=Wr(),R=a(D),K=a(R),L=a(K);r(K),r(R);var M=n(R,2);{var v=d=>{var C=Yr();C.__click=y,c(d,C)};E(M,d=>{e(o)>(e(s)?3:1)&&d(v)})}var w=n(M,2),z=a(w);{var Z=d=>{Dt(d,{get selectedCommunity(){return e(I)},onSelectCommunity:C=>ae.setSelectedCommunity(C),onNext:()=>g(2)})};E(z,d=>{e(o)===1&&!e(s)&&d(Z)})}var H=n(z,2);{var B=d=>{fr(d,{get selectedCommunity(){return e(I)},get selectedPacks(){return e(p)},onSelectPacks:C=>ae.setSelectedPacks(C),onNext:N})};E(H,d=>{e(o)===2&&!e(s)&&d(B)})}var O=n(H,2);{var Q=d=>{mr(d,{onNext:()=>g(4)})};E(O,d=>{e(o)===3&&d(Q)})}var W=n(O,2);{var T=d=>{{let C=b(()=>e(s)?.inviteRelay);Ar(d,{get profileData(){return e(k)},onUpdateProfile:j=>ae.setProfileData(j),onNext:x,get inviteRelay(){return e(C)}})}};E(W,d=>{e(o)===4&&d(T)})}var A=n(W,2);{var V=d=>{{let C=b(()=>e(s)?.inviter),j=b(()=>e(s)?.inviteRelay);Vr(d,{get profileData(){return e(k)},get inviterPubkey(){return e(C)},get inviteRelay(){return e(j)},onNext:()=>g(6),onSkip:()=>g(6)})}};E(A,d=>{e(o)===5&&d(V)})}var X=n(A,2);{var J=d=>{Hr(d,{get selectedPacks(){return e(p)},get profileData(){return e(k)},onComplete:_})};E(X,d=>{e(o)===6&&d(J)})}r(w),r(D),U(()=>Ne(L,`width: ${e(l)}%`)),c(m,D),de()}we(["click"]);export{va as component};
