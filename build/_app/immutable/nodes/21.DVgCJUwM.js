import"../chunks/DsnmJJEf.js";import{p as Ce,u as ze,i as u,s as Fe,b as Ne,g as e,t as H,e as s,h as Se,j as M,k as o,a as p,r as n,l as N,L as Te,c as S,f as w}from"../chunks/Bq750rDx.js";import{i as y}from"../chunks/BcjopvHb.js";import{e as Y}from"../chunks/Cjcfrngr.js";import{c as Ue}from"../chunks/uSFILAY7.js";import{s as je,a as He}from"../chunks/wxUnewq1.js";import{p as Ie}from"../chunks/CFwZN-iQ.js";import{N as _,n as P,s as Ve,d as Be}from"../chunks/CdRP5_sk.js";import{s as oe}from"../chunks/DJZteyxf.js";import{A as Ke}from"../chunks/Bt6DpIqu.js";import{N as Pe}from"../chunks/CPZq7sH0.js";import{A as De,M as Ee}from"../chunks/CK7OhTnQ.js";import{c as Z,L as ne}from"../chunks/DseJecSJ.js";import{M as Ge}from"../chunks/B3EHOrbg.js";import{g as qe}from"../chunks/DAOE6Nme.js";var Je=u('<div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div>',1),Oe=u('<a class="flex items-center gap-3 hover:bg-muted/50 rounded-lg p-2 transition-colors"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-neutral-500"> </div></div></a>'),Qe=u('<div class="p-4 bg-card rounded-lg border border-border"><div class="flex items-center gap-2 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <h2 class="text-lg font-semibold text-foreground">Top Authors</h2></div> <div class="space-y-3"><!></div></div>'),Re=u('<div class="p-8 text-center text-neutral-400"> </div>'),We=u('<div class="p-8 text-center text-neutral-400">Loading articles...</div>'),Xe=u("<!> <!>",1),Ye=u('<div class="p-8 text-center text-neutral-400"> </div>'),Ze=u('<div class="p-8 text-center text-neutral-400"> </div>'),$e=u('<div class="p-4"><!></div>'),et=u('<div class="p-8 text-center text-neutral-400">Connecting to relays...</div>'),tt=u('<div class="p-8 text-center text-neutral-400"> </div>'),rt=u('<div class="p-8 text-center text-neutral-400">Loading notes...</div>'),at=u("<!> <!>",1),st=u('<div class="max-w-full mx-auto"><div class="sticky top-0 z-10 bg-background/90 backdrop-blur-xl border-b border-border/50"><div class="px-4 py-4"><div class="flex items-center gap-3"><a href="/" class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-neutral-800 transition-colors" aria-label="Back to home"><svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></a> <div><h1 class="text-xl font-bold text-foreground flex items-center gap-2"><span class="text-primary">#</span> </h1> <p class="text-sm text-neutral-400"> </p></div></div></div> <!></div> <div class="divide-y divide-neutral-800/50"><!></div></div>');function bt(de,le){Ce(le,!0);const ve=()=>He(Ie,"$page",ce),[ce,ge]=je(),fe=t=>{var r=Qe(),c=M(o(r),2),I=o(c);{var V=i=>{var d=Je();Te(4),s(i,d)},h=i=>{var d=S(),A=w(d);Y(A,17,()=>e(te),({pubkey:C,count:g})=>C,(C,g)=>{let a=()=>e(g).pubkey,l=()=>e(g).count;var x=Oe(),b=o(x);Ke(b,{get ndk(){return P},get pubkey(){return a()},class:"w-10 h-10 rounded-full flex-shrink-0"});var m=M(b,2),f=o(m),k=o(f);n(f);var j=M(f,2),R=o(j);n(j),n(m),n(x),H((W,F)=>{Ue(x,"href",W),N(k,`${F??""}...`),N(R,`${l()??""} ${l()===1?"post":"posts"}`)},[()=>qe(a()),()=>a().slice(0,16)]),s(C,x)}),s(i,d)};y(I,i=>{e(te).length===0?i(V):i(h,!1)})}n(c),n(r),s(t,r)};let v=Ne("conversations");const z=p(()=>ve().params.hashtag),T=p(()=>Ve.relays.filter(t=>t.enabled&&t.read).map(t=>t.url)),U=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Text],"#t":[t.toLowerCase()],limit:200}],relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:20,pageSize:20}),B=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Text,_.Image,_.Video,_.ShortVideo],"#t":[t.toLowerCase()],limit:300}],relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:30,pageSize:30}),L=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Article],"#t":[t.toLowerCase()],limit:100}],cacheUsage:1,relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:10,pageSize:10}),ue=p(()=>L.events.map(t=>Be.from(t))),D=p(()=>e(ue).filter(t=>t.title&&t.content).sort((t,r)=>(r.published_at??r.created_at??0)-(t.published_at??t.created_at??0)));function $(t,r){return(r==="image"?/(https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg|avif))/gi:/(https?:\/\/[^\s]+\.(mp4|webm|mov|avi|mkv))/gi).test(t)}const E=p(()=>e(v)==="images"?B.events.filter(t=>t.kind===_.Image||t.kind===_.Text&&$(t.content,"image")):e(v)==="videos"?B.events.filter(t=>t.kind===_.Video||t.kind===_.ShortVideo||t.kind===_.Text&&$(t.content,"video")):[]),G=p(()=>e(v)==="articles"?[]:U.events),me=p(()=>e(v)==="articles"?L.eosed:U.eosed),pe=p(()=>(e(v)==="articles","connected")),_e=p(()=>e(v)==="articles"?L.hasMore:U.hasMore),he=p(()=>e(v)==="articles"?L.isLoading:U.isLoading);function ee(){e(v)==="articles"?L.loadMore():U.loadMore()}const te=p(()=>{const t=new Map;return[...U.events,...B.events,...L.events].forEach(r=>{const c=t.get(r.pubkey)||0;t.set(r.pubkey,c+1)}),Array.from(t.entries()).sort((r,c)=>c[1]-r[1]).slice(0,5).map(([r,c])=>({pubkey:r,count:c}))});ze(()=>(oe.rightSidebar=fe,()=>{oe.clear()}));var q=st(),J=o(q),O=o(J),re=o(O),ae=M(o(re),2),Q=o(ae),xe=M(o(Q));n(Q);var se=M(Q,2),be=o(se);n(se),n(ae),n(re),n(O);var ke=M(O,2);Ge(ke,{get selectedFilter(){return e(v)},onFilterChange:t=>Fe(v,t,!0)}),n(J);var ie=M(J,2),Me=o(ie);{var we=t=>{var r=Xe(),c=w(r);{var I=i=>{var d=Re(),A=o(d);n(d),H(()=>N(A,`No articles found with #${e(z)??""}`)),s(i,d)},V=i=>{var d=S(),A=w(d);{var C=a=>{var l=We();s(a,l)},g=a=>{var l=S(),x=w(l);Y(x,17,()=>e(D),b=>b.id,(b,m)=>{De(b,{get article(){return e(m)}})}),s(a,l)};y(A,a=>{e(D).length===0?a(C):a(g,!1)},!0)}s(i,d)};y(c,i=>{e(D).length===0&&L.eosed?i(I):i(V,!1)})}var h=M(c,2);ne(h,{onIntersect:ee,get hasMore(){return L.hasMore},get isLoading(){return L.isLoading}}),s(t,r)},ye=t=>{var r=S(),c=w(r);{var I=h=>{var i=$e(),d=o(i);{var A=g=>{var a=Ye(),l=o(a);n(a),H(()=>N(l,`No ${e(v)??""} found with #${e(z)??""}`)),s(g,a)},C=g=>{var a=S(),l=w(a);{var x=m=>{var f=Ze(),k=o(f);n(f),H(()=>N(k,`Loading ${e(v)??""}...`)),s(m,f)},b=m=>{Ee(m,{get events(){return e(E)}})};y(l,m=>{e(E).length===0?m(x):m(b,!1)},!0)}s(g,a)};y(d,g=>{e(E).length===0&&B.eosed?g(A):g(C,!1)})}n(i),s(h,i)},V=h=>{var i=at(),d=w(i);{var A=a=>{var l=et();s(a,l)},C=a=>{var l=S(),x=w(l);{var b=f=>{var k=tt(),j=o(k);n(k),H(()=>N(j,`No notes found with #${e(z)??""}`)),s(f,k)},m=f=>{var k=S(),j=w(k);{var R=F=>{var K=rt();s(F,K)},W=F=>{var K=S(),Le=w(K);Y(Le,17,()=>e(G),X=>X.id,(X,Ae)=>{Pe(X,{get event(){return e(Ae)}})}),s(F,K)};y(j,F=>{e(G).length===0?F(R):F(W,!1)},!0)}s(f,k)};y(x,f=>{e(G).length===0&&e(me)?f(b):f(m,!1)},!0)}s(a,l)};y(d,a=>{e(pe)==="connecting"?a(A):a(C,!1)})}var g=M(d,2);ne(g,{onIntersect:ee,get hasMore(){return e(_e)},get isLoading(){return e(he)}}),s(h,i)};y(c,h=>{e(v)==="images"||e(v)==="videos"?h(I):h(V,!1)},!0)}s(t,r)};y(Me,t=>{e(v)==="articles"?t(we):t(ye,!1)})}n(ie),n(q),H(()=>{N(xe,` ${e(z)??""}`),N(be,`Posts tagged with #${e(z)??""}`)}),s(de,q),Se(),ge()}export{bt as component};
