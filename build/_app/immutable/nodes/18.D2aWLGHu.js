import{f as u,c as Y,a as l,s as x,d as vt}from"../chunks/rzUyzf2y.js";import{p as Ke,u as ve,s as _,b as B,e as r,f as z,d as n,g as e,r as t,t as y,c as Se,a as H}from"../chunks/AsQG98fS.js";import{i as m}from"../chunks/DZKExFZC.js";import{e as Ee}from"../chunks/Cztbr3Ea.js";import{c as de}from"../chunks/Dt3q2Svx.js";import{a as Z,c as ue}from"../chunks/CS0aOiUg.js";import{s as dt,a as ut}from"../chunks/DfBYFC16.js";import{n as A,a as ct,N as ft}from"../chunks/tv6-RHC_.js";import{p as mt}from"../chunks/BcDbBYPM.js";import{g as Me}from"../chunks/s53o-P2j.js";import{t as je}from"../chunks/D7cSTCXZ.js";import{f as He}from"../chunks/WdaJccXC.js";import{c as ne}from"../chunks/C-PpeXlo.js";import{m as pt}from"../chunks/C6SIxCTZ.js";import{U as ce}from"../chunks/C-S0GgRw.js";import{N as _t}from"../chunks/Cxhu68Im.js";import{C as gt}from"../chunks/C8nOEIkG.js";import{p as le}from"../chunks/w-gpJwMz.js";import{F as bt}from"../chunks/Cp2_visM.js";import{f as ht}from"../chunks/KSN4Ur19.js";import{g as Ie}from"../chunks/HXYFdwja.js";var xt=u('<p class="text-sm text-muted-foreground truncate"> </p>'),kt=u('<a class="block group"><h4 class="font-semibold text-foreground group-hover:text-primary transition-colors truncate"> </h4> <!></a>'),wt=u('<p class="text-sm text-muted-foreground truncate"> </p>'),yt=u('<h4 class="font-semibold text-foreground truncate"> </h4> <!>',1),Ft=u("<span> </span>"),Pt=u("<span>â€¢</span>"),At=u('<!> <span>Invited by <a class="text-primary hover:underline"> </a></span>',1),Mt=u('<div class="flex items-center gap-2 mt-1 text-xs text-muted-foreground"><!> <!></div>'),jt=u('<p class="mt-2 text-sm text-foreground/80 line-clamp-2"> </p>'),Ct=u('<div class="flex-shrink-0"><!></div>'),Ut=u('<div><!> <div class="flex-1 min-w-0"><div class="flex items-start justify-between gap-2"><div class="flex-1 min-w-0"><!> <!> <!></div> <!></div></div></div>');function Nt(fe,p){Ke(p,!0);let me=le(p,"showFollow",3,!0),pe=le(p,"showAbout",3,!0),_e=le(p,"clickable",3,!0),G=le(p,"class",3,""),F=B(void 0),g=B(null),s=B(void 0),M=B(null);ve(()=>{A.fetchUser(p.pubkey).then(v=>{_(F,v,!0),v?.fetchProfile().then(d=>{_(g,d,!0)})})}),ve(()=>{if(!p.inviterPubkey){_(s,void 0),_(M,null);return}A.fetchUser(p.inviterPubkey).then(v=>{_(s,v,!0),v?.fetchProfile().then(d=>{_(M,d,!0)})})});var k=Ut(),I=r(k);de(I,()=>ce.Root,(v,d)=>{d(v,{get ndk(){return A},get pubkey(){return p.pubkey},children:(c,C)=>{var j=Y(),U=z(j);de(U,()=>ce.Avatar,(f,o)=>{o(f,{class:"w-12 h-12 rounded-full"})}),l(c,j)},$$slots:{default:!0}})});var O=n(I,2),$=r(O),K=r($),S=r(K);{var ge=v=>{var d=kt(),c=r(d),C=r(c,!0);t(c);var j=n(c,2);{var U=f=>{var o=xt(),b=r(o,!0);t(o),y(()=>x(b,e(g).nip05)),l(f,o)};m(j,f=>{e(g)?.nip05&&f(U)})}t(d),y(()=>{ue(d,"href",`/p/${e(F).npub??""}`),x(C,e(g)?.displayName||e(g)?.name||"Anon")}),l(v,d)},be=v=>{var d=yt(),c=z(d),C=r(c,!0);t(c);var j=n(c,2);{var U=f=>{var o=wt(),b=r(o,!0);t(o),y(()=>x(b,e(g).nip05)),l(f,o)};m(j,f=>{e(g)?.nip05&&f(U)})}y(()=>x(C,e(g)?.displayName||e(g)?.name||"Anon")),l(v,d)};m(S,v=>{_e()?v(ge):v(be,!1)})}var ee=n(S,2);{var te=v=>{var d=Mt(),c=r(d);{var C=f=>{var o=Ft(),b=r(o);t(o),y(N=>x(b,`Joined ${N??""}`),[()=>ht(p.joinedAt)]),l(f,o)};m(c,f=>{p.joinedAt&&f(C)})}var j=n(c,2);{var U=f=>{var o=At(),b=z(o);{var N=w=>{var E=Pt();l(w,E)};m(b,w=>{p.joinedAt&&w(N)})}var L=n(b,2),D=n(r(L)),P=r(D,!0);t(D),t(L),y(()=>{ue(D,"href",`/p/${e(s)?.npub??""}`),x(P,e(M).displayName||e(M).name||"someone")}),l(f,o)};m(j,f=>{p.inviterPubkey&&e(M)&&f(U)})}t(d),l(v,d)};m(ee,v=>{(p.joinedAt||p.inviterPubkey)&&v(te)})}var he=n(ee,2);{var Q=v=>{var d=jt(),c=r(d,!0);t(d),y(()=>x(c,e(g).about)),l(v,d)};m(he,v=>{pe()&&e(g)?.about&&v(Q)})}t(K);var W=n(K,2);{var re=v=>{var d=Ct(),c=r(d);bt(c,{get ndk(){return A},get target(){return p.pubkey}}),t(d),l(v,d)};m(W,v=>{me()&&v(re)})}t($),t(O),t(k),y(()=>Z(k,1,`flex items-start gap-3 p-4 bg-card rounded-lg border border-border hover:border-primary/30 transition-colors ${G()??""}`)),l(fe,k),Se()}var Bt=u('<div class="h-48 w-full"><img class="w-full h-full object-cover"/></div>'),qt=u('<button class="flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button>'),zt=u('<button class="flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary/90 disabled:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg> </button>'),Lt=u('<div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span> </span></div>'),Dt=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Et=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Ht=u('<div class="p-8 text-center text-muted-foreground">Loading notes from pack members...</div>'),It=u('<div class="p-8 text-center text-muted-foreground">No notes found from pack members</div>'),Kt=u('<div class="divide-y divide-neutral-800/50 border-y border-border"><!></div>'),St=u('<div class="grid gap-4 md:grid-cols-2"></div>'),Tt=u('<div class="bg-card border border-border rounded-xl overflow-hidden mb-6"><!> <div class="p-6"><div class="flex items-start justify-between mb-4"><div><h1 class="text-2xl font-bold text-foreground mb-2 svelte-1xwqwht"> </h1> <p class="text-muted-foreground"> </p></div> <div class="flex items-center gap-2"><!> <button><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg></button></div></div> <div class="flex items-center gap-6 mb-6 text-sm"><div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <span> </span></div> <!></div> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0"><!></button> <div><p class="text-sm text-muted-foreground">Created by</p> <button class="font-medium text-foreground hover:text-primary transition-colors"> </button></div></div></div></div> <div class="border-b border-border mb-6"><div class="flex gap-6"><button>Feed <!></button> <button> <!></button></div></div> <!>',1),Vt=u('<div class="text-center py-12"><div class="inline-block w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mb-4"></div> <p class="text-muted-foreground">Loading follow pack...</p></div>'),Rt=u('<div class="text-center py-12"><p class="text-muted-foreground">Follow pack not found</p> <button class="text-primary hover:text-primary/90 mt-4 inline-block transition-colors">Browse all packs</button></div>'),Jt=u('<div class="pack-detail-container svelte-1xwqwht"><div class="pack-header svelte-1xwqwht"><button class="back-btn svelte-1xwqwht"><svg class="w-6 h-6 svelte-1xwqwht" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="svelte-1xwqwht"> </h1></div> <div class="pack-content svelte-1xwqwht"><!> <!></div></div>');function fr(fe,p){Ke(p,!0);const me=()=>ut(mt,"$page",pe),[pe,_e]=dt(),G=H(()=>me().params.packId);let F=B("feed"),g=B(!1),s=B(null),M=B(!0);ve(()=>{e(G)&&(_(M,!0),A.fetchEvent(e(G)).then(o=>{o?_(s,ct.from(o),!0):_(s,pt.find(b=>b.encode()===e(G))||null,!0),_(M,!1)}).catch(o=>{console.error("Failed to fetch pack:",o),_(M,!1)}))});let k=H(()=>e(s)?.pubkeys||[]),I=B(null);ve(()=>{if(!e(s)?.author){_(I,null);return}e(s).author.fetchProfile().then(o=>{_(I,o,!0)})});let O=H(()=>e(s)?He.isFavorite(e(s).id):!1),$=H(()=>e(s)&&A.$currentUser?e(s).pubkey===A.$currentUser.pubkey:!1);const K=H(()=>e(F)==="feed"&&e(k).length>0?(console.log(`[FollowPackDetail] Creating subscription for ${e(k).length} members`),A.$subscribe(()=>({filters:[{kinds:[ft.Text],authors:e(k),limit:50}],bufferMs:100}))):null),S=H(()=>e(K)?.events||[]),ge=H(()=>e(K)?.eosed||!1);function be(){e(s)&&He.toggleFavorite(e(s).id)}async function ee(){if(!e(s)||!A.activeUser||e(k).length===0){je.error("Please login to follow users");return}_(g,!0);try{je.success(`Following ${e(k).length} users`),A.$follows.add(e(k))}catch(o){console.error("Error following all users:",o),je.error("Failed to follow users")}finally{_(g,!1)}}function te(){Me("/packs")}function he(){e(s)&&ne.open(e(s))}var Q=Jt(),W=r(Q),re=r(W);re.__click=te;var v=n(re,2),d=r(v,!0);t(v),t(W);var c=n(W,2),C=r(c);{var j=o=>{var b=Tt(),N=z(b),L=r(N);{var D=a=>{var i=Bt(),h=r(i);t(i),y(()=>{ue(h,"src",e(s).image),ue(h,"alt",e(s).title)}),l(a,i)};m(L,a=>{e(s).image&&a(D)})}var P=n(L,2),w=r(P),E=r(w),xe=r(E),Te=r(xe,!0);t(xe);var Ce=n(xe,2),Ve=r(Ce,!0);t(Ce),t(E);var Ue=n(E,2),Ne=r(Ue);{var Re=a=>{var i=qt();i.__click=he,l(a,i)},Je=a=>{var i=zt();i.__click=ee;var h=n(r(i));t(i),y(()=>{i.disabled=e(g),x(h,` ${e(g)?"Following...":"Follow All"}`)}),l(a,i)};m(Ne,a=>{e($)?a(Re):a(Je,!1)})}var oe=n(Ne,2);oe.__click=be;var Ge=r(oe);t(oe),t(Ue),t(w);var ke=n(w,2),we=r(ke),Be=n(r(we),2),Oe=r(Be);t(Be),t(we);var Qe=n(we,2);{var We=a=>{var i=Lt(),h=n(r(i),2),T=r(h);t(h),t(i),y(V=>x(T,`Updated ${V??""}`),[()=>new Date(e(s).created_at*1e3).toLocaleDateString()]),l(a,i)};m(Qe,a=>{e(s).created_at&&a(We)})}t(ke);var qe=n(ke,2),ae=r(qe);ae.__click=()=>Me(Ie(e(s).pubkey));var Xe=r(ae);de(Xe,()=>ce.Root,(a,i)=>{i(a,{get ndk(){return A},get pubkey(){return e(s).pubkey},children:(h,T)=>{var V=Y(),q=z(V);de(q,()=>ce.Avatar,(R,Pe)=>{Pe(R,{class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity"})}),l(h,V)},$$slots:{default:!0}})}),t(ae);var ze=n(ae,2),ye=n(r(ze),2);ye.__click=()=>Me(Ie(e(s).pubkey));var Ye=r(ye,!0);t(ye),t(ze),t(qe),t(P),t(N);var Fe=n(N,2),Le=r(Fe),X=r(Le);X.__click=()=>_(F,"feed");var Ze=n(r(X));{var $e=a=>{var i=Dt();l(a,i)};m(Ze,a=>{e(F)==="feed"&&a($e)})}t(X);var se=n(X,2);se.__click=()=>_(F,"members");var De=r(se),et=n(De);{var tt=a=>{var i=Et();l(a,i)};m(et,a=>{e(F)==="members"&&a(tt)})}t(se),t(Le),t(Fe);var rt=n(Fe,2);{var ot=a=>{var i=Kt(),h=r(i);{var T=q=>{var R=Ht();l(q,R)},V=q=>{var R=Y(),Pe=z(R);{var st=J=>{var ie=It();l(J,ie)},it=J=>{var ie=Y(),nt=z(ie);Ee(nt,17,()=>e(S),Ae=>Ae.id,(Ae,lt)=>{_t(Ae,{get event(){return e(lt)}})}),l(J,ie)};m(Pe,J=>{e(S).length===0?J(st):J(it,!1)},!0)}l(q,R)};m(h,q=>{e(S).length===0&&!e(ge)?q(T):q(V,!1)})}t(i),l(a,i)},at=a=>{var i=St();Ee(i,20,()=>e(k),h=>h,(h,T)=>{Nt(h,{get pubkey(){return T}})}),t(i),l(a,i)};m(rt,a=>{e(F)==="feed"?a(ot):a(at,!1)})}y(()=>{x(Te,e(s).title),x(Ve,e(s).description||"A curated list of accounts to follow"),Z(oe,1,`p-2.5 rounded-lg transition-colors ${e(O)?"bg-red-500/10 text-red-500":"bg-muted text-muted-foreground hover:text-foreground"}`),Z(Ge,0,`w-5 h-5 ${e(O)?"fill-current":""}`),x(Oe,`${e(k).length??""} members`),x(Ye,e(I)?.name||"Anonymous"),Z(X,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="feed"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),Z(se,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="members"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),x(De,`Members (${e(k).length??""}) `)}),l(o,b)},U=o=>{var b=Y(),N=z(b);{var L=P=>{var w=Vt();l(P,w)},D=P=>{var w=Rt(),E=n(r(w),2);E.__click=te,t(w),l(P,w)};m(N,P=>{e(M)?P(L):P(D,!1)},!0)}l(o,b)};m(C,o=>{e(s)?o(j):o(U,!1)})}var f=n(C,2);gt(f,{get editingPack(){return ne.data},get open(){return ne.show},set open(o){ne.show=o}}),t(c),t(Q),y(()=>x(d,e(s)?.title||"Follow Pack")),l(fe,Q),Se(),_e()}vt(["click"]);export{fr as component};
