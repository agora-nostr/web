import{f as u,a as s,s as N,c as z}from"../chunks/rzUyzf2y.js";import{p as Ne,u as Se,s as Te,b as je,g as e,t as P,c as He,d as w,e as o,a as p,r as n,y as Ie,f as _}from"../chunks/AsQG98fS.js";import{i as L}from"../chunks/DZKExFZC.js";import{e as Z}from"../chunks/Cztbr3Ea.js";import{c as de}from"../chunks/Dt3q2Svx.js";import{c as Pe}from"../chunks/CS0aOiUg.js";import{s as Ve,a as Be}from"../chunks/DfBYFC16.js";import{p as Ke}from"../chunks/BcDbBYPM.js";import{N as h,n as E,s as De,d as Ee}from"../chunks/tv6-RHC_.js";import{s as le}from"../chunks/CxDZk1z_.js";import{U as ve}from"../chunks/C-S0GgRw.js";import{N as Ge}from"../chunks/Cxhu68Im.js";import{M as Re,A as qe}from"../chunks/B98jEbhe.js";import{M as Je}from"../chunks/DSSpNA08.js";import{c as $,L as ce}from"../chunks/iWJgxq80.js";import{g as Oe}from"../chunks/HXYFdwja.js";var Qe=u('<div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div>',1),We=u('<a class="flex items-center gap-3 hover:bg-muted/50 rounded-lg p-2 transition-colors"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-neutral-500"> </div></div></a>'),Xe=u('<div class="p-4 bg-card rounded-lg border border-border"><div class="flex items-center gap-2 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <h2 class="text-lg font-semibold text-foreground">Top Authors</h2></div> <div class="space-y-3"><!></div></div>'),Ye=u('<div class="p-8 text-center text-neutral-400"> </div>'),Ze=u('<div class="p-8 text-center text-neutral-400">Loading articles...</div>'),$e=u("<!> <!>",1),et=u('<div class="p-8 text-center text-neutral-400"> </div>'),tt=u('<div class="p-8 text-center text-neutral-400"> </div>'),rt=u('<div class="p-4"><!></div>'),at=u('<div class="p-8 text-center text-neutral-400">Connecting to relays...</div>'),st=u('<div class="p-8 text-center text-neutral-400"> </div>'),it=u('<div class="p-8 text-center text-neutral-400">Loading notes...</div>'),ot=u("<!> <!>",1),nt=u('<div class="max-w-full mx-auto"><div class="sticky top-0 z-10 bg-background/90 backdrop-blur-xl border-b border-border/50"><div class="px-4 py-4"><div class="flex items-center gap-3"><a href="/" class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-neutral-800 transition-colors" aria-label="Back to home"><svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></a> <div><h1 class="text-xl font-bold text-foreground flex items-center gap-2"><span class="text-primary">#</span> </h1> <p class="text-sm text-neutral-400"> </p></div></div></div> <!></div> <div class="divide-y divide-neutral-800/50"><!></div></div>');function wt(fe,ge){Ne(ge,!0);const ue=()=>Be(Ke,"$page",me),[me,pe]=Ve(),_e=t=>{var r=Xe(),c=w(o(r),2),V=o(c);{var B=i=>{var d=Qe();Ie(4),s(i,d)},x=i=>{var d=z(),A=_(d);Z(A,17,()=>e(re),({pubkey:U,count:f})=>U,(U,f)=>{let a=()=>e(f).pubkey,l=()=>e(f).count;var b=We(),k=o(b);de(k,()=>ve.Root,(K,y)=>{y(K,{get ndk(){return E},get pubkey(){return a()},children:(H,ne)=>{var I=z(),Y=_(I);de(Y,()=>ve.Avatar,(ze,Fe)=>{Fe(ze,{class:"w-10 h-10 rounded-full flex-shrink-0"})}),s(H,I)},$$slots:{default:!0}})});var m=w(k,2),g=o(m),M=o(g);n(g);var j=w(g,2),X=o(j);n(j),n(m),n(b),P((K,y)=>{Pe(b,"href",K),N(M,`${y??""}...`),N(X,`${l()??""} ${l()===1?"post":"posts"}`)},[()=>Oe(a()),()=>a().slice(0,16)]),s(U,b)}),s(i,d)};L(V,i=>{e(re).length===0?i(B):i(x,!1)})}n(c),n(r),s(t,r)};let v=je("conversations");const F=p(()=>ue().params.hashtag),S=p(()=>De.relays.filter(t=>t.enabled&&t.read).map(t=>t.url)),T=$(E,()=>{const t=e(F);return{filters:[{kinds:[h.Text],"#t":[t.toLowerCase()],limit:200}],relayUrls:e(S).length>0?e(S):void 0}},{initialLimit:20,pageSize:20}),D=$(E,()=>{const t=e(F);return{filters:[{kinds:[h.Text,h.Image,h.Video,h.ShortVideo],"#t":[t.toLowerCase()],limit:300}],relayUrls:e(S).length>0?e(S):void 0}},{initialLimit:30,pageSize:30}),C=$(E,()=>{const t=e(F);return{filters:[{kinds:[h.Article],"#t":[t.toLowerCase()],limit:100}],cacheUsage:1,relayUrls:e(S).length>0?e(S):void 0}},{initialLimit:10,pageSize:10}),he=p(()=>C.events.map(t=>Ee.from(t))),G=p(()=>e(he).filter(t=>t.title&&t.content).sort((t,r)=>(r.published_at??r.created_at??0)-(t.published_at??t.created_at??0)));function ee(t,r){return(r==="image"?/(https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg|avif))/gi:/(https?:\/\/[^\s]+\.(mp4|webm|mov|avi|mkv))/gi).test(t)}const R=p(()=>e(v)==="images"?D.events.filter(t=>t.kind===h.Image||t.kind===h.Text&&ee(t.content,"image")):e(v)==="videos"?D.events.filter(t=>t.kind===h.Video||t.kind===h.ShortVideo||t.kind===h.Text&&ee(t.content,"video")):[]),q=p(()=>e(v)==="articles"?[]:T.events),xe=p(()=>e(v)==="articles"?C.eosed:T.eosed),be=p(()=>(e(v)==="articles","connected")),ke=p(()=>e(v)==="articles"?C.hasMore:T.hasMore),Me=p(()=>e(v)==="articles"?C.isLoading:T.isLoading);function te(){e(v)==="articles"?C.loadMore():T.loadMore()}const re=p(()=>{const t=new Map;return[...T.events,...D.events,...C.events].forEach(r=>{const c=t.get(r.pubkey)||0;t.set(r.pubkey,c+1)}),Array.from(t.entries()).sort((r,c)=>c[1]-r[1]).slice(0,5).map(([r,c])=>({pubkey:r,count:c}))});Se(()=>(le.rightSidebar=_e,()=>{le.clear()}));var J=nt(),O=o(J),Q=o(O),ae=o(Q),se=w(o(ae),2),W=o(se),ye=w(o(W));n(W);var ie=w(W,2),we=o(ie);n(ie),n(se),n(ae),n(Q);var Le=w(Q,2);Re(Le,{get selectedFilter(){return e(v)},onFilterChange:t=>Te(v,t,!0)}),n(O);var oe=w(O,2),Ce=o(oe);{var Ae=t=>{var r=$e(),c=_(r);{var V=i=>{var d=Ye(),A=o(d);n(d),P(()=>N(A,`No articles found with #${e(F)??""}`)),s(i,d)},B=i=>{var d=z(),A=_(d);{var U=a=>{var l=Ze();s(a,l)},f=a=>{var l=z(),b=_(l);Z(b,17,()=>e(G),k=>k.id,(k,m)=>{qe(k,{get article(){return e(m)}})}),s(a,l)};L(A,a=>{e(G).length===0?a(U):a(f,!1)},!0)}s(i,d)};L(c,i=>{e(G).length===0&&C.eosed?i(V):i(B,!1)})}var x=w(c,2);ce(x,{onIntersect:te,get hasMore(){return C.hasMore},get isLoading(){return C.isLoading}}),s(t,r)},Ue=t=>{var r=z(),c=_(r);{var V=x=>{var i=rt(),d=o(i);{var A=f=>{var a=et(),l=o(a);n(a),P(()=>N(l,`No ${e(v)??""} found with #${e(F)??""}`)),s(f,a)},U=f=>{var a=z(),l=_(a);{var b=m=>{var g=tt(),M=o(g);n(g),P(()=>N(M,`Loading ${e(v)??""}...`)),s(m,g)},k=m=>{Je(m,{get events(){return e(R)}})};L(l,m=>{e(R).length===0?m(b):m(k,!1)},!0)}s(f,a)};L(d,f=>{e(R).length===0&&D.eosed?f(A):f(U,!1)})}n(i),s(x,i)},B=x=>{var i=ot(),d=_(i);{var A=a=>{var l=at();s(a,l)},U=a=>{var l=z(),b=_(l);{var k=g=>{var M=st(),j=o(M);n(M),P(()=>N(j,`No notes found with #${e(F)??""}`)),s(g,M)},m=g=>{var M=z(),j=_(M);{var X=y=>{var H=it();s(y,H)},K=y=>{var H=z(),ne=_(H);Z(ne,17,()=>e(q),I=>I.id,(I,Y)=>{Ge(I,{get event(){return e(Y)}})}),s(y,H)};L(j,y=>{e(q).length===0?y(X):y(K,!1)},!0)}s(g,M)};L(b,g=>{e(q).length===0&&e(xe)?g(k):g(m,!1)},!0)}s(a,l)};L(d,a=>{e(be)==="connecting"?a(A):a(U,!1)})}var f=w(d,2);ce(f,{onIntersect:te,get hasMore(){return e(ke)},get isLoading(){return e(Me)}}),s(x,i)};L(c,x=>{e(v)==="images"||e(v)==="videos"?x(V):x(B,!1)},!0)}s(t,r)};L(Ce,t=>{e(v)==="articles"?t(Ae):t(Ue,!1)})}n(oe),n(J),P(()=>{N(ye,` ${e(F)??""}`),N(we,`Posts tagged with #${e(F)??""}`)}),s(fe,J),He(),pe()}export{wt as component};
