import{d as ne,f as l,a as i,s as C}from"../chunks/rzUyzf2y.js";import{p as ie,b as T,x as le,u as H,g as r,a as L,s as m,c as de,e as n,r as s,d as p,t as j,y as V}from"../chunks/AsQG98fS.js";import{i as f}from"../chunks/DZKExFZC.js";import{e as ve}from"../chunks/Cztbr3Ea.js";import{r as ce,s as ue}from"../chunks/CS0aOiUg.js";import{n as D,A as pe}from"../chunks/tv6-RHC_.js";import{h as S}from"../chunks/BVrYKRgp.js";import{f as me}from"../chunks/KSN4Ur19.js";import{P as fe}from"../chunks/C6xvd7Uj.js";const ge=x=>{fe(x,{title:"My Invites",subtitle:"View and manage invites you've sent to join Agora"})};var xe=l('<div class="text-center py-12"><div class="w-16 h-16 bg-neutral-200 dark:bg-neutral-800 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 19v-8.93a2 2 0 01.89-1.664l7-4.666a2 2 0 012.22 0l7 4.666A2 2 0 0121 10.07V19M3 19a2 2 0 002 2h14a2 2 0 002-2M3 19l6.75-4.5M21 19l-6.75-4.5M3 10l6.75 4.5M21 10l-6.75 4.5m0 0l-1.14.76a2 2 0 01-2.22 0l-1.14-.76"></path></svg></div> <h3 class="text-lg font-semibold text-foreground mb-2">No invites yet</h3> <p class="text-sm text-muted-foreground">Create your first invite to start sharing Agora with others</p></div>'),he=l('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 dark:bg-primary-900/30 text-primary-800 dark:text-primary-400"><svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg> Personalized</span>'),_e=l('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-muted text-neutral-800 dark:text-neutral-400">General Invite</span>'),ke=l('<h3 class="text-lg font-semibold text-foreground mb-1"> </h3>'),be=l('<div class="mb-4 p-3 bg-neutral-50 dark:bg-neutral-800 rounded-lg"><p class="text-sm text-foreground whitespace-pre-wrap line-clamp-3"> </p></div>'),ye=l('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span>Copied!</span>',1),we=l('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> <span>Copy</span>',1),Me=l('<div class="bg-white dark:bg-neutral-900 rounded-xl border border-neutral-200 dark:border-neutral-800 p-6"><div class="flex items-start justify-between mb-4"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><!></div> <!> <p class="text-sm text-neutral-500 dark:text-neutral-400"> </p></div> <button class="p-2 text-neutral-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors" title="Delete invite"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div> <!> <div class="bg-muted rounded-lg p-3 flex items-center space-x-2"><input type="text" readonly="" class="flex-1 bg-transparent text-sm text-foreground outline-none truncate"/> <button class="px-3 py-1.5 bg-primary hover:bg-primary-700 text-white rounded-lg transition-colors flex items-center space-x-1 text-sm flex-shrink-0"><!></button></div></div>'),Ae=l('<div class="space-y-4"></div>'),Ce=l('<div class="w-full lg:max-w-4xl mx-auto p-4 sm:p-6 lg:p-8"><!></div>');function He(x,U){ie(U,!0);let u=T(le([])),h=T(null),I=L(()=>D.$currentUser?.pubkey);H(()=>{if(!r(I)){m(u,[],!0);return}E(r(I))});async function E(a){try{const t={kinds:[513],authors:[a]},d=await D.fetchEvents(t,{relayUrls:[...pe]});m(u,Array.from(d).sort((v,c)=>(c.created_at||0)-(v.created_at||0)),!0)}catch(t){console.error("Failed to load invites:",t)}}function G(a){const t=a.tags.find(d=>d[0]==="d")?.[1];return t?`${window.location.origin}/i/${t}`:""}function O(a){try{const t=JSON.parse(a.content);return{welcomeMessage:t.welcomeMessage,recipientName:t.recipientName,isPersonalized:!!t.recipientName}}catch{return{isPersonalized:!1}}}async function R(a,t){try{await navigator.clipboard.writeText(a),m(h,t,!0),setTimeout(()=>m(h,null),2e3)}catch(d){console.error("Failed to copy:",d)}}async function J(a){if(confirm("Are you sure you want to delete this invite?"))try{await a.delete(),m(u,r(u).filter(t=>t.id!==a.id),!0)}catch(t){console.error("Failed to delete invite:",t),alert("Failed to delete invite. Check console for details.")}}H(()=>(S.header=ge,()=>{S.clear()}));var _=Ce(),Y=n(_);{var q=a=>{var t=xe();i(a,t)},K=a=>{var t=Ae();ve(t,21,()=>r(u),d=>d.id,(d,v)=>{const c=L(()=>O(r(v))),N=L(()=>G(r(v)));var k=Me(),b=n(k),y=n(b),w=n(y),Q=n(w);{var W=e=>{var o=he();i(e,o)},X=e=>{var o=_e();i(e,o)};f(Q,e=>{r(c).isPersonalized?e(W):e(X,!1)})}s(w);var P=p(w,2);{var Z=e=>{var o=ke(),g=n(o);s(o),j(()=>C(g,`For ${r(c).recipientName??""}`)),i(e,o)};f(P,e=>{r(c).recipientName&&e(Z)})}var z=p(P,2),$=n(z);s(z),s(y);var ee=p(y,2);ee.__click=()=>J(r(v)),s(b);var B=p(b,2);{var te=e=>{var o=be(),g=n(o),se=n(g,!0);s(g),s(o),j(()=>C(se,r(c).welcomeMessage)),i(e,o)};f(B,e=>{r(c).welcomeMessage&&e(te)})}var F=p(B,2),M=n(F);ce(M);var A=p(M,2);A.__click=()=>R(r(N),r(v).id);var re=n(A);{var ae=e=>{var o=ye();V(2),i(e,o)},oe=e=>{var o=we();V(2),i(e,o)};f(re,e=>{r(h)===r(v).id?e(ae):e(oe,!1)})}s(A),s(F),s(k),j(e=>{C($,`Created ${e??""}`),ue(M,r(N))},[()=>me(r(v).created_at||0)]),i(d,k)}),s(t),i(a,t)};f(Y,a=>{r(u).length===0?a(q):a(K,!1)})}s(_),i(x,_),de()}ne(["click"]);export{He as component};
