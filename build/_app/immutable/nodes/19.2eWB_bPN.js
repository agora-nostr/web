import{d as ue,f as x,s as U,a as i,i as W,c as Z}from"../chunks/rzUyzf2y.js";import{p as oe,e as s,d as g,r as o,t as A,c as ae,f as O,g as v,a as P,aK as fe}from"../chunks/AsQG98fS.js";import{i as w}from"../chunks/DZKExFZC.js";import{e as Q}from"../chunks/Cztbr3Ea.js";import{g as ge}from"../chunks/s53o-P2j.js";import{k as me,n as q,m as pe,o as he,r as j}from"../chunks/tv6-RHC_.js";import{h as D}from"../chunks/BVrYKRgp.js";import{c as $}from"../chunks/Dt3q2Svx.js";import{c as G,a as ee}from"../chunks/CS0aOiUg.js";import{p as J}from"../chunks/w-gpJwMz.js";import{u as ye}from"../chunks/DHRuQT7d.js";import{R as xe}from"../chunks/ymyJjmi3.js";import{U as re}from"../chunks/C-S0GgRw.js";var _e=x('<span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span>'),be=W('<svg class="w-4 h-4 text-primary flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>'),ke=x('<div class="w-5 h-5 rounded-full border-2 border-background bg-muted flex items-center justify-center text-[10px] font-medium text-muted-foreground"> </div>'),we=x('<div class="flex -space-x-1.5 mb-2 items-center"><!> <!></div>'),Fe=x('<p class="text-sm text-muted-foreground line-clamp-2"> </p>'),Re=W('<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>'),Ce=W('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg>'),Le=x("<button><!></button>"),Me=x('<div><div class="flex items-start gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1 flex-wrap"><h3 class="text-sm font-semibold text-foreground truncate"> </h3> <!> <!></div> <p class="text-xs text-muted-foreground mb-1"> </p> <!> <!></div> <!></div></div>');function te(M,r){oe(r,!0);const c=J(r,"pubkeys",19,()=>[]),m=J(r,"isFavorite",3,!1),F=J(r,"showFavoriteIcon",3,!1),d=ye(r.relayUrl);var l=Me();l.__click=function(...e){r.onclick?.apply(this,e)},l.__keydown=e=>{r.onclick&&(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),r.onclick())};var u=s(l),f=s(u);xe(f,{get relayUrl(){return r.relayUrl},size:"lg"});var _=g(f,2),R=s(_),a=s(R),p=s(a,!0);o(a);var I=g(a,2);{var V=e=>{var t=_e();i(e,t)};w(I,e=>{me(r.relayUrl)&&e(V)})}var T=g(I,2);{var B=e=>{var t=be();i(e,t)};w(T,e=>{F()&&m()&&e(B)})}o(R);var z=g(R,2),H=s(z,!0);o(z);var E=g(z,2);{var K=e=>{var t=we(),y=s(t);Q(y,16,()=>c().slice(0,5),n=>n,(n,k)=>{var S=Z(),se=O(S);$(se,()=>re.Root,(le,ne)=>{ne(le,{get ndk(){return q},get pubkey(){return k},children:(ie,je)=>{var X=Z(),ve=O(X);$(ve,()=>re.Avatar,(de,ce)=>{ce(de,{class:"rounded-full border-2 border-background",size:32})}),i(ie,X)},$$slots:{default:!0}})}),i(n,S)});var L=g(y,2);{var Y=n=>{var k=ke(),S=s(k);o(k),A(()=>U(S,`+${c().length-5}`)),i(n,k)};w(L,n=>{c().length>5&&n(Y)})}o(t),i(e,t)};w(E,e=>{c().length>0&&e(K)})}var b=g(E,2);{var h=e=>{var t=Fe(),y=s(t,!0);o(t),A(()=>U(y,d.info.description)),i(e,t)};w(b,e=>{d.info?.description&&e(h)})}o(_);var C=g(_,2);{var N=e=>{var t=Le();t.__click=n=>{n.stopPropagation(),r.onFavoriteClick(n)};var y=s(t);{var L=n=>{var k=Re();i(n,k)},Y=n=>{var k=Ce();i(n,k)};w(y,n=>{m()?n(L):n(Y,!1)})}o(t),A(()=>{ee(t,1,`flex-shrink-0 p-2 rounded-lg hover:bg-muted transition-colors ${m()?"text-primary":"text-muted-foreground hover:text-primary"}`),G(t,"title",m()?"Remove from favorites":"Add to favorites")}),i(e,t)};w(C,e=>{r.onFavoriteClick&&e(N)})}o(u),o(l),A(e=>{G(l,"role",r.onclick?"button":void 0),G(l,"tabindex",r.onclick?0:void 0),ee(l,1,`p-4 bg-card rounded-lg border border-border hover:border-primary/50 transition-colors ${r.onclick?"cursor-pointer":""}`),U(p,e),U(H,r.relayUrl)},[()=>d.info?.name||r.relayUrl.replace("wss://","").replace("ws://","")]),i(M,l),ae()}ue(["click","keydown"]);function ze(M){const r=P(()=>M.$sessions?.follows||new Set),c=P(()=>Array.from(v(r))),m=M.$subscribe(()=>{if(v(c).length!==0)return{filters:[{kinds:[10012],authors:v(c)}],subId:"follows-relay-lists",wrap:!0}}),F=P(()=>{const d=v(c).length;if(d===0)return[];const l=new Map;for(const u of m.events){const f=u,_=u.pubkey;if(f.relayUrls)for(const R of f.relayUrls){const a=pe(R),p=l.get(a);p?(p.count++,p.pubkeys.includes(_)||p.pubkeys.push(_)):l.set(a,{count:1,pubkeys:[_]})}}return Array.from(l.entries()).map(([u,f])=>({url:u,count:f.count,percentage:d>0?f.count/d*100:0,pubkeys:f.pubkeys})).sort((u,f)=>f.count-u.count)});return{get relays(){return v(F)},get totalFollows(){return v(c).length},get eventsCount(){return m.events.length},getTopRelays(d=10){return v(F).slice(0,d)},getRelaysByThreshold(d){return v(F).filter(l=>l.percentage>=d)}}}var Ue=x('<div class="text-center py-12"><svg class="w-16 h-16 mx-auto mb-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> <h3 class="text-lg font-semibold text-foreground mb-2">Login Required</h3> <p class="text-muted-foreground">Please login to manage your favorite relay feeds</p></div>'),Ae=x('<div class="space-y-3"><h2 class="text-lg font-semibold text-foreground flex items-center gap-2"><svg class="w-5 h-5 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg> Your Favorite Relays <span class="text-sm text-muted-foreground font-normal"> </span></h2> <div class="grid gap-3"></div></div>'),Ie=x(`<!> <div class="space-y-3"><div class="flex items-center justify-between"><div><h2 class="text-lg font-semibold text-foreground flex items-center gap-2"><svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> Follows' Relays</h2> <p class="text-sm text-muted-foreground mt-1"> </p></div></div> <div class="grid gap-3"></div></div>`,1),Be=x('<div class="p-4 space-y-6"><!></div>');function Qe(M,r){oe(r,!0);const c=q.$sessionEvent(he),m=ze(q),F=P(()=>m.getTopRelays(20));async function d(a){j&&(j.isFavorite(a)?await j.removeRelay(a):await j.addRelay(a))}function l(a){ge(`/?relay=${encodeURIComponent(a)}`)}fe(()=>(D.headerConfig={title:"Relay Feeds",subtitle:"Manage your favorite relays for curated content browsing",backNav:{href:"/"}},()=>{D.headerConfig=null}));var u=Be(),f=s(u);{var _=a=>{var p=Ue();i(a,p)},R=a=>{var p=Ie(),I=O(p);{var V=b=>{var h=Ae(),C=s(h),N=g(s(C),2),e=s(N);o(N),o(C);var t=g(C,2);Q(t,20,()=>c,y=>y,(y,L)=>{te(y,{get relayUrl(){return L},isFavorite:!0,showFavoriteIcon:!0,onclick:()=>l(L),onFavoriteClick:()=>d(L)})}),o(t),o(h),A(()=>U(e,`(${c.length??""})`)),i(b,h)};w(I,b=>{c?.relayUrls.length>0&&b(V)})}var T=g(I,2),B=s(T),z=s(B),H=g(s(z),2),E=s(H);o(H),o(z),o(B);var K=g(B,2);Q(K,21,()=>v(F),b=>b.url,(b,h)=>{const C=P(()=>j?.isFavorite(v(h).url)||!1);te(b,{get relayUrl(){return v(h).url},get pubkeys(){return v(h).pubkeys},get isFavorite(){return v(C)},showFavoriteIcon:!0,onclick:()=>l(v(h).url),onFavoriteClick:()=>d(v(h).url)})}),o(K),o(T),A(()=>U(E,`Popular relays used by ${m.eventsCount??""}/${m.totalFollows??""} of your follows`)),i(a,p)};w(f,a=>{q.$currentUser?a(R,!1):a(_)})}o(u),i(M,u),ae()}export{Qe as component};
