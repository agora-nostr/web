import"../chunks/DsnmJJEf.js";import{p as De,u as le,s as h,b as U,i as u,k as r,j as o,g as e,r as t,t as y,e as n,h as He,l as k,f as S,d as dt,a as E,c as Fe}from"../chunks/Bq750rDx.js";import{i as c}from"../chunks/BcjopvHb.js";import{e as Ee}from"../chunks/Cjcfrngr.js";import{a as Z,c as de}from"../chunks/uSFILAY7.js";import{s as vt,a as ut}from"../chunks/wxUnewq1.js";import{n as M,N as ct}from"../chunks/CdRP5_sk.js";import{p as ft}from"../chunks/CFwZN-iQ.js";import{g as Pe}from"../chunks/C88829DE.js";import{t as Ae}from"../chunks/8lBcLtWK.js";import{f as Le}from"../chunks/BT8HVFUh.js";import{c as se}from"../chunks/DLXKwEVI.js";import{m as mt}from"../chunks/C6SIxCTZ.js";import{A as Ie}from"../chunks/Bt6DpIqu.js";import{N as pt}from"../chunks/CPZq7sH0.js";import{C as _t}from"../chunks/DS87H1fr.js";import{p as ne}from"../chunks/BL6J_geM.js";import{F as gt}from"../chunks/YxVSQae_.js";import{f as bt}from"../chunks/KSN4Ur19.js";import{g as Ve}from"../chunks/DAOE6Nme.js";var ht=u('<p class="text-sm text-muted-foreground truncate"> </p>'),kt=u('<a class="block group"><h4 class="font-semibold text-foreground group-hover:text-primary transition-colors truncate"> </h4> <!></a>'),xt=u('<p class="text-sm text-muted-foreground truncate"> </p>'),wt=u('<h4 class="font-semibold text-foreground truncate"> </h4> <!>',1),yt=u("<span> </span>"),Ft=u("<span>â€¢</span>"),Pt=u('<!> <span>Invited by <a class="text-primary hover:underline"> </a></span>',1),At=u('<div class="flex items-center gap-2 mt-1 text-xs text-muted-foreground"><!> <!></div>'),jt=u('<p class="mt-2 text-sm text-foreground/80 line-clamp-2"> </p>'),Mt=u('<div class="flex-shrink-0"><!></div>'),Ct=u('<div><!> <div class="flex-1 min-w-0"><div class="flex items-start justify-between gap-2"><div class="flex-1 min-w-0"><!> <!> <!></div> <!></div></div></div>');function Ut(ve,f){De(f,!0);let ue=ne(f,"showFollow",3,!0),ce=ne(f,"showAbout",3,!0),fe=ne(f,"clickable",3,!0),V=ne(f,"class",3,""),P=U(void 0),_=U(null),m=U(void 0),A=U(null);le(()=>{M.fetchUser(f.pubkey).then(d=>{h(P,d,!0),d?.fetchProfile().then(v=>{h(_,v,!0)})})}),le(()=>{if(!f.inviterPubkey){h(m,void 0),h(A,null);return}M.fetchUser(f.inviterPubkey).then(d=>{h(m,d,!0),d?.fetchProfile().then(v=>{h(A,v,!0)})})});var l=Ct(),F=r(l);Ie(F,{get ndk(){return M},get pubkey(){return f.pubkey},class:"w-12 h-12 rounded-full"});var D=o(F,2),T=r(D),K=r(T),J=r(K);{var O=d=>{var v=kt(),g=r(v),B=r(g,!0);t(g);var N=o(g,2);{var L=p=>{var b=ht(),a=r(b,!0);t(b),y(()=>k(a,e(_).nip05)),n(p,b)};c(N,p=>{e(_)?.nip05&&p(L)})}t(v),y(()=>{de(v,"href",`/p/${e(P).npub??""}`),k(B,e(_)?.displayName||e(_)?.name||"Anon")}),n(d,v)},me=d=>{var v=wt(),g=S(v),B=r(g,!0);t(g);var N=o(g,2);{var L=p=>{var b=xt(),a=r(b,!0);t(b),y(()=>k(a,e(_).nip05)),n(p,b)};c(N,p=>{e(_)?.nip05&&p(L)})}y(()=>k(B,e(_)?.displayName||e(_)?.name||"Anon")),n(d,v)};c(J,d=>{fe()?d(O):d(me,!1)})}var $=o(J,2);{var pe=d=>{var v=At(),g=r(v);{var B=p=>{var b=yt(),a=r(b);t(b),y(C=>k(a,`Joined ${C??""}`),[()=>bt(f.joinedAt)]),n(p,b)};c(g,p=>{f.joinedAt&&p(B)})}var N=o(g,2);{var L=p=>{var b=Pt(),a=S(b);{var C=x=>{var j=Ft();n(x,j)};c(a,x=>{f.joinedAt&&x(C)})}var q=o(a,2),z=o(r(q)),R=r(z,!0);t(z),t(q),y(()=>{de(z,"href",`/p/${e(m)?.npub??""}`),k(R,e(A).displayName||e(A).name||"someone")}),n(p,b)};c(N,p=>{f.inviterPubkey&&e(A)&&p(L)})}t(v),n(d,v)};c($,d=>{(f.joinedAt||f.inviterPubkey)&&d(pe)})}var ee=o($,2);{var _e=d=>{var v=jt(),g=r(v,!0);t(v),y(()=>k(g,e(_).about)),n(d,v)};c(ee,d=>{ce()&&e(_)?.about&&d(_e)})}t(K);var G=o(K,2);{var Q=d=>{var v=Mt(),g=r(v);gt(g,{get pubkey(){return f.pubkey},iconOnly:!0}),t(v),n(d,v)};c(G,d=>{ue()&&d(Q)})}t(T),t(D),t(l),y(()=>Z(l,1,`flex items-start gap-3 p-4 bg-card rounded-lg border border-border hover:border-primary/30 transition-colors ${V()??""}`)),n(ve,l),He()}var Bt=u('<div class="h-48 w-full"><img class="w-full h-full object-cover"/></div>'),Nt=u('<button class="flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button>'),qt=u('<button class="flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary/90 disabled:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg> </button>'),zt=u('<div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span> </span></div>'),Et=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Lt=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Vt=u('<div class="p-8 text-center text-muted-foreground">Loading notes from pack members...</div>'),Dt=u('<div class="p-8 text-center text-muted-foreground">No notes found from pack members</div>'),Ht=u('<div class="divide-y divide-neutral-800/50 border-y border-border"><!></div>'),It=u('<div class="grid gap-4 md:grid-cols-2"></div>'),St=u('<div class="bg-card border border-border rounded-xl overflow-hidden mb-6"><!> <div class="p-6"><div class="flex items-start justify-between mb-4"><div><h1 class="text-2xl font-bold text-foreground mb-2 svelte-1xwqwht"> </h1> <p class="text-muted-foreground"> </p></div> <div class="flex items-center gap-2"><!> <button><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg></button></div></div> <div class="flex items-center gap-6 mb-6 text-sm"><div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <span> </span></div> <!></div> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0"><!></button> <div><p class="text-sm text-muted-foreground">Created by</p> <button class="font-medium text-foreground hover:text-primary transition-colors"> </button></div></div></div></div> <div class="border-b border-border mb-6"><div class="flex gap-6"><button>Feed <!></button> <button> <!></button></div></div> <!>',1),Tt=u('<div class="text-center py-12"><div class="inline-block w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mb-4"></div> <p class="text-muted-foreground">Loading follow pack...</p></div>'),Kt=u('<div class="text-center py-12"><p class="text-muted-foreground">Follow pack not found</p> <button class="text-primary hover:text-primary/90 mt-4 inline-block transition-colors">Browse all packs</button></div>'),Jt=u('<div class="pack-detail-container svelte-1xwqwht"><div class="pack-header svelte-1xwqwht"><button class="back-btn svelte-1xwqwht"><svg class="w-6 h-6 svelte-1xwqwht" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="svelte-1xwqwht"> </h1></div> <div class="pack-content svelte-1xwqwht"><!> <!></div></div>');function ur(ve,f){De(f,!0);const ue=()=>ut(ft,"$page",ce),[ce,fe]=vt(),V=E(()=>ue().params.packId);let P=U("feed"),_=U(!1),m=U(null),A=U(!0);le(()=>{e(V)&&(h(A,!0),M.fetchEvent(e(V)).then(a=>{a&&h(m,a,!0),h(A,!1)}).catch(a=>{console.error("Failed to fetch pack:",a),h(A,!1)}))});let l=E(()=>e(m)?{id:e(m).id||"",title:e(m).tagValue("title")||"Untitled Pack",description:e(m).tagValue("description"),image:e(m).tagValue("image"),pubkeys:e(m).tags.filter(a=>a[0]==="p").map(a=>a[1]),encode:()=>e(m).encode(),kind:e(m).kind||39089,pubkey:e(m).pubkey,created_at:e(m).created_at||0,author:e(m).author}:e(V)&&!e(A)?mt.find(a=>a.encode()===e(V)):null),F=E(()=>e(l)?.pubkeys||[]),D=U(null);le(()=>{if(!e(l)?.author){h(D,null);return}e(l).author.fetchProfile().then(a=>{h(D,a,!0)})});let T=E(()=>e(l)?Le.isFavorite(e(l).id):!1),K=E(()=>e(l)&&M.$currentUser?e(l).pubkey===M.$currentUser.pubkey:!1);const J=E(()=>e(P)==="feed"&&e(F).length>0?(console.log(`[FollowPackDetail] Creating subscription for ${e(F).length} members`),M.$subscribe(()=>({filters:[{kinds:[ct.Text],authors:e(F),limit:50}],bufferMs:100}))):null),O=E(()=>e(J)?.events||[]),me=E(()=>e(J)?.eosed||!1);function $(){e(l)&&Le.toggleFavorite(e(l).id)}async function pe(){if(!e(l)||!M.activeUser||e(F).length===0){Ae.error("Please login to follow users");return}h(_,!0);try{Ae.success(`Following ${e(F).length} users`),M.$follows.add(e(F))}catch(a){console.error("Error following all users:",a),Ae.error("Failed to follow users")}finally{h(_,!1)}}function ee(){Pe("/packs")}function _e(){e(m)&&se.open(e(m))}var G=Jt(),Q=r(G),d=r(Q);d.__click=ee;var v=o(d,2),g=r(v,!0);t(v),t(Q);var B=o(Q,2),N=r(B);{var L=a=>{var C=St(),q=S(C),z=r(q);{var R=i=>{var s=Bt(),w=r(s);t(s),y(()=>{de(w,"src",e(l).image),de(w,"alt",e(l).title)}),n(i,s)};c(z,i=>{e(l).image&&i(R)})}var x=o(z,2),j=r(x),W=r(j),ge=r(W),Se=r(ge,!0);t(ge);var je=o(ge,2),Te=r(je,!0);t(je),t(W);var Me=o(W,2),Ce=r(Me);{var Ke=i=>{var s=Nt();s.__click=_e,n(i,s)},Je=i=>{var s=qt();s.__click=pe;var w=o(r(s));t(s),y(()=>{s.disabled=e(_),k(w,` ${e(_)?"Following...":"Follow All"}`)}),n(i,s)};c(Ce,i=>{e(K)?i(Ke):i(Je,!1)})}var te=o(Ce,2);te.__click=$;var Oe=r(te);t(te),t(Me),t(j);var be=o(j,2),he=r(be),Ue=o(r(he),2),Ge=r(Ue);t(Ue),t(he);var Qe=o(he,2);{var Re=i=>{var s=zt(),w=o(r(s),2),Y=r(w);t(w),t(s),y(we=>k(Y,`Updated ${we??""}`),[()=>new Date(e(l).created_at*1e3).toLocaleDateString()]),n(i,s)};c(Qe,i=>{e(l).created_at&&i(Re)})}t(be);var Be=o(be,2),re=r(Be);re.__click=()=>Pe(Ve(e(l).pubkey));var We=r(re);Ie(We,{get ndk(){return M},get pubkey(){return e(l).pubkey},class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity"}),t(re);var Ne=o(re,2),ke=o(r(Ne),2);ke.__click=()=>Pe(Ve(e(l).pubkey));var Xe=r(ke,!0);t(ke),t(Ne),t(Be),t(x),t(q);var xe=o(q,2),qe=r(xe),X=r(qe);X.__click=()=>h(P,"feed");var Ye=o(r(X));{var Ze=i=>{var s=Et();n(i,s)};c(Ye,i=>{e(P)==="feed"&&i(Ze)})}t(X);var ae=o(X,2);ae.__click=()=>h(P,"members");var ze=r(ae),$e=o(ze);{var et=i=>{var s=Lt();n(i,s)};c($e,i=>{e(P)==="members"&&i(et)})}t(ae),t(qe),t(xe);var tt=o(xe,2);{var rt=i=>{var s=Ht(),w=r(s);{var Y=H=>{var oe=Vt();n(H,oe)},we=H=>{var oe=Fe(),ot=S(oe);{var it=I=>{var ie=Dt();n(I,ie)},st=I=>{var ie=Fe(),nt=S(ie);Ee(nt,17,()=>e(O),ye=>ye.id,(ye,lt)=>{pt(ye,{get event(){return e(lt)}})}),n(I,ie)};c(ot,I=>{e(O).length===0?I(it):I(st,!1)},!0)}n(H,oe)};c(w,H=>{e(O).length===0&&!e(me)?H(Y):H(we,!1)})}t(s),n(i,s)},at=i=>{var s=It();Ee(s,20,()=>e(F),w=>w,(w,Y)=>{Ut(w,{get pubkey(){return Y}})}),t(s),n(i,s)};c(tt,i=>{e(P)==="feed"?i(rt):i(at,!1)})}y(()=>{k(Se,e(l).title),k(Te,e(l).description||"A curated list of accounts to follow"),Z(te,1,`p-2.5 rounded-lg transition-colors ${e(T)?"bg-red-500/10 text-red-500":"bg-muted text-muted-foreground hover:text-foreground"}`),Z(Oe,0,`w-5 h-5 ${e(T)?"fill-current":""}`),k(Ge,`${e(F).length??""} members`),k(Xe,e(D)?.name||"Anonymous"),Z(X,1,`pb-3 px-1 font-medium transition-colors relative ${e(P)==="feed"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),Z(ae,1,`pb-3 px-1 font-medium transition-colors relative ${e(P)==="members"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),k(ze,`Members (${e(F).length??""}) `)}),n(a,C)},p=a=>{var C=Fe(),q=S(C);{var z=x=>{var j=Tt();n(x,j)},R=x=>{var j=Kt(),W=o(r(j),2);W.__click=ee,t(j),n(x,j)};c(q,x=>{e(A)?x(z):x(R,!1)},!0)}n(a,C)};c(N,a=>{e(l)?a(L):a(p,!1)})}var b=o(N,2);_t(b,{get editingPack(){return se.data},get open(){return se.show},set open(a){se.show=a}}),t(B),t(G),y(()=>k(g,e(l)?.title||"Follow Pack")),n(ve,G),He(),fe()}dt(["click"]);export{ur as component};
