import{v as Kt,c as I,a as r,p as wr,f as i,s as G,d as Ft,i as Mt,t as bt,j as Ut}from"../chunks/rzUyzf2y.js";import{b as re,x as Dt,u as xt,s as _,g as e,a as M,p as wt,f as k,E as qt,c as yt,d as u,e as s,r as o,y as Oe,t as H,aK as Ur,aJ as Vr,B as Kr}from"../chunks/AsQG98fS.js";import{i as y}from"../chunks/DZKExFZC.js";import{e as Ye,i as jt}from"../chunks/Cztbr3Ea.js";import{c as oe}from"../chunks/Dt3q2Svx.js";import{s as Wr,a as qr}from"../chunks/DfBYFC16.js";import{p as Gr,n as Ze,Q as Zt,e as dr,s as Te,f as yr,h as Qr,N as ct,P as Yr,d as Xr}from"../chunks/tv6-RHC_.js";import{l as cr}from"../chunks/DOQj-LTZ.js";import{h as ur}from"../chunks/BVrYKRgp.js";import{E as Jr,u as Zr,U as eo,a as Et,R as to}from"../chunks/Cxhu68Im.js";import{M as ro,A as oo}from"../chunks/B98jEbhe.js";import{d as Ot,c as je,a as ut,e as kr}from"../chunks/CS0aOiUg.js";import{T as ao}from"../chunks/2VdFane9.js";import{g as so}from"../chunks/BgxlgyeA.js";import{H as vr}from"../chunks/DZFlx0fg.js";import{M as no}from"../chunks/DSSpNA08.js";import{a as er}from"../chunks/CO-nanZk.js";import{b as Gt}from"../chunks/CkKAtl6l.js";import{U as Qt,c as tr}from"../chunks/C-S0GgRw.js";import{c as Vt,L as hr}from"../chunks/iWJgxq80.js";import{R as io,h as lo,c as Xt}from"../chunks/llCo7pzK.js";import{u as Yt}from"../chunks/DHRuQT7d.js";import{p as ee,s as pr,r as Cr}from"../chunks/w-gpJwMz.js";import{N as co,c as uo}from"../chunks/BpHW1rOk.js";import{ad as Mr,i as ht,a9 as At,w as rr,ae as vo,af as Pr,ag as ho,ah as po,C as fo,f as $r,u as ar,ai as or,aj as go,x as Rr,a4 as mo,g as _o,v as bo,a8 as xo,ak as wo,h as jr,m as Wt,M as Lr,D as Sr,a as Tr,R as zr,b as Dr,d as Fr,e as Hr}from"../chunks/CVV5LOp_.js";import{t as ft}from"../chunks/D7cSTCXZ.js";import{D as Er}from"../chunks/D1QSAoU9.js";import{D as yo,a as Or}from"../chunks/CKdpi0zW.js";import{I as fr,B as Ve}from"../chunks/DMKx7da8.js";import{T as gr}from"../chunks/DHCUFZXp.js";import{S as ko}from"../chunks/D2z4-Wxa.js";import{D as Co}from"../chunks/Dw5jWGaA.js";import{R as mr}from"../chunks/DnC2iOoX.js";import{p as _r}from"../chunks/DkZQAMY8.js";import{p as Mo}from"../chunks/BcDbBYPM.js";import{r as Po}from"../chunks/CnuptT3n.js";import{s as Tt}from"../chunks/DNVUPZsi.js";import{F as $o,P as Ro,M as br,b as jo,g as xr,a as Lo}from"../chunks/D3kz06El.js";function So(g){const t=[],d=Mr(g).createTreeWalker(g,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const f=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||f?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;d.nextNode();)t.push(d.currentNode);return t}const To={afterMs:1e4,onChange:At};function zo(g,t){const{afterMs:a,onChange:d,getWindow:l}={...To,...t};let f=null,v=re(Dt(g));function w(){return l().setTimeout(()=>{_(v,g,!0),d?.(g)},a)}return xt(()=>()=>{f&&l().clearTimeout(f)}),ht(()=>e(v),C=>{_(v,C,!0),d?.(C),f&&l().clearTimeout(f),f=w()})}class Do{#e;#t;#o;#r=re(null);constructor(t){this.#e=t,this.#t=M(()=>this.#e.enabled()),this.#o=zo(!1,{afterMs:t.transitTimeout??300,onChange:a=>{e(this.#t)&&this.#e.setIsPointerInTransit?.(a)},getWindow:()=>po(this.#e.triggerNode())}),rr([t.triggerNode,t.contentNode,t.enabled],([a,d,l])=>{if(!a||!d||!l)return;const f=w=>{this.#s(w,d)},v=w=>{this.#s(w,a)};return vo(Kt(a,"pointerleave",f),Kt(d,"pointerleave",v))}),rr(()=>e(this.#r),()=>{const a=l=>{if(!e(this.#r))return;const f=l.target;if(!Pr(f))return;const v={x:l.clientX,y:l.clientY},w=t.triggerNode()?.contains(f)||t.contentNode()?.contains(f),C=!Oo(v,e(this.#r));w?this.#a():C&&(this.#a(),t.onPointerExit())},d=Mr(t.triggerNode()??t.contentNode());if(d)return Kt(d,"pointermove",a)})}#a(){_(this.#r,null),this.#o.current=!1}#s(t,a){const d=t.currentTarget;if(!ho(d))return;const l={x:t.clientX,y:t.clientY},f=Fo(l,d.getBoundingClientRect()),v=Ho(l,f),w=Eo(a.getBoundingClientRect()),C=Ao([...v,...w]);_(this.#r,C,!0),this.#o.current=!0}}function Fo(g,t){const a=Math.abs(t.top-g.y),d=Math.abs(t.bottom-g.y),l=Math.abs(t.right-g.x),f=Math.abs(t.left-g.x);switch(Math.min(a,d,l,f)){case f:return"left";case l:return"right";case a:return"top";case d:return"bottom";default:throw new Error("unreachable")}}function Ho(g,t,a=5){const d=a*1.5;switch(t){case"top":return[{x:g.x-a,y:g.y+a},{x:g.x,y:g.y-d},{x:g.x+a,y:g.y+a}];case"bottom":return[{x:g.x-a,y:g.y-a},{x:g.x,y:g.y+d},{x:g.x+a,y:g.y-a}];case"left":return[{x:g.x+a,y:g.y-a},{x:g.x-d,y:g.y},{x:g.x+a,y:g.y+a}];case"right":return[{x:g.x-a,y:g.y-a},{x:g.x+d,y:g.y},{x:g.x-a,y:g.y+a}]}}function Eo(g){const{top:t,right:a,bottom:d,left:l}=g;return[{x:l,y:t},{x:a,y:t},{x:a,y:d},{x:l,y:d}]}function Oo(g,t){const{x:a,y:d}=g;let l=!1;for(let f=0,v=t.length-1;f<t.length;v=f++){const w=t[f].x,C=t[f].y,j=t[v].x,$=t[v].y;C>d!=$>d&&a<(j-w)*(d-C)/($-C)+w&&(l=!l)}return l}function Ao(g){const t=g.slice();return t.sort((a,d)=>a.x<d.x?-1:a.x>d.x?1:a.y<d.y?-1:a.y>d.y?1:0),No(t)}function No(g){if(g.length<=1)return g.slice();const t=[];for(let d=0;d<g.length;d++){const l=g[d];for(;t.length>=2;){const f=t[t.length-1],v=t[t.length-2];if((f.x-v.x)*(l.y-v.y)>=(f.y-v.y)*(l.x-v.x))t.pop();else break}t.push(l)}t.pop();const a=[];for(let d=g.length-1;d>=0;d--){const l=g[d];for(;a.length>=2;){const f=a[a.length-1],v=a[a.length-2];if((f.x-v.x)*(l.y-v.y)>=(f.y-v.y)*(l.x-v.x))a.pop();else break}a.push(l)}return a.pop(),t.length===1&&a.length===1&&t[0].x===a[0].x&&t[0].y===a[0].y?t:t.concat(a)}const Ar=_o({component:"link-preview",parts:["content","trigger"]}),sr=new fo("LinkPreview.Root");class nr{static create(t){return sr.set(new nr(t))}opts;#e=re(!1);get hasSelection(){return e(this.#e)}set hasSelection(t){_(this.#e,t,!0)}#t=re(!1);get isPointerDownOnContent(){return e(this.#t)}set isPointerDownOnContent(t){_(this.#t,t,!0)}#o=re(!1);get containsSelection(){return e(this.#o)}set containsSelection(t){_(this.#o,t,!0)}timeout=null;#r=re(null);get contentNode(){return e(this.#r)}set contentNode(t){_(this.#r,t,!0)}#a=re(!1);get contentMounted(){return e(this.#a)}set contentMounted(t){_(this.#a,t,!0)}contentPresence;#s=re(null);get triggerNode(){return e(this.#s)}set triggerNode(t){_(this.#s,t,!0)}isOpening=!1;domContext=new ar(()=>null);constructor(t){this.opts=t,this.contentPresence=new xo({ref:ht(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}}),rr(()=>this.opts.open.current,a=>{if(!a){this.hasSelection=!1;return}if(!this.domContext)return;const d=()=>{this.containsSelection=!1,this.isPointerDownOnContent=!1,wo(1,()=>{this.domContext.getDocument().getSelection()?.toString()!==""?this.hasSelection=!0:this.hasSelection=!1})},l=Kt(this.domContext.getDocument(),"pointerup",d);if(!this.contentNode)return;const f=So(this.contentNode);for(const v of f)v.setAttribute("tabindex","-1");return()=>{l(),this.hasSelection=!1,this.isPointerDownOnContent=!1}})}clearTimeout(){this.timeout&&(this.domContext.clearTimeout(this.timeout),this.timeout=null)}handleOpen(){this.clearTimeout(),!(this.opts.open.current||this.opts.disabled.current)&&(this.isOpening=!0,this.timeout=this.domContext.setTimeout(()=>{this.isOpening&&(this.opts.open.current=!0,this.isOpening=!1)},this.opts.openDelay.current))}immediateClose(){this.clearTimeout(),this.isOpening=!1,this.opts.open.current=!1}handleClose(){this.isOpening=!1,this.clearTimeout(),!this.isPointerDownOnContent&&!this.hasSelection&&(this.timeout=this.domContext.setTimeout(()=>{this.opts.open.current=!1},this.opts.closeDelay.current))}}class ir{static create(t){return new ir(t,sr.get())}opts;root;attachment;constructor(t,a){this.opts=t,this.root=a,this.attachment=$r(this.opts.ref,d=>this.root.triggerNode=d),this.root.domContext=new ar(t.ref),this.onpointerenter=this.onpointerenter.bind(this),this.onpointerleave=this.onpointerleave.bind(this),this.onfocus=this.onfocus.bind(this),this.onblur=this.onblur.bind(this)}onpointerenter(t){or(t)||this.root.handleOpen()}onpointerleave(t){or(t)||(!this.root.contentMounted||!this.root.opts.open.current)&&this.root.immediateClose()}onfocus(t){go(t.currentTarget)&&this.root.handleOpen()}onblur(t){this.root.handleClose()}#e=M(()=>({id:this.opts.id.current,"aria-haspopup":"dialog","aria-expanded":mo(this.root.opts.open.current),"data-state":Rr(this.root.opts.open.current),"aria-controls":this.root.contentNode?.id,role:"button",[Ar.trigger]:"",onpointerenter:this.onpointerenter,onfocus:this.onfocus,onblur:this.onblur,onpointerleave:this.onpointerleave,...this.attachment}));get props(){return e(this.#e)}set props(t){_(this.#e,t)}}class lr{static create(t){return new lr(t,sr.get())}opts;root;attachment;constructor(t,a){this.opts=t,this.root=a,this.attachment=$r(this.opts.ref,d=>this.root.contentNode=d),this.root.domContext=new ar(t.ref),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerenter=this.onpointerenter.bind(this),this.onfocusout=this.onfocusout.bind(this),new Do({triggerNode:()=>this.root.triggerNode,contentNode:()=>this.opts.ref.current,enabled:()=>this.root.opts.open.current,onPointerExit:()=>{this.root.handleClose()}}),bo(()=>{this.root.clearTimeout()})}onpointerdown(t){const a=t.target;Pr(a)&&(t.currentTarget.contains(a)&&(this.root.containsSelection=!0),this.root.hasSelection=!0,this.root.isPointerDownOnContent=!0)}onpointerenter(t){or(t)||this.root.handleOpen()}onfocusout(t){t.preventDefault()}onInteractOutside=t=>{this.opts.onInteractOutside.current(t),!t.defaultPrevented&&this.root.handleClose()};onEscapeKeydown=t=>{this.opts.onEscapeKeydown.current?.(t),!t.defaultPrevented&&this.root.handleClose()};onOpenAutoFocus=t=>{t.preventDefault()};onCloseAutoFocus=t=>{t.preventDefault()};get shouldRender(){return this.root.contentPresence.shouldRender}#e=M(()=>({open:this.root.opts.open.current}));get snippetProps(){return e(this.#e)}set snippetProps(t){_(this.#e,t)}#t=M(()=>({id:this.opts.id.current,tabindex:-1,"data-state":Rr(this.root.opts.open.current),[Ar.content]:"",onpointerdown:this.onpointerdown,onpointerenter:this.onpointerenter,onfocusout:this.onfocusout,...this.attachment}));get props(){return e(this.#t)}set props(t){_(this.#t,t)}popperProps={onInteractOutside:this.onInteractOutside,onEscapeKeydown:this.onEscapeKeydown,onOpenAutoFocus:this.onOpenAutoFocus,onCloseAutoFocus:this.onCloseAutoFocus}}function Io(g,t){wt(t,!0);let a=ee(t,"disabled",3,!1),d=ee(t,"open",15,!1),l=ee(t,"onOpenChange",3,At),f=ee(t,"onOpenChangeComplete",3,At),v=ee(t,"openDelay",3,700),w=ee(t,"closeDelay",3,300);nr.create({disabled:ht(()=>a()),open:ht(()=>d(),$=>{d($),l()($)}),openDelay:ht(()=>v()),closeDelay:ht(()=>w()),onOpenChangeComplete:ht(()=>f())});var C=I(),j=k(C);oe(j,()=>$o,($,S)=>{S($,{children:(O,Q)=>{var h=I(),R=k(h);Tt(R,()=>t.children??qt),r(O,h)},$$slots:{default:!0}})}),r(g,C),yt()}var Bo=i("<div><div><!></div></div>"),Uo=i("<!> <!>",1),Vo=i("<div><div><!></div></div>"),Ko=i("<!> <!>",1);function Wo(g,t){const a=wr();wt(t,!0);let d=ee(t,"id",19,()=>jr(a)),l=ee(t,"ref",15,null),f=ee(t,"side",3,"top"),v=ee(t,"sideOffset",3,0),w=ee(t,"align",3,"center"),C=ee(t,"avoidCollisions",3,!0),j=ee(t,"arrowPadding",3,0),$=ee(t,"sticky",3,"partial"),S=ee(t,"hideWhenDetached",3,!1),O=ee(t,"collisionPadding",3,0),Q=ee(t,"onInteractOutside",3,At),h=ee(t,"onEscapeKeydown",3,At),R=ee(t,"forceMount",3,!1),N=Cr(t,["$$slots","$$events","$$legacy","children","child","id","ref","side","sideOffset","align","avoidCollisions","arrowPadding","sticky","hideWhenDetached","collisionPadding","onInteractOutside","onEscapeKeydown","forceMount"]);const T=lr.create({id:ht(()=>d()),ref:ht(()=>l(),D=>l(D)),onInteractOutside:ht(()=>Q()),onEscapeKeydown:ht(()=>h())}),ae=M(()=>({side:f(),sideOffset:v(),align:w(),avoidCollisions:C(),arrowPadding:j(),sticky:$(),hideWhenDetached:S(),collisionPadding:O()})),c=M(()=>Wt(N,e(ae),T.props));var x=I(),z=k(x);{var F=D=>{Ro(D,pr(()=>e(c),()=>T.popperProps,{get ref(){return T.opts.ref},get enabled(){return T.root.opts.open.current},get id(){return d()},trapFocus:!1,loop:!1,preventScroll:!1,forceMount:!0,get shouldRender(){return T.shouldRender},popper:(we,W)=>{let ne=()=>W?.().props,de=()=>W?.().wrapperProps;const ze=M(()=>Wt(ne(),{style:xr("link-preview")}));var Le=Uo(),De=k(Le);{var Me=ue=>{var _e=I(),p=k(_e);{let A=M(()=>({props:e(ze),wrapperProps:de(),...T.snippetProps}));Tt(p,()=>t.child,()=>e(A))}r(ue,_e)},me=ue=>{var _e=Bo();Ot(_e,()=>({...de()}));var p=s(_e);Ot(p,()=>({...e(ze)}));var A=s(p);Tt(A,()=>t.children??qt),o(p),o(_e),r(ue,_e)};y(De,ue=>{t.child?ue(Me):ue(me,!1)})}var Pe=u(De,2);br(Pe,{get mounted(){return T.root.contentMounted},set mounted(ue){T.root.contentMounted=ue}}),r(we,Le)},$$slots:{popper:!0}}))},se=D=>{var Ce=I(),we=k(Ce);{var W=ne=>{jo(ne,pr(()=>e(c),()=>T.popperProps,{get ref(){return T.opts.ref},get open(){return T.root.opts.open.current},get id(){return d()},trapFocus:!1,loop:!1,preventScroll:!1,forceMount:!1,get shouldRender(){return T.shouldRender},popper:(ze,Le)=>{let De=()=>Le?.().props,Me=()=>Le?.().wrapperProps;const me=M(()=>Wt(De(),{style:xr("link-preview")}));var Pe=Ko(),ue=k(Pe);{var _e=Y=>{var xe=I(),Z=k(xe);{let ce=M(()=>({props:e(me),wrapperProps:Me(),...T.snippetProps}));Tt(Z,()=>t.child,()=>e(ce))}r(Y,xe)},p=Y=>{var xe=Vo();Ot(xe,()=>({...Me()}));var Z=s(xe);Ot(Z,()=>({...e(me)}));var ce=s(Z);Tt(ce,()=>t.children??qt),o(Z),o(xe),r(Y,xe)};y(ue,Y=>{t.child?Y(_e):Y(p,!1)})}var A=u(ue,2);br(A,{get mounted(){return T.root.contentMounted},set mounted(Y){T.root.contentMounted=Y}}),r(ze,Pe)},$$slots:{popper:!0}}))};y(we,ne=>{R()||ne(W)},!0)}r(D,Ce)};y(z,D=>{R()?D(F):D(se,!1)})}r(g,x),yt()}var qo=i("<a><!></a>");function Go(g,t){const a=wr();wt(t,!0);let d=ee(t,"ref",15,null),l=ee(t,"id",19,()=>jr(a)),f=Cr(t,["$$slots","$$events","$$legacy","ref","id","child","children"]);const v=ir.create({id:ht(()=>l()),ref:ht(()=>d(),$=>d($))}),w=M(()=>Wt(f,v.props));var C=I(),j=k(C);oe(j,()=>Lo,($,S)=>{S($,{get id(){return l()},get ref(){return v.opts.ref},children:(O,Q)=>{var h=I(),R=k(h);{var N=ae=>{var c=I(),x=k(c);Tt(x,()=>t.child,()=>({props:e(w)})),r(ae,c)},T=ae=>{var c=qo();Ot(c,()=>({...e(w)}));var x=s(c);Tt(x,()=>t.children??qt),o(c),r(ae,c)};y(R,ae=>{t.child?ae(N):ae(T,!1)})}r(O,h)},$$slots:{default:!0}})}),r(g,C),yt()}class Qo{#e=re(Dt(new Set));get _selectedHashtags(){return e(this.#e)}set _selectedHashtags(t){_(this.#e,t,!0)}get selectedHashtags(){return Array.from(this._selectedHashtags)}get hasFilters(){return this._selectedHashtags.size>0}toggleHashtag(t){const a=t.toLowerCase();this._selectedHashtags.has(a)?this._selectedHashtags.delete(a):this._selectedHashtags.add(a),this._selectedHashtags=new Set(this._selectedHashtags)}addHashtag(t){const a=t.toLowerCase();this._selectedHashtags.has(a)||(this._selectedHashtags.add(a),this._selectedHashtags=new Set(this._selectedHashtags))}removeHashtag(t){const a=t.toLowerCase();this._selectedHashtags.has(a)&&(this._selectedHashtags.delete(a),this._selectedHashtags=new Set(this._selectedHashtags))}clearAll(){this._selectedHashtags.clear(),this._selectedHashtags=new Set}isSelected(t){return this._selectedHashtags.has(t.toLowerCase())}}const gt=new Qo;var Yo=i('<img class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110" loading="lazy"/> <div class="absolute inset-0 bg-gradient-to-t from-neutral-900 via-transparent to-transparent opacity-60"></div>',1),Xo=i('<div class="w-full h-full flex items-center justify-center"><svg class="w-16 h-16 text-primary/30" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div>'),Jo=i('<p class="text-xs text-muted-foreground"><!></p>'),Zo=i('<a class="group block flex-shrink-0 w-[280px] h-[360px] rounded-2xl overflow-hidden bg-card hover:bg-muted transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl hover:shadow-primary/10"><div class="relative w-full h-48 overflow-hidden bg-gradient-to-br bg-primary/20"><!></div> <div class="p-4 flex flex-col h-[calc(100%-12rem)]"><h3 class="font-bold text-base text-foreground mb-2 line-clamp-2 leading-snug font-serif"> </h3> <p class="text-muted-foreground text-xs mb-3 line-clamp-3 leading-relaxed flex-1"> </p> <div class="flex items-center gap-2 mt-auto pt-2 border-t border-border"><div class="flex-1 min-w-0"><p class="text-xs font-medium text-muted-foreground truncate"> </p> <!></div> <svg class="w-5 h-5 text-primary opacity-0 group-hover:opacity-100 transition-opacity" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></div></div></a>');function ea(g,t){wt(t,!0);let a=re(void 0),d=re(null);xt(()=>{_(a,t.article.author,!0),t.article.author.fetchProfile().then(W=>{_(d,W,!0)})});const l=M(()=>t.article.title||"Untitled"),f=M(()=>t.article.summary),v=M(()=>t.article.image),w=M(()=>t.article.published_at||t.article.created_at),C=M(()=>so(t.article,e(a))),j=M(()=>e(d)?.name||e(d)?.displayName||"Anonymous"),$=M(()=>{const W=e(f)||t.article.content;return W.slice(0,100)+(W.length>100?"...":"")});var S=Zo(),O=s(S),Q=s(O);{var h=W=>{var ne=Yo(),de=k(ne);Oe(2),H(()=>{je(de,"src",e(v)),je(de,"alt",e(l))}),r(W,ne)},R=W=>{var ne=Xo();r(W,ne)};y(Q,W=>{e(v)?W(h):W(R,!1)})}o(O);var N=u(O,2),T=s(N),ae=s(T,!0);o(T);var c=u(T,2),x=s(c,!0);o(c);var z=u(c,2),F=s(z),se=s(F),D=s(se,!0);o(se);var Ce=u(se,2);{var we=W=>{var ne=Jo(),de=s(ne);ao(de,{get timestamp(){return e(w)}}),o(ne),r(W,ne)};y(Ce,W=>{e(w)&&W(we)})}o(F),Oe(2),o(z),o(N),o(S),H(()=>{je(S,"href",e(C)),G(ae,e(l)),G(x,e($)),G(D,e(j))}),r(g,S),yt()}var ta=i('<div class="flex items-center justify-center h-[calc(100vh-12rem)] text-muted-foreground">No videos found</div>'),ra=Mt('<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path></svg>'),oa=Mt('<svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>'),aa=i('<p class="text-white text-sm mb-3 line-clamp-3"> </p>'),sa=i('<div class="relative w-screen snap-start snap-always flex items-center justify-center bg-black h-screen lg:h-screen"><video class="w-full h-full object-contain" loop playsinline="" preload="auto"><track kind="captions"/></video> <div class="absolute inset-0 pointer-events-none"><div class="absolute top-0 left-0 right-0 bg-gradient-to-b from-black/70 via-black/20 to-transparent p-4 pointer-events-auto"><div class="flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="text-white font-semibold text-sm truncate"> </div></div></div></div> <div class="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-auto"><button class="w-12 h-12 rounded-full bg-black/50 hover:bg-black/70 backdrop-blur-sm flex items-center justify-center transition-colors" type="button"><!></button></div> <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent p-4 pointer-events-auto"><div class="flex items-end gap-4"><div class="flex-1 min-w-0 mb-2"><!></div> <div class="flex flex-col items-center gap-4 pb-2"><!></div></div></div></div></div>',2),na=i('<div class="fixed inset-0 overflow-y-scroll snap-y snap-mandatory scrollbar-hide bg-black lg:bottom-0 bottom-[72px] svelte-znq7e9"></div>');function ia(g,t){wt(t,!0);let a=re(null),d=re(!0);function l(h){const R=/(https?:\/\/[^\s]+\.(mp4|webm|mov|avi|mkv))/gi;return h.match(R)||[]}function f(h){const R=h.m,N=h.url;if(R&&R.startsWith("video/"))return"video";if(N){const T=N.split(".").pop()?.toLowerCase();if(["mp4","webm","mov","avi","mkv"].includes(T||""))return"video"}return"other"}const v=M(()=>t.events.flatMap(h=>{const T=h.tags.filter(c=>c[0]==="imeta").map(c=>Gr(c)).filter(c=>c.url&&f(c)==="video").map(c=>({event:h,imeta:c}));return T.length>0?T:l(h.content).map(c=>{const x=c.split(".").pop()?.toLowerCase();return{event:h,imeta:{url:c,m:"video/"+x}}})}));let w=null,C=new Map;Ur(()=>(w=new IntersectionObserver(h=>{h.forEach(R=>{const N=R.target;R.isIntersecting&&R.intersectionRatio>.5?N.play().catch(T=>{console.log("Auto-play prevented:",T)}):N.pause()})},{root:null,threshold:[.5]}),setTimeout(()=>{const h=C.get(0);h&&h.play().catch(R=>{console.log("Auto-play prevented:",R)})},100),()=>{w?.disconnect()}));function j(h,R){return C.set(R,h),w&&w.observe(h),{destroy(){C.delete(R),w&&w.unobserve(h)}}}var $=I(),S=k($);{var O=h=>{var R=ta();r(h,R)},Q=h=>{var R=na();Ye(R,23,()=>e(v),({event:N,imeta:T},ae)=>`${N.id}-${ae}`,(N,T,ae)=>{let c=()=>e(T).event,x=()=>e(T).imeta;var z=sa(),F=s(z);er(F,(Z,ce)=>j?.(Z,ce),()=>e(ae));var se=u(F,2),D=s(se),Ce=s(D),we=s(Ce);oe(we,()=>Qt.Root,(Z,ce)=>{ce(Z,{get ndk(){return Ze},get pubkey(){return c().pubkey},children:(Xe,U)=>{var L=I(),n=k(L);oe(n,()=>Qt.Avatar,(b,m)=>{m(b,{class:"w-10 h-10 rounded-full border-2 border-white"})}),r(Xe,L)},$$slots:{default:!0}})});var W=u(we,2),ne=s(W),de=s(ne,!0);o(ne),o(W),o(Ce),o(D);var ze=u(D,2),Le=s(ze);Le.__click=()=>_(d,!e(d));var De=s(Le);{var Me=Z=>{var ce=ra();r(Z,ce)},me=Z=>{var ce=oa();r(Z,ce)};y(De,Z=>{e(d)?Z(Me):Z(me,!1)})}o(Le),o(ze);var Pe=u(ze,2),ue=s(Pe),_e=s(ue),p=s(_e);{var A=Z=>{var ce=aa(),Xe=s(ce,!0);o(ce),H(U=>G(Xe,U),[()=>c().content.replace(x().url||"","").trim()]),r(Z,ce)};y(p,Z=>{c().content&&Z(A)})}o(_e);var Y=u(_e,2),xe=s(Y);Jr(xe,{get event(){return c()},variant:"tiktok"}),o(Y),o(ue),o(Pe),o(se),o(z),H(Z=>{je(F,"src",x().url),F.muted=e(d),G(de,Z),je(Le,"aria-label",e(d)?"Unmute":"Mute")},[()=>c().author?.profile?.name||c().author?.npub?.substring(0,8)]),r(N,z)}),o(R),Gt(R,N=>_(a,N),()=>e(a)),r(h,R)};y(S,h=>{e(v).length===0?h(O):h(Q,!1)})}r(g,$),yt()}Ft(["click"]);var la=i('<button><span class="text-xs">#</span> <span> </span></button>'),da=i('<button class="flex-shrink-0 inline-flex items-center gap-1 px-2 py-1.5 rounded-full text-xs font-medium bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-all" title="Clear all filters"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),ca=i("<!> <!>",1),ua=i('<h1 class="text-xl font-bold text-foreground"> </h1>'),va=i('<div><div class="py-2 pl-2 sm:p-4 w-full"><div class="flex items-center gap-2 min-w-0"><div class="flex-shrink-0 relative z-20"><!></div> <div class="flex items-center gap-2 overflow-x-auto scrollbar-hide flex-1 min-w-0 max-w-full"><!></div></div></div> <!></div>');function ha(g,t){wt(t,!0);const a=M(()=>t.selectedFilter==="videos");let d=re(null);xt(()=>{if(!e(d))return;const h=()=>{const R=e(a)?0:e(d).offsetHeight;document.documentElement.style.setProperty("--header-height",`${R}px`)};return h(),window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}});var l=va(),f=s(l),v=s(f),w=s(v),C=s(w);io(C,{iconOnly:!0}),o(w);var j=u(w,2),$=s(j);{var S=h=>{var R=ca(),N=k(R);Ye(N,17,()=>Zt.interests,jt,(c,x)=>{var z=la();z.__click=()=>gt.toggleHashtag(e(x));var F=u(s(z),2),se=s(F,!0);o(F),o(z),H(D=>{ut(z,1,`flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-all ${D??""}`),G(se,e(x))},[()=>gt.isSelected(e(x))?"bg-primary text-foreground border-2 border-primary-400":"bg-muted text-muted-foreground border-2 border-border hover:border"]),r(c,z)});var T=u(N,2);{var ae=c=>{var x=da();x.__click=()=>gt.clearAll(),r(c,x)};y(T,c=>{gt.hasFilters&&c(ae)})}r(h,R)},O=h=>{var R=I(),N=k(R);{var T=ae=>{var c=ua(),x=s(c,!0);o(c),H(()=>G(x,t.headerTitle.text)),r(ae,c)};y(N,ae=>{t.headerTitle&&ae(T)},!0)}r(h,R)};y($,h=>{Zt.interests.length>0?h(S):h(O,!1)})}o(j),o(v),o(f);var Q=u(f,2);ro(Q,{get selectedFilter(){return t.selectedFilter},get onFilterChange(){return t.onFilterChange}}),o(l),Gt(l,h=>_(d,h),()=>e(d)),H(()=>ut(l,1,`sticky top-0 z-10 bg-background/90 backdrop-blur-xl border-b border-border ${e(a)?"hidden":""}`)),r(g,l),yt()}Ft(["click"]);var pa=i('<button class="w-full px-3 py-2 text-sm text-left border border-primary rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors mb-4"><div class="flex items-center gap-2"><svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="text-primary font-medium"> </span></div> <p class="text-xs text-muted-foreground mt-1 ml-6">Press Enter or click to add</p></button>'),fa=i('<button class="inline-flex items-center gap-1 px-2.5 py-1 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary/20 transition-colors"><span> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),ga=i('<div class="mb-4 flex flex-wrap gap-2"></div>'),ma=i('<div class="text-center py-12"><svg class="w-12 h-12 text-muted-foreground mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path></svg> <p class="text-muted-foreground"> </p></div>'),_a=i('<button><span class="font-medium truncate"> </span> <span class="text-xs text-muted-foreground ml-2 flex-shrink-0"> </span></button>'),ba=i('<div class="grid grid-cols-2 gap-2"></div>'),xa=i('<p class="text-xs text-muted-foreground"> </p> <!>',1),wa=i('<!> <div class="mb-4"><!></div> <!> <!> <div class="flex-1 overflow-y-auto -mx-6 px-6"><!></div> <!>',1),ya=i('<button class="w-full px-3 py-2 text-sm text-left border border-primary rounded-lg bg-primary/5 hover:bg-primary/10 transition-colors mb-4"><div class="flex items-center gap-2"><svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> <span class="text-primary font-medium"> </span></div> <p class="text-xs text-muted-foreground mt-1 ml-6">Press Enter or click to add</p></button>'),ka=i('<button class="inline-flex items-center gap-1 px-2.5 py-1 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary/20 transition-colors"><span> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Ca=i('<div class="mb-4 flex flex-wrap gap-2"></div>'),Ma=i('<div class="text-center py-12"><svg class="w-12 h-12 text-muted-foreground mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path></svg> <p class="text-muted-foreground"> </p></div>'),Pa=i('<button><span class="font-medium truncate"> </span> <span class="text-xs text-muted-foreground ml-2 flex-shrink-0"> </span></button>'),$a=i('<div class="grid grid-cols-2 gap-2"></div>'),Ra=i('<p class="text-xs text-muted-foreground"> </p> <!>',1),ja=i('<!> <div class="px-4"><div class="mb-4"><!></div> <!> <!> <div class="flex-1 overflow-y-auto max-h-[50vh]"><!></div></div> <!>',1);function La(g,t){wt(t,!0);let a=ee(t,"selectedTags",19,()=>[]),d=ee(t,"open",15,!1);const l=new Lr("(min-width: 768px)");let f=re(Dt([])),v=re("");const w=M(()=>{if(!e(v))return e(f);const c=e(v).toLowerCase();return e(f).filter(x=>x.tag.toLowerCase().includes(c))}),C=M(()=>{if(!e(v).trim())return!1;const c=e(v).trim().toLowerCase().replace(/^#/,"");return!e(f).some(x=>x.tag.toLowerCase()===c)&&!a().some(x=>x.toLowerCase()===c)}),j=M(()=>Te.selectedRelay||Te.relays.find(c=>c.enabled&&c.read)?.url),$=Ze.$fetchEvents(()=>d()?{filters:{kinds:[1,20,21,22],limit:500},cacheUsage:e(j)?dr.ONLY_RELAY:dr.CACHE_FIRST,relayUrls:e(j)?[e(j)]:void 0}:void 0);xt(()=>{if(!$){_(f,[],!0);return}const c=new ko;for(const x of $){const z=x.tags.filter(F=>F[0]==="t"&&F[1]);for(const F of z){const se=F[1].toLowerCase();c.set(se,(c.get(se)||0)+1)}}_(f,Array.from(c.entries()).map(([x,z])=>({tag:x,count:z})).sort((x,z)=>z.count-x.count).slice(0,100),!0)});function S(c){a().includes(c)?t.onTagsChange?.(a().filter(x=>x!==c)):t.onTagsChange?.([...a(),c])}function O(){if(!e(C))return;const c=e(v).trim().toLowerCase().replace(/^#/,"");t.onTagsChange?.([...a(),c]),_(v,"")}function Q(c){c.key==="Enter"&&e(C)&&(c.preventDefault(),O())}function h(){d(!1),_(v,""),t.onClose?.()}var R=I(),N=k(R);{var T=c=>{var x=I(),z=k(x);oe(z,()=>zr,(F,se)=>{se(F,{get open(){return d()},onOpenChange:D=>{d(D),D||h()},children:(D,Ce)=>{var we=I(),W=k(we);oe(W,()=>Sr,(ne,de)=>{de(ne,{class:"max-w-xl max-h-[80vh] flex flex-col",children:(ze,Le)=>{var De=wa(),Me=k(De);oe(Me,()=>yo,(U,L)=>{L(U,{children:(n,b)=>{var m=I(),P=k(m);oe(P,()=>Tr,(q,V)=>{V(q,{children:(K,ve)=>{Oe();var Ae=bt("Select Hashtags");r(K,Ae)},$$slots:{default:!0}})}),r(n,m)},$$slots:{default:!0}})});var me=u(Me,2),Pe=s(me);fr(Pe,{type:"text",onkeydown:Q,placeholder:"Search hashtags...",autofocus:!0,get value(){return e(v)},set value(U){_(v,U,!0)}}),o(me);var ue=u(me,2);{var _e=U=>{var L=pa();L.__click=O;var n=s(L),b=u(s(n),2),m=s(b);o(b),o(n),Oe(2),o(L),H(P=>G(m,`Add custom tag: #${P??""}`),[()=>e(v).trim().toLowerCase().replace(/^#/,"")]),r(U,L)};y(ue,U=>{e(C)&&U(_e)})}var p=u(ue,2);{var A=U=>{var L=ga();Ye(L,20,a,n=>n,(n,b)=>{var m=fa();m.__click=()=>S(b);var P=s(m),q=s(P);o(P),Oe(2),o(m),H(()=>G(q,`#${b??""}`)),r(n,m)}),o(L),r(U,L)};y(p,U=>{a().length>0&&U(A)})}var Y=u(p,2),xe=s(Y);{var Z=U=>{var L=ma(),n=u(s(L),2),b=s(n,!0);o(n),o(L),H(()=>G(b,e(v)?"No hashtags found matching your search":"No popular hashtags found")),r(U,L)},ce=U=>{var L=ba();Ye(L,21,()=>e(w),({tag:n,count:b})=>n,(n,b)=>{let m=()=>e(b).tag,P=()=>e(b).count;const q=M(()=>a().includes(m()));var V=_a();V.__click=()=>S(m());var K=s(V),ve=s(K);o(K);var Ae=u(K,2),fe=s(Ae,!0);o(Ae),o(V),H(()=>{ut(V,1,`flex items-center justify-between px-3 py-2 rounded-lg border transition-colors ${e(q)?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50 hover:bg-muted"}`),G(ve,`#${m()??""}`),G(fe,P())}),r(n,V)}),o(L),r(U,L)};y(xe,U=>{e(w).length===0?U(Z):U(ce,!1)})}o(Y);var Xe=u(Y,2);oe(Xe,()=>Co,(U,L)=>{L(U,{class:"flex items-center justify-between pt-4 border-t border-border -mx-6 px-6",children:(n,b)=>{var m=xa(),P=k(m),q=s(P);o(P);var V=u(P,2);Ve(V,{onclick:h,children:(K,ve)=>{Oe();var Ae=bt("Done");r(K,Ae)},$$slots:{default:!0}}),H(()=>G(q,`${a().length??""} ${a().length===1?"tag":"tags"} selected`)),r(n,m)},$$slots:{default:!0}})}),r(ze,De)},$$slots:{default:!0}})}),r(D,we)},$$slots:{default:!0}})}),r(c,x)},ae=c=>{var x=I(),z=k(x);oe(z,()=>Hr,(F,se)=>{se(F,{get open(){return d()},onOpenChange:D=>{d(D),D||h()},children:(D,Ce)=>{var we=I(),W=k(we);oe(W,()=>Dr,(ne,de)=>{de(ne,{children:(ze,Le)=>{var De=ja(),Me=k(De);oe(Me,()=>Or,(L,n)=>{n(L,{class:"text-left",children:(b,m)=>{var P=I(),q=k(P);oe(q,()=>Fr,(V,K)=>{K(V,{children:(ve,Ae)=>{Oe();var fe=bt("Select Hashtags");r(ve,fe)},$$slots:{default:!0}})}),r(b,P)},$$slots:{default:!0}})});var me=u(Me,2),Pe=s(me),ue=s(Pe);fr(ue,{type:"text",onkeydown:Q,placeholder:"Search hashtags...",autofocus:!0,get value(){return e(v)},set value(L){_(v,L,!0)}}),o(Pe);var _e=u(Pe,2);{var p=L=>{var n=ya();n.__click=O;var b=s(n),m=u(s(b),2),P=s(m);o(m),o(b),Oe(2),o(n),H(q=>G(P,`Add custom tag: #${q??""}`),[()=>e(v).trim().toLowerCase().replace(/^#/,"")]),r(L,n)};y(_e,L=>{e(C)&&L(p)})}var A=u(_e,2);{var Y=L=>{var n=Ca();Ye(n,20,a,b=>b,(b,m)=>{var P=ka();P.__click=()=>S(m);var q=s(P),V=s(q);o(q),Oe(2),o(P),H(()=>G(V,`#${m??""}`)),r(b,P)}),o(n),r(L,n)};y(A,L=>{a().length>0&&L(Y)})}var xe=u(A,2),Z=s(xe);{var ce=L=>{var n=Ma(),b=u(s(n),2),m=s(b,!0);o(b),o(n),H(()=>G(m,e(v)?"No hashtags found matching your search":"No popular hashtags found")),r(L,n)},Xe=L=>{var n=$a();Ye(n,21,()=>e(w),({tag:b,count:m})=>b,(b,m)=>{let P=()=>e(m).tag,q=()=>e(m).count;const V=M(()=>a().includes(P()));var K=Pa();K.__click=()=>S(P());var ve=s(K),Ae=s(ve);o(ve);var fe=u(ve,2),Ke=s(fe,!0);o(fe),o(K),H(()=>{ut(K,1,`flex items-center justify-between px-3 py-2 rounded-lg border transition-colors ${e(V)?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50 hover:bg-muted"}`),G(Ae,`#${P()??""}`),G(Ke,q())}),r(b,K)}),o(n),r(L,n)};y(Z,L=>{e(w).length===0?L(ce):L(Xe,!1)})}o(xe),o(me);var U=u(me,2);oe(U,()=>Er,(L,n)=>{n(L,{class:"pt-2 flex items-center justify-between",children:(b,m)=>{var P=Ra(),q=k(P),V=s(q);o(q);var K=u(q,2);Ve(K,{onclick:h,children:(ve,Ae)=>{Oe();var fe=bt("Done");r(ve,fe)},$$slots:{default:!0}}),H(()=>G(V,`${a().length??""} ${a().length===1?"tag":"tags"} selected`)),r(b,P)},$$slots:{default:!0}})}),r(ze,De)},$$slots:{default:!0}})}),r(D,we)},$$slots:{default:!0}})}),r(c,x)};y(N,c=>{l.current?c(T):c(ae,!1)})}r(g,R),yt()}Ft(["click"]);function Sa(g,t,a=5){const d="0123456789bcdefghjkmnpqrstuvwxyz";let l=0,f=0,v=!0,w="",C=[-90,90],j=[-180,180];for(;w.length<a;){if(v){const $=(j[0]+j[1])/2;t>=$?(l|=1<<4-f,j[0]=$):j[1]=$}else{const $=(C[0]+C[1])/2;g>=$?(l|=1<<4-f,C[0]=$):C[1]=$}v=!v,f++,f===5&&(w+=d[l],f=0,l=0)}return w}var Ta=i("<button></button>"),za=i('<div class="absolute bottom-3 left-0 right-0 flex justify-center gap-1"></div>'),Da=i('<button><img alt="" class="w-full h-full object-cover rounded"/></button>'),Fa=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),Ha=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),Ea=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg> <!></div>'),Oa=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'),Aa=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),Na=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <!></div>'),Ia=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>'),Ba=i('<img alt="" class="w-5 h-5 rounded border border-background"/>'),Ua=i('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),Va=i('<div class="flex items-center -space-x-1"></div>'),Ka=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),Wa=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg> <!></div>'),qa=i('<div role="presentation"><div role="dialog" tabindex="-1"><!></div></div>'),Ga=i('<button class="inline-flex items-center gap-1 px-2.5 py-1 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary/20 transition-colors"><span> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Qa=i('<div class="flex flex-wrap gap-2 items-center"></div>'),Ya=i('<div class="text-sm text-muted-foreground flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> <span> </span> <button class="ml-1 hover:text-foreground transition-colors"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Xa=i('<div class="md:grid md:grid-cols-[2fr,3fr] md:h-full"><div class="md:border-r border-border md:p-6 p-0"><div class="relative w-full md:aspect-square md:rounded-lg overflow-hidden bg-black"><img class="w-full h-full object-contain"/> <button title="Remove this image" class="absolute top-2 right-2 p-2 bg-black/60 text-white rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm" aria-label="Remove image"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <!></div> <div class="hidden md:flex items-center gap-2 overflow-x-auto pb-2 mt-4"><!> <button title="Add more images" class="w-16 h-16 rounded border-2 border-dashed border-border hover:border-primary hover:bg-muted transition-all flex items-center justify-center flex-shrink-0" aria-label="Add more images"><svg class="w-6 h-6 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button></div></div> <div class="p-4 md:p-6 space-y-4 md:overflow-auto"><!> <div class="flex items-center gap-1 border-t border-border pt-3"><!> <!> <!> <!> <!> <div class="relative"><!></div></div> <!> <!> <!></div></div>'),Ja=i('<p class="text-sm text-muted-foreground"> </p>'),Za=i('<div class="flex flex-col items-center gap-2"><div class="w-12 h-12 border-4 border-border border-t-primary rounded-full animate-spin"></div> <!></div>'),es=i('<svg class="w-16 h-16 text-muted-foreground mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <p class="text-lg font-medium text-foreground mb-2">Drop images here</p> <p class="text-sm text-muted-foreground">or click to browse</p> <p class="text-xs text-muted-foreground mt-2">Multiple images supported</p>',1),ts=i('<p class="text-xs text-muted-foreground"> </p>'),rs=i('<div class="flex flex-col items-center gap-3"><div class="w-12 h-12 border-4 border-border border-t-primary rounded-full animate-spin"></div> <p class="text-sm text-muted-foreground">Uploading...</p> <!></div>'),os=i('<svg class="w-16 h-16 text-muted-foreground mb-4 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <p class="text-muted-foreground mb-4">No images selected</p> <!>',1),as=i('<div class="hidden md:flex items-center justify-center p-12 h-full"><div role="button" tabindex="0"><!></div></div> <div class="md:hidden flex items-center justify-center p-8 h-full min-h-[60vh]"><div class="text-center"><!></div></div>',1),ss=i('<div class="flex items-center justify-between px-4 md:px-6 py-3 md:py-4 border-b border-border bg-background"><button title="Close and discard post" class="text-foreground hover:text-muted-foreground transition-colors" aria-label="Close"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <!> <!></div> <div class="flex-1 overflow-auto"><input type="file" accept="image/*" multiple class="hidden"/> <!></div>',1),ns=i("<button></button>"),is=i('<div class="absolute bottom-3 left-0 right-0 flex justify-center gap-1"></div>'),ls=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),ds=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),cs=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg> <!></div>'),us=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'),vs=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),hs=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <!></div>'),ps=Mt('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>'),fs=i('<img alt="" class="w-5 h-5 rounded border border-background"/>'),gs=i('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),ms=i('<div class="flex items-center -space-x-1"></div>'),_s=i('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),bs=i('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg> <!></div>'),xs=i('<div role="presentation"><div role="dialog" tabindex="-1"><!></div></div>'),ws=i('<button class="inline-flex items-center gap-1 px-2.5 py-1 bg-primary/10 text-primary rounded-full text-sm hover:bg-primary/20 transition-colors"><span> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),ys=i('<div class="flex flex-wrap gap-2 items-center"></div>'),ks=i('<div class="text-sm text-muted-foreground flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> <span> </span> <button class="ml-1 hover:text-foreground transition-colors"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Cs=i('<div class="space-y-4"><div class="relative w-full overflow-hidden bg-black"><img class="w-full h-full object-contain"/> <button title="Remove this image" class="absolute top-2 right-2 p-2 bg-black/60 text-white rounded-full hover:bg-black/80 transition-colors backdrop-blur-sm" aria-label="Remove image"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <!></div> <!> <div class="flex items-center gap-1 border-t border-border pt-3"><!> <!> <!> <!> <!> <div class="relative"><!></div></div> <!> <!> <!></div>'),Ms=i('<p class="text-xs text-muted-foreground"> </p>'),Ps=i('<div class="flex flex-col items-center gap-3"><div class="w-12 h-12 border-4 border-border border-t-primary rounded-full animate-spin"></div> <p class="text-sm text-muted-foreground">Uploading...</p> <!></div>'),$s=i('<svg class="w-16 h-16 text-muted-foreground mb-4 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <p class="text-muted-foreground mb-4">No images selected</p> <!>',1),Rs=i('<div class="flex items-center justify-center p-8 h-full min-h-[60vh]"><div class="text-center"><!></div></div>'),js=i("<!> <!>",1),Ls=i('<!> <div class="px-4 overflow-auto flex-1"><input type="file" accept="image/*" multiple class="hidden"/> <!></div> <!>',1),Ss=i("<!> <!> <!>",1);function Ts(g,t){wt(t,!0);const a=new Lr("(min-width: 768px)");let d=ee(t,"open",15,!1),l=re(!1),f=re(0),v=re(!1),w=re(!1),C=re(!1),j=re(""),$=re(""),S=re(Dt([])),O=re(Dt([])),Q=re(!1),h=re(Dt([])),R,N=re(!1),T=re(!1);const ae=new co(Ze),c=uo(ae),x=M(()=>window.innerWidth<768),z=Zr(()=>d()),F=M(()=>z.selectedRelayUrls),se=M(()=>z.allRelays);xt(()=>{d()&&e(x)&&e(h).length===0&&setTimeout(()=>{R?.click()},300)});async function D(n){if(!n.type.startsWith("image/")){ft.error("Please select an image file");return}try{if(await c.upload(n,{fallbackServer:"https://blossom.primal.net"}),c.result?.url){const b=new Image,m=await new Promise(P=>{b.onload=()=>P({width:b.width,height:b.height}),b.src=URL.createObjectURL(n)});_(h,[...e(h),{url:c.result.url,mimeType:n.type,hash:c.result.sha256||"",blurhash:c.result.blurhash,dimensions:m}],!0),_(f,e(h).length-1)}}catch(b){console.error("Upload failed:",b),ft.error("Failed to upload image")}}function Ce(n){const m=n.target.files;m&&Array.from(m).forEach(P=>D(P))}function we(n){n.preventDefault(),_(N,!0)}function W(){_(N,!1)}async function ne(n){n.preventDefault(),_(N,!1);const b=n.dataTransfer?.files;b&&Array.from(b).forEach(m=>D(m))}function de(){R?.click()}function ze(n){_(h,e(h).filter((b,m)=>m!==n),!0),e(f)>=e(h).length&&_(f,Math.max(0,e(h).length-1),!0)}function Le(n){_(S,e(S).filter(b=>b!==n),!0)}function De(n){_(S,n,!0)}function Me(n){z.selectedRelayUrls.includes(n)?z.selectedRelayUrls=z.selectedRelayUrls.filter(b=>b!==n):z.selectedRelayUrls=[...z.selectedRelayUrls,n]}function me(n){z.selectedRelayUrls=[n],_(v,!1)}function Pe(){_(v,!1)}function ue(){navigator.geolocation?navigator.geolocation.getCurrentPosition(n=>{const b=n.coords.latitude,m=n.coords.longitude,P=Sa(b,m,5);_($,`Near ${P}`),ft.success("Location detected")},n=>{console.error("Error getting location:",n),ft.error("Could not get your location")}):ft.error("Geolocation is not supported")}async function _e(){if(!e(j).trim()||e(h).length===0||e(l)){e(h).length===0?ft.error("Please add at least one image"):ft.error("Please add a caption");return}if(!Ze.$currentUser){ft.error("Please log in to create a media post");return}if(e(F).length===0){ft.error("Please select at least one relay to publish to");return}try{_(l,!0);const n=new yr(Ze);if(n.kind=20,n.content=e(j).trim(),n.isProtected=e(T),e(h).forEach(m=>{const P=["imeta",`url ${m.url}`,`m ${m.mimeType}`];m.hash&&P.push(`x ${m.hash}`),m.blurhash&&P.push(`blurhash ${m.blurhash}`),m.dimensions&&P.push(`dim ${m.dimensions.width}x${m.dimensions.height}`),n.tags.push(P)}),e(S).forEach(m=>{n.tags.push(["t",m])}),e(O).forEach(m=>{n.tags.push(["p",m])}),e($).trim())if(e($).startsWith("Near ")){const m=e($).replace("Near ","");for(let P=3;P<=m.length;P++)n.tags.push(["g",m.substring(0,P)])}else n.tags.push(["location",e($).trim()]);e(Q)&&n.tags.push(["content-warning","nsfw"]),await n.sign();const b=Qr.fromRelayUrls(e(F),Ze);if(await n.publish(b),n.publishStatus==="error"){const P=n.publishError?.relayErrors||{},q=Object.entries(P).map(([V,K])=>`${V}: ${K}`).join(`
`);ft.error(`Failed to publish:
${q||"Unknown error"}`);return}ft.success("Posted!"),p(),d(!1),t.onClose?.()}catch(n){console.error("Failed to publish media post:",n),ft.error(`Failed to publish: ${n instanceof Error?n.message:"Unknown error"}`)}finally{_(l,!1)}}function p(){_(j,""),_($,""),_(S,[],!0),_(O,[],!0),_(h,[],!0),_(f,0),_(Q,!1),_(v,!1),_(w,!1),_(C,!1)}function A(){e(l)||(p(),d(!1),t.onClose?.())}function Y(n){n.key==="Escape"&&!e(l)&&A()}var xe=Ss();Ut("keydown",Vr,Y);var Z=k(xe);{var ce=n=>{var b=I(),m=k(b);oe(m,()=>zr,(P,q)=>{q(P,{get open(){return d()},onOpenChange:V=>{d(V),V||A()},children:(V,K)=>{var ve=I(),Ae=k(ve);oe(Ae,()=>Sr,(fe,Ke)=>{Ke(fe,{class:"max-md:!max-w-none max-md:!w-full max-md:!h-[100vh] max-md:!m-0 max-md:!rounded-none max-w-6xl max-h-[90vh] overflow-hidden flex flex-col p-0",children:(pe,$e)=>{var Fe=ss(),Se=k(Fe),He=s(Se);He.__click=A;var et=u(He,2);oe(et,()=>Tr,(be,Ne)=>{Ne(be,{class:"text-lg md:text-xl font-semibold",children:(Re,ge)=>{Oe();var Ie=bt("New Post");r(Re,Ie)},$$slots:{default:!0}})});var nt=u(et,2);{let be=M(()=>!e(j).trim()||e(h).length===0||e(l)||e(F).length===0);Ve(nt,{onclick:_e,get disabled(){return e(be)},size:"sm",class:"h-9 px-4",children:(Ne,Re)=>{Oe();var ge=bt();H(()=>G(ge,e(l)?"Posting...":"Post")),r(Ne,ge)},$$slots:{default:!0}})}o(Se);var at=u(Se,2),Lt=s(at);Lt.__change=Ce,Gt(Lt,be=>R=be,()=>R);var Ht=u(Lt,2);{var tt=be=>{var Ne=Xa(),Re=s(Ne),ge=s(Re),Ie=s(ge),Be=u(Ie,2);Be.__click=()=>ze(e(f));var rt=u(Be,2);{var st=E=>{var B=za();Ye(B,21,()=>e(h),jt,(le,X,J)=>{var Ue=Ta();Ue.__click=()=>_(f,J,!0),je(Ue,"title",`View image ${J+1}`),je(Ue,"aria-label",`View image ${J+1}`),H(()=>ut(Ue,1,`w-2 h-2 rounded-full transition-all ${e(f)===J?"bg-white w-6":"bg-white/50"}`)),r(le,Ue)}),o(B),r(E,B)};y(rt,E=>{e(h).length>1&&E(st)})}o(ge);var We=u(ge,2),vt=s(We);Ye(vt,17,()=>e(h),jt,(E,B,le)=>{var X=Da();X.__click=()=>_(f,le,!0),je(X,"title",`View image ${le+1}`),je(X,"aria-label",`View image ${le+1}`);var J=s(X);o(X),H(()=>{ut(X,1,`w-16 h-16 rounded border-2 transition-all flex-shrink-0 ${e(f)===le?"border-primary":"border-border"}`),je(J,"src",e(B).url)}),r(E,X)});var Pt=u(vt,2);Pt.__click=de,o(We),o(Re);var St=u(Re,2),Ee=s(St);{let E=M(()=>!e(x));gr(Ee,{placeholder:"Write a caption...",rows:4,get autofocus(){return e(E)},class:"resize-none border-0 focus-visible:ring-0 px-3 text-base placeholder:text-muted-foreground",get value(){return e(j)},set value(B){_(j,B,!0)}})}var qe=u(Ee,2),mt=s(qe);Ve(mt,{type:"button",variant:"ghost",size:"icon",onclick:de,get disabled(){return e(l)},title:"Add more images to your post",class:"h-8 w-8",children:(E,B)=>{var le=Fa();r(E,le)},$$slots:{default:!0}});var kt=u(mt,2);{let E=M(()=>e(S).length>0?"text-primary":"");Ve(kt,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(w,!0),get disabled(){return e(l)},title:"Add hashtags to categorize your post and make it discoverable",get class(){return`h-8 w-8 ${e(E)??""}`},children:(B,le)=>{var X=Ea(),J=u(s(X),2);{var Ue=Qe=>{var Je=Ha(),Ct=s(Je,!0);o(Je),H(()=>G(Ct,e(S).length)),r(Qe,Je)};y(J,Qe=>{e(S).length>0&&Qe(Ue)})}o(X),r(B,X)},$$slots:{default:!0}})}var lt=u(kt,2);{let E=M(()=>e($)?"text-primary":"");Ve(lt,{type:"button",variant:"ghost",size:"icon",onclick:ue,get disabled(){return e(l)},title:"Add location - uses your device's GPS to tag where this was posted",get class(){return`h-8 w-8 ${e(E)??""}`},children:(B,le)=>{var X=Oa();r(B,X)},$$slots:{default:!0}})}var dt=u(lt,2);{let E=M(()=>e(O).length>0?"text-primary":"");Ve(dt,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(C,!0),get disabled(){return e(l)},title:"Tag people in this post - they'll be notified",get class(){return`h-8 w-8 ${e(E)??""}`},children:(B,le)=>{var X=Na(),J=u(s(X),2);{var Ue=Qe=>{var Je=Aa(),Ct=s(Je,!0);o(Je),H(()=>G(Ct,e(O).length)),r(Qe,Je)};y(J,Qe=>{e(O).length>0&&Qe(Ue)})}o(X),r(B,X)},$$slots:{default:!0}})}var $t=u(dt,2);{let E=M(()=>e(Q)?"text-primary":"");Ve($t,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(Q,!e(Q)),get disabled(){return e(l)},title:"Mark as sensitive content (NSFW)",get class(){return`h-8 w-8 ${e(E)??""}`},children:(B,le)=>{var X=Ia();r(B,X)},$$slots:{default:!0}})}var Nt=u($t,2),ie=s(Nt);Ve(ie,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(v,!e(v)),get disabled(){return e(l)},title:"Choose which relays to publish this post to",class:"h-8 w-8",children:(E,B)=>{var le=I(),X=k(le);{var J=Qe=>{var Je=Va();Ye(Je,21,()=>e(F),jt,(Ct,pt)=>{const _t=M(()=>e(se).find(Rt=>Rt.url===e(pt))),zt=M(()=>e(_t)?Yt(e(_t).url):null);var It=I(),Nr=k(It);{var Ir=Rt=>{var Bt=Ba();H(()=>je(Bt,"src",e(zt).info.icon)),r(Rt,Bt)},Br=Rt=>{var Bt=Ua();r(Rt,Bt)};y(Nr,Rt=>{e(zt)?.info?.icon?Rt(Ir):Rt(Br,!1)})}r(Ct,It)}),o(Je),r(Qe,Je)},Ue=Qe=>{var Je=Wa(),Ct=u(s(Je),2);{var pt=_t=>{var zt=Ka(),It=s(zt,!0);o(zt),H(()=>G(It,e(F).length)),r(_t,zt)};y(Ct,_t=>{e(F).length>2&&_t(pt)})}o(Je),r(Qe,Je)};y(X,Qe=>{e(F).length<=2&&e(F).length>0?Qe(J):Qe(Ue,!1)})}r(E,le)},$$slots:{default:!0}}),o(Nt),o(qe);var te=u(qe,2);{var ye=E=>{var B=qa();B.__click=Pe,B.__keydown=J=>J.key==="Escape"&&Pe();var le=s(B);le.__click=J=>J.stopPropagation(),le.__keydown=J=>J.stopPropagation();var X=s(le);mr(X,{get selectedRelayUrls(){return e(F)},onToggleRelay:Me,onSelectOnly:me,get isProtected(){return e(T)},set isProtected(J){_(T,J,!0)}}),o(le),o(B),er(B,J=>_r?.(J)),H(()=>{ut(B,1,`fixed inset-0 bg-black/50 z-[100] flex items-center justify-center transition-opacity ${e(v)?"opacity-100":"opacity-0"}`),ut(le,1,`bg-popover border border-border rounded-lg shadow-xl w-80 max-h-[400px] overflow-y-auto transition-all ${e(v)?"scale-100 opacity-100":"scale-95 opacity-0"}`)}),r(E,B)};y(te,E=>{e(v)&&E(ye)})}var ke=u(te,2);{var he=E=>{var B=Qa();Ye(B,21,()=>e(S),jt,(le,X)=>{var J=Ga();J.__click=()=>Le(e(X));var Ue=s(J),Qe=s(Ue);o(Ue),Oe(2),o(J),H(()=>G(Qe,`#${e(X)??""}`)),r(le,J)}),o(B),r(E,B)};y(ke,E=>{e(S).length>0&&E(he)})}var ot=u(ke,2);{var Ge=E=>{var B=Ya(),le=u(s(B),2),X=s(le,!0);o(le);var J=u(le,2);J.__click=()=>_($,""),o(B),H(()=>G(X,e($))),r(E,B)};y(ot,E=>{e($)&&E(Ge)})}o(St),o(Ne),H(()=>{je(Ie,"src",e(h)[e(f)].url),je(Ie,"alt",`Image ${e(f)+1}`)}),r(be,Ne)},it=be=>{var Ne=as(),Re=k(Ne),ge=s(Re);ge.__click=de,ge.__keydown=Ee=>Ee.key==="Enter"&&de();var Ie=s(ge);{var Be=Ee=>{var qe=Za(),mt=u(s(qe),2);{var kt=lt=>{var dt=Ja(),$t=s(dt);o(dt),H(()=>G($t,`${c.progress.percentage??""}%`)),r(lt,dt)};y(mt,lt=>{c.progress&&lt(kt)})}o(qe),r(Ee,qe)},rt=Ee=>{var qe=es();Oe(6),r(Ee,qe)};y(Ie,Ee=>{c.status==="uploading"?Ee(Be):Ee(rt,!1)})}o(ge),o(Re);var st=u(Re,2),We=s(st),vt=s(We);{var Pt=Ee=>{var qe=rs(),mt=u(s(qe),4);{var kt=lt=>{var dt=ts(),$t=s(dt);o(dt),H(()=>G($t,`${c.progress.percentage??""}%`)),r(lt,dt)};y(mt,lt=>{c.progress&&lt(kt)})}o(qe),r(Ee,qe)},St=Ee=>{var qe=os(),mt=u(k(qe),4);Ve(mt,{onclick:de,children:(kt,lt)=>{Oe();var dt=bt("Choose Photos");r(kt,dt)},$$slots:{default:!0}}),r(Ee,qe)};y(vt,Ee=>{c.status==="uploading"?Ee(Pt):Ee(St,!1)})}o(We),o(st),H(()=>ut(ge,1,`w-full max-w-md aspect-square rounded-lg border-2 border-dashed border-border hover:border-primary hover:bg-muted/50 transition-all flex flex-col items-center justify-center cursor-pointer ${e(N)?"border-primary bg-muted/50":""} ${c.status==="uploading"?"pointer-events-none":""}`)),Ut("dragover",ge,we),Ut("dragleave",ge,W),Ut("drop",ge,ne),r(be,Ne)};y(Ht,be=>{e(h).length>0?be(tt):be(it,!1)})}o(at),H(()=>He.disabled=e(l)),r(pe,Fe)},$$slots:{default:!0}})}),r(V,ve)},$$slots:{default:!0}})}),r(n,b)},Xe=n=>{var b=I(),m=k(b);oe(m,()=>Hr,(P,q)=>{q(P,{get open(){return d()},onOpenChange:V=>{d(V),V||A()},children:(V,K)=>{var ve=I(),Ae=k(ve);oe(Ae,()=>Dr,(fe,Ke)=>{Ke(fe,{children:(pe,$e)=>{var Fe=Ls(),Se=k(Fe);oe(Se,()=>Or,(tt,it)=>{it(tt,{class:"text-left",children:(be,Ne)=>{var Re=I(),ge=k(Re);oe(ge,()=>Fr,(Ie,Be)=>{Be(Ie,{children:(rt,st)=>{Oe();var We=bt("New Post");r(rt,We)},$$slots:{default:!0}})}),r(be,Re)},$$slots:{default:!0}})});var He=u(Se,2),et=s(He);et.__change=Ce,Gt(et,tt=>R=tt,()=>R);var nt=u(et,2);{var at=tt=>{var it=Cs(),be=s(it),Ne=s(be),Re=u(Ne,2);Re.__click=()=>ze(e(f));var ge=u(Re,2);{var Ie=ie=>{var te=is();Ye(te,21,()=>e(h),jt,(ye,ke,he)=>{var ot=ns();ot.__click=()=>_(f,he,!0),je(ot,"title",`View image ${he+1}`),je(ot,"aria-label",`View image ${he+1}`),H(()=>ut(ot,1,`w-2 h-2 rounded-full transition-all ${e(f)===he?"bg-white w-6":"bg-white/50"}`)),r(ye,ot)}),o(te),r(ie,te)};y(ge,ie=>{e(h).length>1&&ie(Ie)})}o(be);var Be=u(be,2);{let ie=M(()=>!e(x));gr(Be,{placeholder:"Write a caption...",rows:4,get autofocus(){return e(ie)},class:"resize-none border-0 focus-visible:ring-0 px-3 text-base placeholder:text-muted-foreground",get value(){return e(j)},set value(te){_(j,te,!0)}})}var rt=u(Be,2),st=s(rt);Ve(st,{type:"button",variant:"ghost",size:"icon",onclick:de,get disabled(){return e(l)},title:"Add more images to your post",class:"h-8 w-8",children:(ie,te)=>{var ye=ls();r(ie,ye)},$$slots:{default:!0}});var We=u(st,2);{let ie=M(()=>e(S).length>0?"text-primary":"");Ve(We,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(w,!0),get disabled(){return e(l)},title:"Add hashtags to categorize your post and make it discoverable",get class(){return`h-8 w-8 ${e(ie)??""}`},children:(te,ye)=>{var ke=cs(),he=u(s(ke),2);{var ot=Ge=>{var E=ds(),B=s(E,!0);o(E),H(()=>G(B,e(S).length)),r(Ge,E)};y(he,Ge=>{e(S).length>0&&Ge(ot)})}o(ke),r(te,ke)},$$slots:{default:!0}})}var vt=u(We,2);{let ie=M(()=>e($)?"text-primary":"");Ve(vt,{type:"button",variant:"ghost",size:"icon",onclick:ue,get disabled(){return e(l)},title:"Add location - uses your device's GPS to tag where this was posted",get class(){return`h-8 w-8 ${e(ie)??""}`},children:(te,ye)=>{var ke=us();r(te,ke)},$$slots:{default:!0}})}var Pt=u(vt,2);{let ie=M(()=>e(O).length>0?"text-primary":"");Ve(Pt,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(C,!0),get disabled(){return e(l)},title:"Tag people in this post - they'll be notified",get class(){return`h-8 w-8 ${e(ie)??""}`},children:(te,ye)=>{var ke=hs(),he=u(s(ke),2);{var ot=Ge=>{var E=vs(),B=s(E,!0);o(E),H(()=>G(B,e(O).length)),r(Ge,E)};y(he,Ge=>{e(O).length>0&&Ge(ot)})}o(ke),r(te,ke)},$$slots:{default:!0}})}var St=u(Pt,2);{let ie=M(()=>e(Q)?"text-primary":"");Ve(St,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(Q,!e(Q)),get disabled(){return e(l)},title:"Mark as sensitive content (NSFW)",get class(){return`h-8 w-8 ${e(ie)??""}`},children:(te,ye)=>{var ke=ps();r(te,ke)},$$slots:{default:!0}})}var Ee=u(St,2),qe=s(Ee);Ve(qe,{type:"button",variant:"ghost",size:"icon",onclick:()=>_(v,!e(v)),get disabled(){return e(l)},title:"Choose which relays to publish this post to",class:"h-8 w-8",children:(ie,te)=>{var ye=I(),ke=k(ye);{var he=Ge=>{var E=ms();Ye(E,21,()=>e(F),jt,(B,le)=>{const X=M(()=>e(se).find(pt=>pt.url===e(le))),J=M(()=>e(X)?Yt(e(X).url):null);var Ue=I(),Qe=k(Ue);{var Je=pt=>{var _t=fs();H(()=>je(_t,"src",e(J).info.icon)),r(pt,_t)},Ct=pt=>{var _t=gs();r(pt,_t)};y(Qe,pt=>{e(J)?.info?.icon?pt(Je):pt(Ct,!1)})}r(B,Ue)}),o(E),r(Ge,E)},ot=Ge=>{var E=bs(),B=u(s(E),2);{var le=X=>{var J=_s(),Ue=s(J,!0);o(J),H(()=>G(Ue,e(F).length)),r(X,J)};y(B,X=>{e(F).length>2&&X(le)})}o(E),r(Ge,E)};y(ke,Ge=>{e(F).length<=2&&e(F).length>0?Ge(he):Ge(ot,!1)})}r(ie,ye)},$$slots:{default:!0}}),o(Ee),o(rt);var mt=u(rt,2);{var kt=ie=>{var te=xs();te.__click=Pe,te.__keydown=he=>he.key==="Escape"&&Pe();var ye=s(te);ye.__click=he=>he.stopPropagation(),ye.__keydown=he=>he.stopPropagation();var ke=s(ye);mr(ke,{get selectedRelayUrls(){return e(F)},onToggleRelay:Me,onSelectOnly:me,get isProtected(){return e(T)},set isProtected(he){_(T,he,!0)}}),o(ye),o(te),er(te,he=>_r?.(he)),H(()=>{ut(te,1,`fixed inset-0 bg-black/50 z-[100] flex items-center justify-center transition-opacity ${e(v)?"opacity-100":"opacity-0"}`),ut(ye,1,`bg-popover border border-border rounded-lg shadow-xl w-80 max-h-[400px] overflow-y-auto transition-all ${e(v)?"scale-100 opacity-100":"scale-95 opacity-0"}`)}),r(ie,te)};y(mt,ie=>{e(v)&&ie(kt)})}var lt=u(mt,2);{var dt=ie=>{var te=ys();Ye(te,21,()=>e(S),jt,(ye,ke)=>{var he=ws();he.__click=()=>Le(e(ke));var ot=s(he),Ge=s(ot);o(ot),Oe(2),o(he),H(()=>G(Ge,`#${e(ke)??""}`)),r(ye,he)}),o(te),r(ie,te)};y(lt,ie=>{e(S).length>0&&ie(dt)})}var $t=u(lt,2);{var Nt=ie=>{var te=ks(),ye=u(s(te),2),ke=s(ye,!0);o(ye);var he=u(ye,2);he.__click=()=>_($,""),o(te),H(()=>G(ke,e($))),r(ie,te)};y($t,ie=>{e($)&&ie(Nt)})}o(it),H(()=>{je(Ne,"src",e(h)[e(f)].url),je(Ne,"alt",`Image ${e(f)+1}`)}),r(tt,it)},Lt=tt=>{var it=Rs(),be=s(it),Ne=s(be);{var Re=Ie=>{var Be=Ps(),rt=u(s(Be),4);{var st=We=>{var vt=Ms(),Pt=s(vt);o(vt),H(()=>G(Pt,`${c.progress.percentage??""}%`)),r(We,vt)};y(rt,We=>{c.progress&&We(st)})}o(Be),r(Ie,Be)},ge=Ie=>{var Be=$s(),rt=u(k(Be),4);Ve(rt,{onclick:de,children:(st,We)=>{Oe();var vt=bt("Choose Photos");r(st,vt)},$$slots:{default:!0}}),r(Ie,Be)};y(Ne,Ie=>{c.status==="uploading"?Ie(Re):Ie(ge,!1)})}o(be),o(it),r(tt,it)};y(nt,tt=>{e(h).length>0?tt(at):tt(Lt,!1)})}o(He);var Ht=u(He,2);oe(Ht,()=>Er,(tt,it)=>{it(tt,{class:"pt-2",children:(be,Ne)=>{var Re=js(),ge=k(Re);{let Be=M(()=>!e(j).trim()||e(h).length===0||e(l)||e(F).length===0);Ve(ge,{onclick:_e,get disabled(){return e(Be)},class:"w-full",children:(rt,st)=>{Oe();var We=bt();H(()=>G(We,e(l)?"Posting...":"Post")),r(rt,We)},$$slots:{default:!0}})}var Ie=u(ge,2);Ve(Ie,{variant:"outline",onclick:A,get disabled(){return e(l)},class:"w-full",children:(Be,rt)=>{Oe();var st=bt("Cancel");r(Be,st)},$$slots:{default:!0}}),r(be,Re)},$$slots:{default:!0}})}),r(pe,Fe)},$$slots:{default:!0}})}),r(V,ve)},$$slots:{default:!0}})}),r(n,b)};y(Z,n=>{a.current?n(ce):n(Xe,!1)})}var U=u(Z,2);La(U,{get selectedTags(){return e(S)},onTagsChange:De,get open(){return e(w)},set open(n){_(w,n,!0)}});var L=u(U,2);eo(L,{buttonClass:"hidden",iconOnly:!1,get open(){return e(C)},set open(n){_(C,n,!0)},get selectedPubkeys(){return e(O)},set selectedPubkeys(n){_(O,n,!0)}}),r(g,xe),yt()}Ft(["click","change","keydown"]);function zs(g,t){const a=Po(t);let d=re(null);xt(()=>{const{event:w}=g();if(!w?.id){_(d,null);return}_(d,a.$subscribe(()=>({filters:[{kinds:[ct.Repost,ct.GenericRepost],...w.filter()},{"#q":[w.tagId()]}],closeOnEose:!1})),!0)});const l=M(()=>{const w=e(d);if(!w)return{count:0,hasReposted:!1,pubkeys:[]};const C=w.events;if(!C)return{count:0,hasReposted:!1,pubkeys:[]};let j;const $=new Set;for(const O of C)$.add(O.pubkey),a.$currentPubkey&&O.pubkey===a.$currentPubkey&&(j=O);const S=!!j;return{count:$.size,hasReposted:S,pubkeys:Array.from($),userRepost:j}});async function f(){const{event:w}=g();if(!w?.id)throw new Error("No event to repost");if(!a.$currentPubkey)throw new Error("User must be logged in to repost");return e(l).hasReposted&&e(l).userRepost?(await e(l).userRepost.delete(),e(l).userRepost):await w.repost(!0)}async function v(w){const{event:C}=g();if(!C?.id)throw new Error("No event to quote");if(!a.$currentPubkey)throw new Error("User must be logged in to quote");const j=new yr(t,{kind:ct.Text,content:w});return j.tag(C,void 0,!1,"q"),await j.publish(),j}return{get count(){return e(l).count},get hasReposted(){return e(l).hasReposted},get pubkeys(){return e(l).pubkeys},repost:f,quote:v}}var Ds=Mt('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M16.3884 3L17.3913 3.97574C17.8393 4.41165 18.0633 4.62961 17.9844 4.81481C17.9056 5 17.5888 5 16.9552 5H9.19422C5.22096 5 2 8.13401 2 12C2 13.4872 2.47668 14.8662 3.2895 16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M7.61156 21L6.60875 20.0243C6.16074 19.5883 5.93673 19.3704 6.01557 19.1852C6.09441 19 6.4112 19 7.04478 19H14.8058C18.779 19 22 15.866 22 12C22 10.5128 21.5233 9.13383 20.7105 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Jt(g,t){let a=ee(t,"class",3,""),d=ee(t,"size",3,18);var l=Ds();H(()=>{je(l,"width",d()),je(l,"height",d()),ut(l,0,kr(a()))}),r(g,l)}var Fs=i('<span class="text-sm font-medium"> </span>'),Hs=i("<!> <!>",1),Es=i('<button type="button" class="relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50"><!> Repost</button> <button type="button" class="relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50"><svg class="mr-2 h-3.5 w-3.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path></svg> Quote</button>',1),Os=i("<!> <!>",1),As=i('<span class="text-sm font-medium"> </span>'),Ns=i('<button data-repost-button=""><!> <!></button>');function Is(g,t){wt(t,!0);let a=ee(t,"variant",3,"ghost"),d=ee(t,"showCount",3,!0),l=ee(t,"openDelay",3,200),f=ee(t,"closeDelay",3,300),v=ee(t,"class",3,"");const w=Kr("ndk"),C=t.ndk||w,j=zs(()=>({event:t.event}),C);let $=re(!1);const S=M(()=>!!t.onquote);async function O(){if(C?.$currentPubkey)try{await j.repost(),_($,!1)}catch(c){console.error("Failed to repost:",c)}}function Q(){t.onquote?.(),_($,!1)}function h(){t.onclick?t.onclick():e(S)||O()}var R=I(),N=k(R);{var T=c=>{var x=I(),z=k(x);oe(z,()=>Io,(F,se)=>{se(F,{get openDelay(){return l()},get closeDelay(){return f()},get open(){return e($)},set open(D){_($,D,!0)},children:(D,Ce)=>{var we=Os(),W=k(we);{let de=M(()=>j.hasReposted?"":void 0),ze=M(()=>tr("inline-flex items-center gap-2 cursor-pointer transition-all",a()==="ghost"&&"p-2 bg-transparent border-none hover:bg-accent",a()==="outline"&&"px-3 py-2 bg-transparent border border-border rounded-md hover:bg-accent",a()==="pill"&&"px-4 py-2 bg-transparent border border-border rounded-full hover:bg-accent",a()==="solid"&&"px-4 py-2 bg-muted border border-border rounded-md hover:bg-accent",j.hasReposted&&"text-green-500",v())),Le=M(()=>`Repost (${j.count})`);oe(W,()=>Go,(De,Me)=>{Me(De,{"data-repost-button":"",get"data-reposted"(){return e(de)},get"data-variant"(){return a()},"data-dropdown":"",get class(){return e(ze)},get"aria-label"(){return e(Le)},children:(me,Pe)=>{var ue=Hs(),_e=k(ue);Jt(_e,{size:16,class:"flex-shrink-0"});var p=u(_e,2);{var A=Y=>{var xe=Fs(),Z=s(xe,!0);o(xe),H(()=>G(Z,j.count)),r(Y,xe)};y(p,Y=>{d()&&j.count>0&&Y(A)})}r(me,ue)},$$slots:{default:!0}})})}var ne=u(W,2);oe(ne,()=>Wo,(de,ze)=>{ze(de,{class:"z-50 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover p-1 text-popover-foreground shadow-md",align:"start",sideOffset:4,children:(Le,De)=>{var Me=Es(),me=k(Me);me.__click=O;var Pe=s(me);Jt(Pe,{size:14,class:"mr-2"}),Oe(),o(me);var ue=u(me,2);ue.__click=Q,r(Le,Me)},$$slots:{default:!0}})}),r(D,we)},$$slots:{default:!0}})}),r(c,x)},ae=c=>{var x=Ns();x.__click=h;var z=s(x);Jt(z,{size:16,class:"flex-shrink-0"});var F=u(z,2);{var se=D=>{var Ce=As(),we=s(Ce,!0);o(Ce),H(()=>G(we,j.count)),r(D,Ce)};y(F,D=>{d()&&j.count>0&&D(se)})}o(x),H(D=>{je(x,"data-reposted",j.hasReposted?"":void 0),je(x,"data-variant",a()),ut(x,1,D),je(x,"aria-label",`Repost (${j.count})`)},[()=>kr(tr("inline-flex items-center gap-2 cursor-pointer transition-all",a()==="ghost"&&"p-2 bg-transparent border-none hover:bg-accent",a()==="outline"&&"px-3 py-2 bg-transparent border border-border rounded-md hover:bg-accent",a()==="pill"&&"px-4 py-2 bg-transparent border border-border rounded-full hover:bg-accent",a()==="solid"&&"px-4 py-2 bg-muted border border-border rounded-md hover:bg-accent",j.hasReposted&&"text-green-500",v()))]),r(c,x)};y(N,c=>{e(S)?c(T):c(ae,!1)})}r(g,R),yt()}Ft(["click"]);var Bs=i("<!> <!>",1),Us=i('<div class="flex items-start justify-between gap-2"><!> <!></div> <!> <!>',1);function Vs(g,t){wt(t,!0),ee(t,"interactive",3,!1);let a=ee(t,"showActions",3,!0),d=ee(t,"showDropdown",3,!0),l=ee(t,"class",3,"");var f=I(),v=k(f);{let w=M(()=>tr("p-4 rounded-lg border border-border bg-card","hover:bg-accent/50 transition-colors",l()));oe(v,()=>Et.Root,(C,j)=>{j(C,{"data-event-card-classic":"",get ndk(){return t.ndk},get event(){return t.event},get class(){return e(w)},children:($,S)=>{var O=Us(),Q=k(O),h=s(Q);oe(h,()=>Et.Header,(x,z)=>{z(x,{})});var R=u(h,2);{var N=x=>{var z=I(),F=k(z);oe(F,()=>Et.Dropdown,(se,D)=>{D(se,{})}),r(x,z)};y(R,x=>{d()&&x(N)})}o(Q);var T=u(Q,2);oe(T,()=>Et.Content,(x,z)=>{z(x,{get truncate(){return t.truncate}})});var ae=u(T,2);{var c=x=>{var z=I(),F=k(z);oe(F,()=>Et.Actions,(se,D)=>{D(se,{children:(Ce,we)=>{var W=Bs(),ne=k(W);Is(ne,{get ndk(){return t.ndk},get event(){return t.event}});var de=u(ne,2);to(de,{get ndk(){return t.ndk},get event(){return t.event}}),r(Ce,W)},$$slots:{default:!0}})}),r(x,z)};y(ae,x=>{a()&&x(c)})}r($,O)},$$slots:{default:!0}})})}r(g,f),yt()}var Ks=i('<div class="p-8 text-center text-muted-foreground">No articles found</div>'),Ws=i('<div class="p-8 text-center text-muted-foreground">Loading articles...</div>'),qs=i('<div class="snap-start snap-always"><!></div>'),Gs=i('<div class="py-6 border-b border-border max-w-screen"><h2 class="text-lg font-bold text-foreground mb-4 flex items-center gap-2 px-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path></svg> Featured</h2> <div class="overflow-x-auto overflow-y-hidden scrollbar-hide snap-x snap-mandatory touch-pan-x"><div class="flex gap-4 px-4 pb-2"></div></div></div>'),Qs=i('<div class="min-w-0"><!></div>'),Ys=i('<div class="px-4 py-6 border-b border-border"><h2 class="text-lg font-bold text-foreground mb-4 flex items-center gap-2"><svg class="w-5 h-5 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path></svg> Recent Highlights</h2> <div class="grid grid-cols-2 gap-4 w-full"></div></div>'),Xs=i('<div class="px-4 py-6"><h2 class="text-lg font-bold text-foreground mb-4 flex items-center gap-2"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> Latest Articles</h2> <div class="divide-y divide-neutral-800/50 -mx-4"></div></div>'),Js=i("<!> <!> <!>",1),Zs=i('<div class="pb-6"><!></div> <!>',1),en=i('<div class="p-8 text-center text-muted-foreground">No videos found</div>'),tn=i('<div class="p-8 text-center text-muted-foreground">Loading videos...</div>'),rn=i('<div class="p-8 text-center text-muted-foreground">No images found</div>'),on=i('<div class="p-8 text-center text-muted-foreground">Loading images...</div>'),an=i('<div class="sm:p-4"><!></div>'),sn=i('<div class="flex justify-center py-2 lg:relative lg:static fixed bottom-20 left-0 right-0 z-[500] lg:z-auto pointer-events-none"><button class="flex items-center gap-2 px-4 py-2 bg-neutral-900/95 hover:bg-muted border border-primary/50 lg:border-border rounded-full transition-all shadow-lg backdrop-blur-sm pointer-events-auto"><div class="flex -space-x-2"></div> <span class="text-sm text-primary lg:text-foreground font-medium"> </span></button></div>'),nn=i('<div class="p-8 text-center text-muted-foreground">No notes found</div>'),ln=i("<!> <!> <!>",1),dn=i('<div class="max-w-full mx-auto"><div class="divide-y divide-neutral-800/50"><!></div></div> <!>',1);function Gn(g,t){wt(t,!0);const a=()=>qr(Mo,"$page",d),[d,l]=Wr(),f=p=>{ha(p,{get headerTitle(){return e(ze)},get selectedFilter(){return e(v)},onFilterChange:A=>_(v,A,!0)})};let v=re("conversations");const w=M(()=>a().url.searchParams.get("relay"));xt(()=>{e(w)&&e(w)!==Te.selectedRelay&&Te.setSelectedRelay(e(w))}),xt(()=>{lo.set(e(v))});const C=M(()=>Yr(e(w)||Te.selectedRelay,Te.relays.filter(p=>p.enabled&&p.read).map(p=>p.url))),j=M(()=>Ze.$sessions?.follows||[]),$=M(()=>Array.from(e(j)));function S(p){return p?.startsWith("followpack:")??!1}let O=re(null);xt(()=>{if(!Te.selectedRelay||!S(Te.selectedRelay)){_(O,null);return}const p=Te.selectedRelay.replace("followpack:","");Ze.fetchEvent(p).then(A=>{_(O,A,!0)}).catch(A=>{console.error("Failed to fetch selected pack:",A),_(O,null)})});const Q=M(()=>e(O)?e(O).tags.filter(p=>p[0]==="p").map(p=>p[1]):Te.selectedRelay?[]:e($));console.log("[HomePage] Creating subscriptions");const h=Vt(Ze,()=>{const p=[{kinds:[ct.Text,9802],limit:200}];return gt.hasFilters&&(p[0]["#t"]=gt.selectedHashtags),(!Te.selectedRelay||S(Te.selectedRelay))&&e(Q).length>0&&(p[0].authors=e(Q)),!S&&Ze.$currentPubkey?(console.log("adding a filter for self"),p.push({...p[0],authors:[Ze.$currentPubkey]})):console.log("not adding filter for self",S,!!Ze.$currentPubkey),{filters:p,relayUrls:e(C).length>0?e(C):void 0,subId:"notes",cacheUnconstrainFilter:[],exclusiveRelay:!0}},{initialLimit:20,pageSize:20});console.log("[HomePage] Notes subscription created");const R=Vt(Ze,()=>{const p={kinds:[ct.Text,ct.Image,ct.Video,ct.ShortVideo],limit:300};return gt.hasFilters&&(p["#t"]=gt.selectedHashtags),(!Te.selectedRelay||S(Te.selectedRelay))&&e(Q).length>0&&(p.authors=e(Q)),{filters:[p],relayUrls:e(C).length>0?e(C):void 0,cacheUnconstrainFilter:[],subId:"home-media",exclusiveRelay:e(C).length>0}},{initialLimit:30,pageSize:30}),N=Vt(Ze,()=>{const p={kinds:[ct.Article],limit:100};return gt.hasFilters&&(p["#t"]=gt.selectedHashtags),(!Te.selectedRelay||S(Te.selectedRelay))&&e(Q).length>0&&(p.authors=e(Q)),{filters:[p],subId:"articles",exclusiveRelay:e(C).length>0,relayUrls:e(C).length>0?e(C):void 0}},{initialLimit:10,pageSize:10}),T=Vt(Ze,()=>{const p={kinds:[9802],limit:100};return gt.hasFilters&&(p["#t"]=gt.selectedHashtags),(!Te.selectedRelay||S(Te.selectedRelay))&&e(Q).length>0&&(p.authors=e(Q)),{filters:[p],subId:"highlights",exclusiveRelay:e(C).length>0,relayUrls:e(C).length>0?e(C):void 0}},{initialLimit:10,pageSize:10}),ae=M(()=>N.events.map(p=>Xr.from(p))),c=M(()=>e(ae).filter(p=>p.title&&p.content).sort((p,A)=>(A.published_at??A.created_at??0)-(p.published_at??p.created_at??0))),x=M(()=>{const p=e(c).filter(Y=>Y.image),A=e(c).filter(Y=>!Y.image);return[...p,...A].slice(0,10)}),z=M(()=>T.events.slice(0,10)),F=M(()=>e(c).slice(10));function se(p,A){return(A==="image"?/(https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg|avif))/gi:/(https?:\/\/[^\s]+\.(mp4|webm|mov|avi|mkv))/gi).test(p)}const D=M(()=>e(v)==="images"?R.events.filter(p=>p.kind===ct.Image||p.kind===ct.Text&&se(p.content,"image")):e(v)==="videos"?R.events.filter(p=>p.kind===ct.Video||p.kind===ct.ShortVideo||p.kind===22||p.kind===ct.Text&&se(p.content,"video")):[]),Ce=M(()=>e(v)==="articles"?[]:h.events),we=M(()=>e(v)==="articles"?N.hasMore:h.hasMore),W=M(()=>e(v)==="articles"?N.isLoading:h.isLoading);function ne(){e(v)==="articles"?N.loadMore():h.loadMore()}const de=M(()=>{const p=new Set,A=h.pendingEvents;for(const Y of A){if(p.size>=3)break;p.add(Y.pubkey)}return Array.from(p)}),ze=M(()=>Zt.interests.length>0?null:e(w)?{type:"text",text:Yt(e(w)).info?.name||e(w).replace("wss://","").replace("ws://","")}:Te.selectedRelay?S(Te.selectedRelay)&&e(O)?{type:"text",text:e(O).tagValue("title")||"Untitled Pack"}:{type:"text",text:Yt(Te.selectedRelay).info?.name||Te.selectedRelay.replace("wss://","").replace("ws://","")}:{type:"logo"});xt(()=>{e(v)==="articles"?cr.setReadsMode():cr.reset()}),xt(()=>(ur.header=f,()=>{ur.clear()}));var Le=dn(),De=k(Le),Me=s(De),me=s(Me);{var Pe=p=>{var A=Zs(),Y=k(A),xe=s(Y);{var Z=U=>{var L=Ks();r(U,L)},ce=U=>{var L=I(),n=k(L);{var b=P=>{var q=Ws();r(P,q)},m=P=>{var q=Js(),V=k(q);{var K=pe=>{var $e=Gs(),Fe=u(s($e),2),Se=s(Fe);Ye(Se,21,()=>e(x),He=>He.id,(He,et)=>{var nt=qs(),at=s(nt);ea(at,{get article(){return e(et)}}),o(nt),r(He,nt)}),o(Se),o(Fe),o($e),r(pe,$e)};y(V,pe=>{e(x).length>0&&pe(K)})}var ve=u(V,2);{var Ae=pe=>{var $e=Ys(),Fe=u(s($e),2);Ye(Fe,21,()=>e(z),Se=>Se.id,(Se,He)=>{var et=Qs(),nt=s(et);vr(nt,{get event(){return e(He)},variant:"grid"}),o(et),r(Se,et)}),o(Fe),o($e),r(pe,$e)};y(ve,pe=>{e(z).length>0&&pe(Ae)})}var fe=u(ve,2);{var Ke=pe=>{var $e=Xs(),Fe=u(s($e),2);Ye(Fe,21,()=>e(F),Se=>Se.id,(Se,He)=>{oo(Se,{get article(){return e(He)}})}),o(Fe),o($e),r(pe,$e)};y(fe,pe=>{e(F).length>0&&pe(Ke)})}r(P,q)};y(n,P=>{e(c).length===0?P(b):P(m,!1)},!0)}r(U,L)};y(xe,U=>{e(c).length===0&&N.eosed?U(Z):U(ce,!1)})}o(Y);var Xe=u(Y,2);hr(Xe,{onIntersect:ne,get hasMore(){return N.hasMore},get isLoading(){return N.isLoading}}),r(p,A)},ue=p=>{var A=I(),Y=k(A);{var xe=ce=>{var Xe=I(),U=k(Xe);{var L=b=>{var m=en();r(b,m)},n=b=>{var m=I(),P=k(m);{var q=K=>{var ve=tn();r(K,ve)},V=K=>{ia(K,{get events(){return e(D)}})};y(P,K=>{e(D).length===0?K(q):K(V,!1)},!0)}r(b,m)};y(U,b=>{e(D).length===0&&R.eosed?b(L):b(n,!1)})}r(ce,Xe)},Z=ce=>{var Xe=I(),U=k(Xe);{var L=b=>{var m=an(),P=s(m);{var q=K=>{var ve=rn();r(K,ve)},V=K=>{var ve=I(),Ae=k(ve);{var fe=pe=>{var $e=on();r(pe,$e)},Ke=pe=>{no(pe,{get events(){return e(D)}})};y(Ae,pe=>{e(D).length===0?pe(fe):pe(Ke,!1)},!0)}r(K,ve)};y(P,K=>{e(D).length===0&&R.eosed?K(q):K(V,!1)})}o(m),r(b,m)},n=b=>{var m=ln(),P=k(m);{var q=fe=>{var Ke=sn(),pe=s(Ke);pe.__click=()=>h.loadPendingEvents();var $e=s(pe);Ye($e,20,()=>e(de).slice(0,3),He=>He,(He,et)=>{var nt=I(),at=k(nt);oe(at,()=>Qt.Root,(Lt,Ht)=>{Ht(Lt,{get ndk(){return Ze},get pubkey(){return et},children:(tt,it)=>{var be=I(),Ne=k(be);oe(Ne,()=>Qt.Avatar,(Re,ge)=>{ge(Re,{class:"w-6 h-6 rounded-full border-2 border-foreground"})}),r(tt,be)},$$slots:{default:!0}})}),r(He,nt)}),o($e);var Fe=u($e,2),Se=s(Fe);o(Fe),o(pe),o(Ke),H(()=>G(Se,`${h.pendingCount??""} new ${h.pendingCount===1?"note":"notes"}`)),r(fe,Ke)};y(P,fe=>{h.pendingCount>0&&fe(q)})}var V=u(P,2);{var K=fe=>{var Ke=nn();r(fe,Ke)},ve=fe=>{var Ke=I(),pe=k(Ke);Ye(pe,17,()=>e(Ce),$e=>$e.id,($e,Fe)=>{var Se=I(),He=k(Se);{var et=at=>{vr(at,{get event(){return e(Fe)},variant:"feed"})},nt=at=>{Vs(at,{get ndk(){return Ze},get event(){return e(Fe)}})};y(He,at=>{e(Fe).kind===9802?at(et):at(nt,!1)})}r($e,Se)}),r(fe,Ke)};y(V,fe=>{e(Ce).length===0?fe(K):fe(ve,!1)})}var Ae=u(V,2);hr(Ae,{onIntersect:ne,get hasMore(){return e(we)},get isLoading(){return e(W)}}),r(b,m)};y(U,b=>{e(v)==="images"?b(L):b(n,!1)},!0)}r(ce,Xe)};y(Y,ce=>{e(v)==="videos"?ce(xe):ce(Z,!1)},!0)}r(p,A)};y(me,p=>{e(v)==="articles"?p(Pe):p(ue,!1)})}o(Me),o(De);var _e=u(De,2);Ts(_e,{onClose:()=>Xt.close(),get open(){return Xt.show},set open(p){Xt.show=p}}),r(g,Le),yt(),l()}Ft(["click"]);export{Gn as component};
